---
title: äººè„¸è¯†åˆ«-äººè„¸è¯†åˆ«ç³»åˆ—ï¼ˆåå…­ï¼‰ï¼šAMSoftmax
categories:
  - ğŸŒ™è¿›é˜¶å­¦ä¹ 
  - â­äººå·¥æ™ºèƒ½ Artificial Intelligence
  - ğŸ’«ç ”ç©¶é¢†åŸŸ Research Area
  - ğŸ›°ï¸è®¡ç®—æœºè§†è§‰ Computer Vision
tags:
  - â˜„ï¸äººè„¸è¯†åˆ« Face Recognition
abbrlink: 2f45f198
date: 2022-11-02 06:41:49
---

è®ºæ–‡é“¾æ¥ï¼š[Additive Margin Softmax for Face Verification](https://arxiv.org/abs/1801.05599)

ï¼ˆ2019.1.24ï¼šæ³¨ï¼šè…¾è®¯AI Labçš„ CosFace: Large Margin Cosine Loss for Deep Face Recognitionå’Œæœ¬æ–‡ç®—æ³•åŸºæœ¬ä¸€è‡´ï¼Œå·¥ä½œä¹Ÿå‡ ä¹æ˜¯åŒæ—¶å®Œæˆï¼Œä¸¤ç¯‡è®ºæ–‡ä¹Ÿéƒ½å„è‡ªä¸­äº†ä¸åŒçš„ä¼šè®®ã€‚ï¼‰

### AMSoftmax

#### Softmax

{% asset_img 1.webp %}

<!--more-->

#### ASoftmax

{% asset_img 2.webp %}

è¿™æ˜¯åœ¨SphereFaceä¸­æå‡ºæ¥çš„æŸå¤±å‡½æ•°

{% asset_img 3.webp %}

#### AMSoftmax

è¿™å°±æ˜¯æœ¬æ–‡æ–°æå‡ºçš„æŸå¤±å‡½æ•°äº†ã€‚å…¶å˜åŒ–å°±åœ¨äºä¿®æ”¹äº†Cos(mÎ¸)ä¸ºä¸€ä¸ªæ–°å‡½æ•°ï¼š

{% asset_img 4.webp %}

ä¸ASoftmaxä¸­å®šçš„çš„ç±»ä¼¼ï¼Œå¯ä»¥è¾¾åˆ°å‡å°å¯¹åº”æ ‡ç­¾é¡¹çš„æ¦‚ç‡ï¼Œå¢å¤§æŸå¤±çš„æ•ˆæœï¼Œå› æ­¤å¯¹åŒä¸€ç±»çš„èšåˆæ›´æœ‰å¸®åŠ©

ç„¶åæ ¹æ®Normfaceï¼Œå¯¹fè¿›è¡Œå½’ä¸€åŒ–ï¼Œä¹˜ä¸Šç¼©æ”¾ç³»æ•°sï¼Œæœ€ç»ˆçš„æŸå¤±å‡½æ•°å˜ä¸ºï¼š

{% asset_img 5.webp %}

è¿™æ ·åšçš„å¥½å¤„åœ¨äºASoftmaxçš„å€è§’è®¡ç®—æ˜¯è¦é€šè¿‡å€è§’å…¬å¼ï¼Œåå‘ä¼ æ’­æ—¶ä¸æ–¹ä¾¿æ±‚å¯¼ï¼Œè€Œåªå‡måå‘ä¼ æ’­æ—¶å¯¼æ•°ä¸ç”¨å˜åŒ–

***

### è§’åº¦è·ç¦»ä¸ä½™å¼¦è·ç¦»

ä½œè€…è®¤ä¸ºï¼ŒAsoftmaxæ˜¯ç”¨mä¹˜ä»¥Î¸ï¼Œè€ŒAMSoftmaxæ˜¯ç”¨cosÎ¸å‡å»mï¼Œè¿™æ˜¯ä¸¤è€…çš„æœ€å¤§ä¸åŒä¹‹å¤„ï¼šä¸€ä¸ªæ˜¯**è§’åº¦è·ç¦»**ï¼Œä¸€ä¸ªæ˜¯**ä½™å¼¦è·ç¦»**ã€‚

ä½¿ç”¨ä¼ ç»Ÿçš„Softmaxçš„æ—¶å€™ï¼Œè§’åº¦è·ç¦»å’Œä½™å¼¦è·ç¦»æ˜¯ç­‰ä»·çš„ï¼Œå³

{% asset_img 6.webp %}

ä½†æ˜¯å½“æˆ‘ä»¬è¯•å›¾è¦æ¨åŠ¨å†³ç­–è¾¹ç•Œçš„æ—¶å€™ï¼Œè§’åº¦è·ç¦»å’Œä½™å¼¦è·ç¦»å°±**æœ‰æ‰€ä¸åŒ**äº†ã€‚

æœ€ç»ˆçš„å†³ç­–è¾¹ç•Œæ˜¯å’Œä½™å¼¦ç›¸å…³çš„ï¼Œæ ¹æ®cosçš„æ€§è´¨ï¼Œä¼˜åŒ–è§’åº¦è·ç¦»æ¯”ä¼˜åŒ–ä½™å¼¦è·ç¦»æ›´æœ‰æ•ˆæœï¼Œå› ä¸ºä½™å¼¦è·ç¦»ç›¸å¯¹æ›´å¯†é›†

ä¹‹æ‰€ä»¥é€‰æ‹©cosÎ¸-mè€Œä¸æ˜¯cosï¼ˆÎ¸-mï¼‰ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬ä»ç½‘ç»œä¸­å¾—åˆ°çš„æ˜¯Wå’Œfçš„å†…ç§¯ï¼Œå¦‚æœè¦ä¼˜åŒ–cosï¼ˆÎ¸-mï¼‰é‚£ä¹ˆä¼šæ¶‰åŠåˆ°arccosæ“ä½œï¼Œè®¡ç®—é‡è¿‡å¤§ã€‚

***

### ç‰¹å¾å½’ä¸€åŒ–

è¿™é‡Œæåˆ°äº†ä¸€ä¸ªå½’ä¸€åŒ–ç‰¹å¾çš„é‡è¦ç›®çš„ï¼š

é«˜è´¨é‡çš„å›¾ç‰‡æå–å‡ºæ¥çš„ç‰¹å¾èŒƒæ•°å¤§ï¼Œä½è´¨é‡çš„å›¾ç‰‡æå–å‡ºæ¥çš„ç‰¹å¾èŒƒæ•°å°ï¼Œå¦‚å›¾ï¼š

{% asset_img 7.webp %}

è¿™æ˜¯å› ä¸ºSoftmaxçš„ç›®æ ‡æ˜¯å°½å¯èƒ½æœ€å¤§åŒ–æ­£ç¡®åˆ†ç±»çš„æ¦‚ç‡ï¼Œå®ƒä¼šå¿½ç•¥æ‰ä¸€äº›æ¯”è¾ƒéš¾åˆ†è¾¨çš„å›¾ç‰‡ï¼šä¹Ÿå°±æ˜¯ä½è´¨é‡çš„å›¾ç‰‡ï¼Œè€Œä¼˜å…ˆæ‹Ÿåˆé«˜è´¨é‡çš„å›¾ç‰‡
å› æ­¤æŠŠç‰¹å¾å¼ºè¡Œå½’ä¸€åŒ–ä¼šä½¿å¾—ä½èŒƒæ•°çš„å›¾ç‰‡å˜å¾—é«˜èŒƒæ•°ï¼Œä¹Ÿä¼šè·å¾—æ›´å¤šçš„ç½‘ç»œçš„æ³¨æ„åŠ›ã€‚

ï¼ˆè¿™å’Œtripletlossåˆ»æ„å»æŒ–æ˜éš¾ä»¥è¯†åˆ«çš„å›¾ç‰‡çš„æœ€ç»ˆç»“æœæ˜¯ä¸€æ ·çš„ï¼Œæ–¹æ³•ä¸ä¸€æ ·è€Œå·²ï¼‰

{% asset_img 8.webp %}

è¿™å¼ å›¾è¯´æ˜çš„æ˜¯ç‰¹å¾å½’ä¸€åŒ–ä¹‹åï¼ŒåŸæ¥èŒƒæ•°æ¯”è¾ƒå°çš„ç‰¹å¾ä¼šè·å¾—æ›´å¤§çš„æ¢¯åº¦ï¼Œå¯¹åº”äºnormfaceä¸­çš„æ±‚å¯¼å¼ï¼š

{% asset_img 9.webp %}

***

### å®éªŒ

#### ç½‘ç»œ

20å±‚Resnet

#### å‚æ•°

We set the weight decay parameter to be 5e.4. The batch size is 256 and the learning rate begins with 0.1 and is divided by 10 at the 16K, 24K and 28K iterations

#### è®­ç»ƒé›†

CASIA-Webface

#### éªŒè¯æ–¹å¼

å›¾ç‰‡ä¸å…¶é•œåƒå›¾ç‰‡æå–å‡ºæ¥çš„ç‰¹å¾å¯¹åº”ç›¸åŠ ï¼Œæ¯”è¾ƒä½™å¼¦è·ç¦»

#### ç»“æœ

{% asset_img 10.webp %}

ä¸ä½¿ç”¨ç‰¹å¾å½’ä¸€åŒ–ï¼Œåœ¨é«˜è´¨é‡å›¾ç‰‡é›†ï¼ˆLFWï¼‰ä¸Šç»“æœæ›´å¥½

ä½¿ç”¨ç‰¹å¾å½’ä¸€åŒ–ï¼Œåœ¨å…·æœ‰å¾ˆå¤šä½è´¨é‡çš„å›¾ç‰‡é›†ï¼ˆMegaFaceï¼‰ä¸Šç»“æœæ›´å¥½ã€‚

***

### å‚è€ƒèµ„æ–™

> ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºCSDNåšä¸»ã€ŒFire_Light_ã€çš„åŸåˆ›æ–‡ç« ï¼Œéµå¾ªCC 4.0 BY-SAç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥åŠæœ¬å£°æ˜ã€‚
> åŸæ–‡é“¾æ¥ï¼šhttps://blog.csdn.net/fire_light_/article/details/79602310
