---
title: äººè„¸è¯†åˆ«-äººè„¸è¯†åˆ«åˆé›† | 7 VGGFaceè§£æ(ç‰›æ´¥å¤§å­¦ 2015)
categories:
  - ğŸŒ™è¿›é˜¶å­¦ä¹ 
  - â­äººå·¥æ™ºèƒ½ Artificial Intelligence
  - ğŸ’«ç ”ç©¶é¢†åŸŸ Research Area
  - ğŸ›°ï¸è®¡ç®—æœºè§†è§‰ Computer Vision
  - â˜„ï¸äººè„¸è¯†åˆ« Face Recognition
abbrlink: 2d425650
date: 2023-06-13 03:44:12
tags:
---

VGGFaceæ˜¯ç‰›æ´¥å¤§å­¦è§†è§‰ç»„äº2015å¹´å‘è¡¨ï¼ŒVGGNetä¹Ÿæ˜¯ä»–ä»¬æå‡ºçš„ï¼ŒåŸºäºVGGNetçš„äººè„¸è¯†åˆ«ï¼Œ[Deep Face Recognition](http://www.robots.ox.ac.uk/~vgg/publications/2015/Parkhi15/parkhi15.pdf)ï¼Œ[å®˜ç½‘](https://www.robots.ox.ac.uk/~vgg/software/vgg_face/)

<!--more-->

***

### ä¸»è¦æ€æƒ³

- ç›®æ ‡ï¼šæ„å»ºæœ€å°‘çš„äººä¸ºå¹²é¢„å¤§è§„æ¨¡äººè„¸æ•°æ®é›†ï¼Œä½¿è®­ç»ƒçš„å·ç§¯ç¥ç»ç½‘ç»œè¿›è¡Œäººè„¸è¯†åˆ«ï¼Œå¯ä»¥ä¸è°·æ­Œå’ŒFacebookç­‰äº’è”ç½‘å·¨å¤´ç«äº‰ã€‚å¹¶ä¸æ˜¯ç”¨FaceNeté‚£ç§ç«¯åˆ°ç«¯ç³»ç»Ÿã€‚
- äººè„¸åˆ†ç±»å™¨ï¼šVGGNet+Softmax lossï¼Œè¾“å‡º2622ä¸ªç±»åˆ«æ¦‚ç‡
- ä¸‰å…ƒç»„å­¦ä¹ äººè„¸åµŒå…¥ï¼šVGGNet+Triplet lossï¼Œè¾“å‡º1024ç»´çš„äººè„¸è¡¨ç¤º
    - åœ¨äººè„¸åˆ†ç±»å™¨åŸºç¡€ä¸Šï¼Œç”¨ç›®æ ‡æ•°æ®é›†åªfine-tuningå­¦ä¹ äº†æ˜ å°„å±‚
- äººè„¸éªŒè¯ï¼šé€šè¿‡æ¯”è¾ƒä¸¤ä¸ªäººè„¸åµŒå…¥çš„æ¬§å¼è·ç¦»æ¥éªŒè¯åŒç§äººã€‚
- æ„å»ºæ–°çš„äººè„¸æ•°æ®é›†ï¼š2622ä¸ªäººï¼Œæ¯äºº1000å¼ ï¼Œå…±260ä¸‡ä¸ªäººè„¸ã€‚
- åœ¨LFWä¸Šçš„å‡†ç¡®ç‡ä¸º98.95%ï¼ŒYTFä¸Šå‡†ç¡®ç‡æ˜¯97.3%

***

### VGGNetç½‘ç»œæ¶æ„

- ç½‘ç»œæ¯”è¾ƒæ·±ï¼ŒåŸºæœ¬å’ŒVGGNetä¸€æ ·ï¼Œåˆæ”¹è¿›äº†ï¼š
- 3x3å·ç§¯æ ¸ï¼Œå·ç§¯æ­¥é•¿ä¸º1
- ReLUæ¿€æ´»
- æœ‰3ä¸ªå…¨è¿æ¥å±‚
- æ²¡æœ‰ç”¨local contrast normalization

{% asset_img 1.webp %}

***

### äººè„¸åˆ†ç±»å™¨

1. ä½¿ç”¨å¦‚ä¸‹VGGNetï¼Œè®­ç»ƒä¸€ä¸ªn=2622è·¯çš„Softmax lossäººè„¸åˆ†ç±»å™¨ã€‚ä½¿ç”¨éšæœºé«˜æ–¯åˆå§‹åŒ–ï¼Œéšæœºæ¢¯åº¦ä¸‹é™ï¼ˆæ‰¹é‡è¾ƒå¤§æ—¶ç”¨Accumulator Descentï¼‰ï¼ŒBatch Size=256
2. å­¦ä¹ å®Œæˆåï¼Œå»é™¤åˆ†ç±»å™¨å±‚(W,b)ï¼Œåˆ©ç”¨æ¬§æ°è·ç¦»æ¯”è¾ƒå¾—åˆ†å‘é‡ï¼Œè¿›è¡Œäººè„¸è¯†åˆ«éªŒè¯ã€‚
3. ç„¶è€Œï¼Œæˆ‘ä»¬è€Œæ˜¯é€šè¿‡ä½¿ç”¨â€œä¸‰å…ƒç»„æŸå¤±â€è®­ç»ƒæ–¹æ¡ˆå¯¹å®ƒä»¬è¿›è¡Œè°ƒä¼˜ï¼Œä»¥ä¾¿åœ¨æ¬§å‡ é‡Œå¾·ç©ºé—´ä¸­è¿›è¡ŒéªŒè¯ï¼Œå¯ä»¥æ˜¾è‘—æé«˜åˆ†æ•°ï¼Œä¸‹ä¸€èŠ‚å°†å¯¹æ­¤è¿›è¡Œè¯´æ˜ã€‚ä¸ºäº†è·å¾—è‰¯å¥½çš„æ•´ä½“æ€§èƒ½ï¼Œå¿…é¡»å°†ç½‘ç»œå¼•å¯¼ä¸ºåˆ†ç±»å™¨ã€‚

{% asset_img 2.webp %}

***

### ä¸‰å…ƒç»„å­¦ä¹ äººè„¸åµŒå…¥

- ä¸‰å…ƒç»„æŸå¤±è®­ç»ƒçš„ç›®çš„æ˜¯å­¦ä¹ åœ¨æœ€ç»ˆåº”ç”¨ä¸­è¡¨ç°è‰¯å¥½çš„åˆ†æ•°å‘é‡ï¼Œå³é€šè¿‡æ¯”è¾ƒæ¬§å‡ é‡Œå¾·ç©ºé—´ä¸­çš„äººè„¸æè¿°ç¬¦æ¥éªŒè¯èº«ä»½ã€‚è¿™åœ¨æœ¬è´¨ä¸Šç±»ä¼¼äºâ€œåº¦é‡å­¦ä¹ (metric learning)â€ï¼Œå¹¶ä¸”åƒè®¸å¤šåº¦é‡å­¦ä¹ æ–¹æ³•ä¸€æ ·ï¼Œå®ƒç”¨äºå­¦ä¹ åŒæ—¶å…·æœ‰ç‹¬ç‰¹æ€§å’Œç´§å‡‘æ€§çš„æ˜ å°„ï¼ŒåŒæ—¶å®ç°é™ç»´ã€‚
- åœ¨è¿›è¡ŒéªŒè¯æ—¶ï¼Œåˆ†ç±»å™¨åœ¨æœ€åä¸€å±‚FCå±‚è¾“å‡ºäº†2622ç»´çš„ç‰¹å¾ï¼ˆå³å¯¹åº”æ¯ä¸€ç±»çš„æ¦‚ç‡ï¼‰ï¼Œè€Œè¿™é‡Œè¿˜ä¼šè¢«ç”¨æ¥ä»¥Triplet lossåšä¸€ä¸ªåº¦é‡å­¦ä¹ ã€‚åº¦é‡å­¦ä¹ æ˜¯ä¸€ä¸ªå…¨è¿æ¥å±‚ï¼Œä½¿ç”¨ç›®æ ‡æ•°æ®é›†(å¦‚LFWå’ŒYTF)çš„è®­ç»ƒé›†éƒ¨åˆ†è®­ç»ƒæ˜ å°„å‡½æ•°W'ï¼Œè·å¾—1024ç»´çš„äººè„¸ç‰¹å¾è¡¨è¾¾ï¼ˆäººè„¸åµŒå…¥ï¼‰ã€‚ï¼ˆåŸºäºç¥ç»ç½‘ç»œçš„äººè„¸éªŒè¯ï¼‰
    - åŒæ ·çš„ç½‘ç»œè¾“å…¥ä¸ºå¤§å°ä¸º224Ã—224çš„äººè„¸å›¾åƒï¼Œåé¢å‰ä¸¤ä¸ªFCå±‚çš„è¾“å‡ºæ˜¯4096ç»´çš„ï¼Œæœ€åä¸€ä¸ªFCå±‚åçš„è¾“å‡ºæ˜¯N=2622ç»´æˆ–L=1024ç»´ï¼Œè¿™å–å†³äºç”¨äºä¼˜åŒ–çš„æŸå¤±å‡½æ•°æ˜¯Softmaxè¿˜æ˜¯Triplet lossã€‚
    - æ³¨æ„ï¼Œä¸å‰ä¸€èŠ‚ä¸åŒçš„æ˜¯ï¼Œè¿™é‡Œæ²¡æœ‰å­¦ä¹ åˆ°ä»»ä½•åå·®ï¼Œå› ä¸ºä¸‰å…ƒç»„æŸå¤±å‡½æ•°ä¸­çš„å·®å¼‚ä¼šæŠµæ¶ˆå®ƒ

è®­ç»ƒæµç¨‹å¦‚ä¸‹ï¼š

- å°†åˆ†ç±»å™¨æœ€åè¾“å‡ºçš„4096ç»´ç‰¹å¾è¿›è¡ŒL2å½’ä¸€åŒ–ï¼Œå¾—åˆ°

{% asset_img 3.webp %}

å¹¶å°†å…¶æ˜ å°„åˆ°å¦ä¸€ç©ºé—´

{% asset_img 4.webp %}

- é€šè¿‡æœ€å°åŒ–ä¸‰å…ƒç»„æŸå¤±å‡½æ•°è®­ç»ƒä¸€ä¸ªä»4096åˆ°1024ç»´çš„æ˜ å°„å‡½æ•°W'ï¼Œå¾—åˆ°ä¸€ä¸ª1024ç»´çš„äººè„¸åµŒå…¥ã€‚Triplet lossæŸå¤±å‡½æ•°å¦‚ä¸‹ï¼š
    - aâ‰¥0æ˜¯ä¸€ä¸ªè¡¨ç¤ºè¾¹ç•Œé—´éš”ï¼ŒTæ˜¯è®­ç»ƒä¸‰å…ƒç»„çš„é›†åˆï¼Œæ¯æ¬¡è¿­ä»£å¼€å§‹æ—¶åœ¨çº¿å½¢æˆä¸‰å…ƒç»„ã€‚
    - å¯¹ç›®æ ‡æ•°æ®é›†è¿›è¡Œfine-tuningï¼Œåªå­¦ä¹ æ˜ å°„å±‚

{% asset_img 5.webp %}

***

### äººè„¸éªŒè¯

- é€šè¿‡æ¯”è¾ƒä¸¤ä¸ª1024ç»´äººè„¸ç‰¹å¾çš„æ¬§å¼è·ç¦»æ˜¯å¦å°äºé˜ˆå€¼æ¥éªŒè¯èº«ä»½

{% asset_img 6.webp %}

***

### æ„å»ºæ•°æ®é›†

1. å…ˆåœ¨[Freebase](https://developers.google.com/freebase/)å’ŒIMDbç½‘ç«™ä¸Šæœé›†5000ä¸ªåäººï¼Œæ¯äºº200å¼ å›¾ã€‚
2. å†æ‰‹åŠ¨ç”¨è°·æ­Œæœç´¢å»æ‰ä¸å¤ªå—æ¬¢è¿çš„åäººï¼Œå»æ‰ä¸å…¬å…±åŸºå‡†é‡å çš„äººï¼Œæœ€ç»ˆæ•°æ®é›†æœ‰2622ä¸ªåäººã€‚
3. å¯¹å›¾åƒé›†æ’åºï¼Œæ¯ä¸ªèº«ä»½å¯¹åº”2000å¼ å›¾ç‰‡ï¼Œé€šè¿‡æ·»åŠ å…³é”®å­—â€œactorâ€è¿›è¡Œæœç´¢ï¼Œå¯¹2000å¼ å›¾ç‰‡è¿›è¡Œæ’åï¼Œé€‰æ‹©å‰1000å¼ ï¼Œæœ€ç»ˆçº¦260ä¸‡å¼ 2622ä½åäººçš„ç…§ç‰‡ã€‚æ–‡ä¸­è®­ç»ƒç”¨è¿™æ­¥çš„æ•°æ®ï¼Œæ€§èƒ½æœ€å¥½
4. åˆ é™¤é‡å¤çš„VLADæè¿°ç¬¦ï¼Œ2622äººï¼Œæ¯äºº623å¼ ï¼Œæ€»å…±163ä¸‡å¼ .
5. æœ€ç»ˆæ‰‹åŠ¨æ£€æŸ¥æ•°æ®é›†ï¼Œ2622äººï¼Œæ¯äºº375å¼ ï¼Œæ€»å…±98ä¸‡å¼ ã€‚

{% asset_img 7.webp %}
{% asset_img 8.webp %}

æ•°æ®é›†å¤§å°æ¯”è¾ƒï¼š

{% asset_img 9.webp %}

ç”¨ç¬¬3æ­¥æ•´ä¸ªæ•°æ®é›†è®­ç»ƒæ•ˆæœæ¯”è¾ƒå¥½ï¼Œè¯´æ˜ä½¿ç”¨æ›´å¤§ä½†æ˜¯æœ‰æ›´å¤šé”™è¯¯çš„æ•°æ®é›†å¯¹ç½‘ç»œèƒ½åŠ›æœ‰æé«˜ä½œç”¨ï¼ŒåŸå› ä¸€æ˜¯å› ä¸ºæ•°æ®é‡æ›´å¤§ï¼ŒäºŒæ˜¯å› ä¸ºå°çš„æ•°æ®é›†å¯èƒ½è¢«æ¸…é™¤äº†ä¸€äº›hard positiveçš„æ•°æ®ï¼Œä½¿å¾—ç½‘ç»œæ— æ³•ä»è¿™äº›æ•°æ®é‡Œå—ç›Šã€‚

{% asset_img 10.webp %}

***

### æµ‹è¯•ç»“æœ

LFWä¸ŠVGGFaceç”¨VGGNetçš„Bå½¢å¼æ€§èƒ½æœ€å¥½ã€‚ç­‰é”™è¯¯ç‡ï¼ˆEERï¼‰ä½œä¸ºä¸€ä¸ªè¯„ä¼°åº¦é‡æŒ‡æ ‡ï¼Œå®šä¹‰ä¸ºå‡é˜³æ€§ï¼ˆTPï¼‰å’Œå‡é˜´æ€§ï¼ˆFNï¼‰ç‡ç›¸ç­‰çš„ROCæ“ä½œç‚¹çš„é”™è¯¯ç‡ã€‚

{% asset_img 11.webp %}

VGGFaceä½¿ç”¨äº†è¾ƒå°‘çš„æ•°æ®é›†åœ¨LFWä¸Šçš„å‡†ç¡®ç‡ä¸º98.95%ï¼Œå’Œæ™®é€šç‰ˆçš„FaceNetç›¸å½“ï¼Œæ¯”DeepFaceè¦å¥½ï¼Œä¸å¦‚DeepID2,3å’Œå¯¹é½ç‰ˆçš„FaceNetã€‚
ROCä¸Šæ¯”DeepFaceè¦å¥½ï¼Œå’ŒDeepID3ç›¸å½“ã€‚

{% asset_img 12.webp %}

YTFä¸Šå‡†ç¡®ç‡æ˜¯97.3%ï¼Œæ¯”ä»–ä»¬éƒ½è¦å¥½ã€‚ç»™å®šä¸€å¯¹æŒ‡å®šçš„è§†é¢‘ï¼ŒéªŒè¯æ˜¯å¦å±äºåŒä¸€ä¸ªäººã€‚
Oxford Buffy Datasetï¼ˆä¸€ç§ç”µè§†å‰§æ•°æ®é›†ï¼‰ï¼Œæ¢æµ‹äº†æ­£é¢å’Œä¾§é¢ï¼ŒMean APè¾¾åˆ°0.95ã€‚

{% asset_img 13.webp %}

å­¦ä¹ çš„åµŒå…¥æ¯”åˆ†ç±»æ¨¡å‹è¦å¥½ï¼š

{% asset_img 14.webp %}

***

### å‚è€ƒèµ„æ–™

> <https://zhuanlan.zhihu.com/p/76538698>
> <https://www.robots.ox.ac.uk/~vgg/software/vgg_face/>
> <https://blog.csdn.net/Fire_Light_/article/details/79593778>
> <https://github.com/rcmalli/keras-vggface>
