---
title: äººè„¸è¯†åˆ«-äººè„¸è¯†åˆ«åˆé›† | 1 DeepFaceè§£æ(Facebook CVPR2014)
categories:
  - ğŸŒ™è¿›é˜¶å­¦ä¹ 
  - â­äººå·¥æ™ºèƒ½ Artificial Intelligence
  - ğŸ’«ç ”ç©¶é¢†åŸŸ Research Area
  - ğŸ›°ï¸è®¡ç®—æœºè§†è§‰ Computer Vision
tags:
  - â˜„ï¸äººè„¸è¯†åˆ« Face Recognition
abbrlink: cec2ee73
date: 2023-06-08 07:13:47
---

DeepFaceæ˜¯Facebook CVPR2014å¹´å‘è¡¨ï¼Œä¸»è¦ç”¨äºäººè„¸éªŒè¯ï¼Œæ˜¯æ·±åº¦å­¦ä¹ äººè„¸è¯†åˆ«çš„å¥ åŸºä¹‹ä½œï¼Œè¶…è¿‡äº†éæ·±åº¦å­¦ä¹ æ–¹æ³•Tom-vs-Pete classifiersã€high-dim LBPã€TL Joint Bayesianç­‰

[DeepFace: Closing the Gap to Human-Level Performance in Face Verification](https://www.cs.toronto.edu/~ranzato/publications/taigman_cvpr14.pdf)

<!--more-->

***

### ä¸»è¦æ€æƒ³

- äººè„¸è¯†åˆ«çš„æµæ°´çº¿åŒ…æ‹¬å››ä¸ªé˜¶æ®µï¼šæ£€æµ‹â‡’å¯¹é½â‡’è¡¨ç¤ºâ‡’åˆ†ç±»ã€‚
- 3Däººè„¸å¯¹é½ï¼šé‡‡ç”¨æ˜¾å¼çš„3Däººè„¸å»ºæ¨¡å¹¶åº”ç”¨åˆ†æ®µä»¿å°„å˜æ¢ï¼Œå¹¶å®ç°äººè„¸æ­£é¢åŒ–ã€‚DeepIDå’ŒFaceNetå¹¶æ²¡æœ‰è¿™ç§å¯¹é½ï¼ŒDeepIDçš„è§£å†³æ–¹æ¡ˆæ˜¯å°†ä¸€ä¸ªäººè„¸åˆ‡æˆå¾ˆå¤šéƒ¨åˆ†ï¼Œæ¯ä¸ªéƒ¨åˆ†éƒ½è®­ç»ƒä¸€ä¸ªæ¨¡å‹ï¼Œç„¶åæ¨¡å‹èšåˆï¼ŒFaceNetåˆ™æ˜¯ç›´æ¥ä»¥æ•°æ®é‡å¤§å’Œç‰¹æ®Šçš„ç›®æ ‡å‡½æ•°å–èƒœã€‚
- äººè„¸è¡¨ç¤ºï¼ˆäººè„¸è¯†åˆ«ï¼‰ï¼šåˆ©ç”¨9å±‚æ·±åº¦ç¥ç»ç½‘ç»œå¯¼å‡ºäººè„¸è¡¨ç¤ºï¼Œè¿˜ä½¿ç”¨äº†3ä¸ªæ— æƒé‡å…±äº«çš„å±€éƒ¨è¿æ¥å±‚ã€‚äººè„¸è¡¨ç¤ºç‰¹å¾å‘é‡æ˜¯4096ç»´ï¼ŒSoftmaxåˆ†ç±»ã€‚å¼€äº†å…ˆæ²³ï¼Œåé¢å†ä¹Ÿä¸ç”¨LBPäº†ã€‚
- äººè„¸éªŒè¯ï¼šæ— ç›‘ç£ï¼ˆä¸¤ä¸ªå‘é‡çš„å†…ç§¯ï¼‰ï¼›æœ‰ç›‘ç£ï¼ˆå¡æ–¹ç›¸ä¼¼åº¦æˆ–å­ªç”Ÿç½‘ç»œï¼‰ã€‚
- å°†åŸºäºæ¨¡å‹çš„ç²¾ç¡®å¯¹é½ä¸å¤§å‹äººè„¸æ•°æ®åº“ç›¸ç»“åˆçš„å­¦ä¹ è¡¨ç¤ºæ–¹æ³•å¯ä»¥å¾ˆå¥½åœ°æ¨å¹¿åˆ°æ— çº¦æŸç¯å¢ƒä¸‹çš„äººè„¸ã€‚åœ¨äººè„¸æ•°æ®é›†Facebookçš„SFC ä¸Šè®­ç»ƒç½‘ç»œæ¨¡å‹ã€‚LFWè¾¾åˆ°97.35ï¼…çš„å‡†ç¡®åº¦ï¼ŒYTFä¸Š91.4%ï¼Œå°†å½“å‰æŠ€æœ¯æ°´å¹³çš„è¯¯å·®å‡å°‘äº†27ï¼…ä»¥ä¸Šï¼Œæ¥è¿‘äººç±»æ°´å¹³çš„è¡¨ç°ã€‚

***

### äººè„¸å¯¹é½ï¼ˆFace Alignmentï¼‰

- äººè„¸å¯¹é½ä»ç„¶è¢«è®¤ä¸ºæ˜¯éš¾ä»¥è§£å†³çš„é—®é¢˜ï¼Œç‰¹åˆ«æ˜¯åœ¨æ— çº¦æŸçš„ç¯å¢ƒä¸‹
- DeepFaceæ˜¯å°†æ£€æµ‹çš„äººè„¸æŠ•å°„åˆ°3ç»´æ¨¡å‹ä¸Šï¼Œå†å¯¹é½åˆ°æ­£è„¸ã€‚è¿™ä¸ªæ–¹æ³•æ¯”è¾ƒå¤æ‚ï¼Œåé¢ä¸ç”¨å®ƒä¹Ÿèƒ½å–å¾—å¾ˆå¥½çš„æ•ˆæœã€‚

{% asset_img 1.webp %}

***

### å¯¹é½æµæ°´çº¿ï¼ˆAlignment pipelineï¼‰

å¯¹é½çš„æ­¥éª¤æ˜¯ï¼šæ‰¾6ä¸ªlandmarks-->è¿›è¡Œ2Då¯¹é½-->é‡æ–°æ‰¾6ä¸ªlandmarks-->é‡æ–°è¿›è¡Œ2Då¯¹é½â€¦â€¦ç›´åˆ°æ”¶æ•›-->æ‰¾67ä¸ªlandmarks-->3D-2Dæ˜ å°„å»ºæ¨¡-->é€æ®µä»¿å°„å˜æ¢å˜æˆæ­£è„¸ã€‚

- ï¼ˆaï¼‰æ£€æµ‹äººè„¸åŠæ£€æµ‹6ä¸ªåˆå§‹åŸºå‡†ç‚¹ï¼šç”±è®­ç»ƒæœ‰ç´ æ”¯æŒå‘é‡å›å½’å™¨(Support Vector Regressor)+LBP æ¥æ£€æµ‹å‰ªåˆ‡å—å†…çš„6ä¸ªåŸºå‡†ç‚¹ï¼Œå…¶ä¸­çœ¼ç›ä¸­å¿ƒ2ä¸ªï¼Œé¼»å°–1ä¸ªå’Œå˜´éƒ¨ä½ç½® 3ä¸ªã€‚
- ï¼ˆbï¼‰2Då¯¹é½çš„å‰ªåˆ‡å—ï¼š6ä¸ªåŸºå‡†ç‚¹ç”¨äºé€šè¿‡ç¼©æ”¾ã€æ—‹è½¬å’Œå¹³ç§»å°†å›¾åƒè½¬æ¢æˆ6ä¸ªé”šç‚¹ä½ç½®ï¼Œç„¶ååœ¨æ–°çš„warpedå›¾åƒä¸Šè¿­ä»£ç›´åˆ°æ²¡æœ‰æ˜¾è‘—å˜åŒ–ï¼Œæœ€ç»ˆæ„æˆ2Dç›¸ä¼¼æ€§å˜æ¢ï¼Œç”Ÿæˆäº†2Då¯¹é½çš„å‰ªåˆ‡å—ã€‚ç„¶è€Œï¼Œç›¸ä¼¼å˜æ¢ä¸èƒ½è¡¥å¿å¹³é¢å¤–æ—‹è½¬ï¼Œè¿™åœ¨æ— çº¦æŸæ¡ä»¶ä¸‹å°¤ä¸ºé‡è¦ã€‚
- ï¼ˆcï¼‰åœ¨2Då‰ªåˆ‡å—ä¸Šå®šä½67ä¸ªåŸºå‡†ç‚¹å¹¶åšç›¸åº”çš„Delaunayä¸‰è§’å‰–åˆ†ï¼šä¸ºäº†å¯¹é½ç»å¹³é¢å¤–æ—‹è½¬çš„äººè„¸ï¼Œä½¿ç”¨é€šç”¨çš„3Då½¢çŠ¶æ¨¡å‹å¹¶æ³¨å†Œ3Dä»¿å°„ç›¸æœºï¼Œç›¸æœºç”¨äºå°†2Då‰ªåˆ‡æ›²çº¿æ‰­æ›²åˆ°3Då½¢çŠ¶çš„å›¾åƒå¹³é¢ã€‚ä½¿ç”¨ç¬¬äºŒä¸ªSVRåœ¨2Då¯¹é½çš„å‰ªåˆ‡å—ä¸­å®šä½å¦å¤–çš„67ä¸ªåŸºå‡†ç‚¹ã€‚åœ¨è½®å»“ä¸Šæ·»åŠ äº†ä¸‰è§’å½¢ä»¥é¿å…ä¸è¿ç»­ã€‚
- ï¼ˆdï¼‰å°†ä¸‰è§’åŒ–åçš„äººè„¸è½¬æ¢æˆ3Då½¢çŠ¶ï¼šæ‰‹åŠ¨åœ¨3Då‚è€ƒå½¢çŠ¶ï¼ˆUSF Human-IDæ•°æ®åº“çš„3Dæ‰«æçš„å¹³å‡å€¼ï¼‰ä¸Šæ”¾ç½®67ä¸ªé”šç‚¹ï¼Œå¹¶ä¸”ä»¥è¿™ç§æ–¹å¼å®ç°åŸºå‡†ç‚¹ä¸3Då‚è€ƒç‚¹ä¹‹é—´çš„å®Œå…¨å¯¹åº”ã€‚
- ï¼ˆeï¼‰ç›¸å¯¹äºæ‹Ÿåˆçš„3D-2Dç›¸æœºçš„ä¸‰è§’å½¢å¯è§†å›¾ï¼šç„¶åä½¿ç”¨å¹¿ä¹‰æœ€å°äºŒä¹˜è§£å’Œä¸€ä¸ªå·²çŸ¥åæ–¹å·®çŸ©é˜µÎ£æ¥æ‹Ÿåˆä¸€ä¸ªä»¿å°„3Dåˆ°2Dçš„ç›¸æœºPï¼Œå¤§å°ä¸º2Ã—4çš„ä»¿å°„ç›¸æœºPç”±8ä¸ªæœªçŸ¥æ•°çš„å‘é‡P->è¡¨ç¤ºã€‚è¾ƒæš—çš„ä¸‰è§’å½¢èƒ½è§åº¦ä½ã€‚
- ï¼ˆfï¼‰åˆ†æ®µä»¿å°„å˜æ¢ï¼šæœ€åçš„æ­£é¢åŒ–æ˜¯é€šè¿‡ç”±67ä¸ªåŸºå‡†ç‚¹è¡ç”Ÿçš„Delaunayä¸‰è§’å‰–åˆ†å¼•å¯¼çš„åˆ†æ®µä»¿å°„å˜æ¢(piece-wise affine warping)å®ç°çš„
- ï¼ˆgï¼‰æœ€ç»ˆçš„æ­£é¢åŒ–çš„å‰ªåˆ‡å—
- ï¼ˆhï¼‰ç”±3Dæ¨¡å‹ç”Ÿæˆçš„æ–°è§†å›¾ï¼ˆåœ¨è®ºæ–‡ä¸­æ²¡æœ‰ç”¨åˆ°ï¼‰ã€‚

{% asset_img 2.webp %}

***

### äººè„¸è¡¨ç¤ºçš„ç½‘ç»œæ¨¡å‹

é€šè¿‡ä¸€ä¸ªå¤§å‹çš„æ·±å±‚ç½‘ç»œå­¦ä¹ é¢éƒ¨å›¾åƒçš„ä¸€èˆ¬è¡¨ç¤º(Representation)ã€‚å°†DNNè®­ç»ƒæˆä¸€ä¸ªå¤šåˆ†ç±»çš„äººè„¸è¯†åˆ«ä»»åŠ¡ï¼Œå³å¯¹äººè„¸å›¾åƒçš„èº«ä»½è¿›è¡Œåˆ†ç±»ã€‚

- 3Då¯¹é½åçš„152x152åƒç´ çš„3é€šé“RGBäººè„¸å›¾åƒè¢«é€å…¥å…·æœ‰32ä¸ª11Ã—11Ã—3çš„æ»¤æ³¢å™¨çš„å·ç§¯å±‚ï¼ˆC1ï¼‰ã€‚
- ç„¶åå°†å¾—åˆ°çš„32ä¸ªç‰¹å¾å›¾é¦ˆé€åˆ°æœ€å¤§æ± åŒ–å±‚ï¼ˆM2ï¼‰ï¼Œå¯¹3Ã—3ç©ºé—´é‚»åŸŸæœ€å¤§æ± åŒ–ï¼Œæ­¥å¹…ä¸º2ï¼Œ æ¯ä¸ªé€šé“åˆ†åˆ«æ‰§è¡Œã€‚
- M2ä¹‹åæ˜¯å…·æœ‰16ä¸ª9Ã—9Ã—32çš„æ»¤æ³¢å™¨å·ç§¯å±‚ï¼ˆC3ï¼‰ã€‚
- å±€éƒ¨è¿æ¥å±‚ï¼ˆlocally connected layersï¼‰ï¼ˆL4ï¼Œ L5å’ŒL6ï¼‰åº”ç”¨ç±»ä¼¼å·ç§¯å±‚çš„æ»¤æ³¢å™¨ç»„ï¼Œä½†æ˜¯ç‰¹å¾å›¾ä¸­çš„æ¯ä¸ªä½ç½®éƒ½å­¦ä¹ ä¸åŒçš„æ»¤æ³¢å™¨ç»„ï¼ŒLocalçš„æ„æ€æ˜¯å·ç§¯æ ¸çš„å‚æ•°ä¸å…±äº«ã€‚LCNä¸åŒäºå·ç§¯å±‚ï¼ŒLCNæ¯ä¸ªç‚¹çš„å·ç§¯æ ¸éƒ½ä¸ä¸€æ ·ã€‚
    - è¿™æ˜¯å› ä¸ºå¯¹é½å›¾åƒçš„ä¸åŒåŒºåŸŸå…·æœ‰ä¸åŒçš„å±€éƒ¨ç»Ÿè®¡ç‰¹å¾ï¼Œå·ç§¯çš„å±€éƒ¨ç¨³å®šæ€§å‡è®¾å¹¶ä¸å­˜åœ¨ï¼Œæ‰€ä»¥ä½¿ç”¨ç›¸åŒçš„å·ç§¯æ ¸ä¼šå¯¼è‡´ä¿¡æ¯çš„ä¸¢å¤±ã€‚å±€éƒ¨è¿æ¥å±‚çš„ä½¿ç”¨ä¸ä¼šå½±å“ç‰¹å¾æå–çš„è®¡ç®—è´Ÿæ‹…ï¼Œä½†ä¼šå½±å“éœ€è¦è®­ç»ƒçš„å‚æ•°æ•°é‡ã€‚
- F7å’ŒF8æ˜¯å…¨è¿æ¥ï¼Œèƒ½å¤Ÿæ•è·åœ¨äººè„¸å›¾åƒç‰¹å¾ä¹‹é—´çš„è¾ƒè¿œéƒ¨åˆ†çš„ç›¸å…³æ€§ï¼Œä¾‹å¦‚ï¼Œçœ¼ç›çš„ä½ç½®å’Œå½¢çŠ¶ä»¥åŠå˜´çš„ä½ç½®å’Œå½¢çŠ¶ã€‚
- F7çš„è¾“å‡ºå°†ç”¨ä½œåŸå§‹äººè„¸è¡¨ç¤ºç‰¹å¾å‘é‡ï¼Œ4096ç»´ã€‚
    - è¿™ä¸åŸºäºlbpçš„è¡¨ç¤ºå½¢æˆäº†å¯¹æ¯”ï¼Œå®ƒé€šå¸¸æ±‡é›†éå¸¸å±€éƒ¨çš„æè¿°ç¬¦(é€šè¿‡è®¡ç®—ç›´æ–¹å›¾)ï¼Œå¹¶å°†å…¶ç”¨ä½œåˆ†ç±»å™¨çš„è¾“å…¥ã€‚
- F8ä¸Šäººè„¸è¡¨ç¤ºè¢«é€åˆ°äº† K-way Softmax æ¥äº§ç”Ÿåœ¨ç±»åˆ«æ ‡ç­¾ä¸Šçš„æ¦‚ç‡åˆ†å¸ƒï¼Œç”¨äºåˆ†ç±»ã€‚4030ç»´ï¼Œæ˜¯å› ä¸ºSFCè®­ç»ƒæ•°æ®é›†æœ‰4030ä¸ªäººï¼Œæ¯ä¸ªäººå…·æœ‰800åˆ°1200å¼ äººè„¸å›¾ç‰‡ã€‚
    - è®­ç»ƒçš„ç›®æ ‡æ˜¯æœ€å¤§é™åº¦åœ°æé«˜æ­£ç¡®ç±»åˆ«(äººè„¸id)çš„æ¦‚ç‡ã€‚æœ€å°åŒ–æ¯ä¸ªè®­ç»ƒæ ·æœ¬çš„äº¤å‰ç†µæŸå¤±æ¥å®ç°ï¼Œå¹¶ä½¿ç”¨éšæœºæ¢¯åº¦ä¸‹é™(SGD)æ›´æ–°å‚æ•°ï¼Œä½¿å„å‚æ•°çš„æŸå¤±æœ€å°åŒ–ã€‚ä½¿ç”¨äº†ReLUæ¿€æ´»ã€‚
    - åªå¯¹ç¬¬ä¸€ä¸ªå…¨è¿æ¥å±‚åº”ç”¨äº†dropoutï¼Œç”±äºè®­ç»ƒé›†è¾ƒå¤§ï¼Œæˆ‘ä»¬åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­æ²¡æœ‰è§‚å¯Ÿåˆ°æ˜æ˜¾çš„è¿‡æ‹Ÿåˆã€‚
- äººè„¸è¡¨ç¤ºå½’ä¸€åŒ–ï¼šå°†äººè„¸è¡¨ç¤ºç‰¹å¾å½’ä¸€åŒ–ä¸º0åˆ°1ä¹‹é—´ï¼Œä»¥é™ä½å¯¹å…‰ç…§å˜åŒ–çš„æ•æ„Ÿåº¦ã€‚å¯¹äºF7è¾“å‡ºçš„4096-då‘é‡å…ˆæ¯ä¸€ç»´è¿›è¡Œå½’ä¸€åŒ–ï¼Œå³å¯¹äºç»“æœå‘é‡ä¸­çš„æ¯ä¸€ç»´ï¼Œéƒ½è¦é™¤ä»¥è¯¥ç»´åº¦åœ¨æ•´ä¸ªè®­ç»ƒé›†ä¸Šçš„æœ€å¤§å€¼ï¼›å†å¯¹æ¯ä¸ªå‘é‡è¿›è¡ŒL2å½’ä¸€åŒ–ã€‚
    - å½’ä¸€åŒ–åçš„DeepFaceç‰¹å¾å‘é‡ä¸ä¼ ç»Ÿçš„åŸºäºç›´æ–¹å›¾çš„ç‰¹å¾ï¼ˆå¦‚LBPï¼‰æœ‰ç›¸åŒä¹‹å¤„ï¼šæ‰€æœ‰å€¼å‡éè´Ÿï¼›éå¸¸ç¨€ç–ï¼›ç‰¹å¾å…ƒç´ çš„å€¼éƒ½åœ¨åŒºé—´[0,1]ä¹‹é—´ã€‚

{% asset_img 3.webp %}
{% asset_img 4.webp %}

***

### äººè„¸éªŒè¯ï¼ˆFace Verificationï¼‰

- äººè„¸éªŒè¯çš„ç›®æ ‡æ˜¯åˆ¤æ–­ä¸¤ä¸ªäººè„¸å›¾åƒæ˜¯å¦å±äºåŒä¸€ä¸ªäººçš„ï¼Œ1:1
- è€ƒè™‘æ— çº¦æŸç¯å¢ƒä¸­çš„é—®é¢˜ï¼šåˆ†è¾¨ç‡ä¸å¤ªé«˜ï¼Œè§†è§’å¯ä»¥ä¾§è„¸å’Œæ—‹è½¬ï¼Œå…‰ç…§ä»»æ„ï¼Œé®æŒ¡å¯ä»¥æœ‰ã€‚

{% asset_img 5.webp %}

***

### äººè„¸éªŒè¯æŒ‡æ ‡

éªŒè¯å°±æ˜¯è¾“å…¥ä¸¤ä¸ªå®ä¾‹ï¼Œåˆ¤æ–­å®ƒä»¬æ˜¯ä¸æ˜¯å±äºåŒä¸€ç±»ã€‚

1. æ— ç›‘ç£ç›¸ä¼¼æ€§æŒ‡æ ‡ï¼šç›´æ¥å¯¹ä¸¤ä¸ªå½’ä¸€åŒ–çš„ç‰¹å¾å‘é‡åšå†…ç§¯ã€‚
DeepFaceçš„ç›®æ ‡æ˜¯å­¦ä¹ ä¸€ç§æ— ç›‘ç£çš„æŒ‡æ ‡ï¼Œå®ƒå¯ä»¥å¾ˆå¥½åœ°æ³›åŒ–åˆ°å‡ ä¸ªæ•°æ®é›†ã€‚
2. æœ‰ç›‘ç£åº¦é‡æŒ‡æ ‡ï¼š å¡æ–¹ç›¸ä¼¼åº¦æˆ–å­ªç”Ÿç½‘ç»œã€‚
æœ‰ç›‘ç£çš„æ–¹æ³•ç›¸å¯¹äºæ— ç›‘ç£çš„æ–¹æ³•è¡¨ç°å‡ºæ˜æ˜¾çš„æ€§èƒ½ä¼˜åŠ¿ã€‚é€šè¿‡å¯¹ç›®æ ‡åŸŸçš„è®­ç»ƒé›†è¿›è¡Œè®­ç»ƒï¼Œå¯ä»¥å¯¹ç‰¹å¾å‘é‡(æˆ–åˆ†ç±»å™¨)è¿›è¡Œå¾®è°ƒï¼Œä»è€Œæ›´å¥½åœ°åœ¨æ•°æ®é›†çš„ç‰¹å®šåˆ†å¸ƒèŒƒå›´å†…æ‰§è¡Œã€‚ä½†è®­ç»ƒæ•°æ®å’Œæµ‹è¯•æ•°æ®çš„ä¸ä¸€è‡´ä¼šå¯¼è‡´å¾ˆå·®çš„æ³›åŒ–èƒ½åŠ›ï¼Œå¦‚æœå°†æ¨¡å‹æ‹Ÿåˆåœ¨å°çš„æ•°æ®é›†åˆ™ä¼šå¤§å¤§å‡å°å®ƒæ³›åŒ–åˆ°å…¶å®ƒæ•°æ®é›†çš„èƒ½åŠ›ã€‚

ï¼ˆ1ï¼‰ åŠ æƒçš„Ï‡2è·ç¦»ï¼ˆWeighted Ï‡2 distanceï¼‰

{% asset_img 6.webp %}

ï¼ˆ2ï¼‰ Siamese network ï¼ˆå¹¶ä½¿ç”¨åŠ æƒL1è·ç¦»ï¼‰
æŠŠä¸Šé¢é‚£ä¸ªç½‘ç»œï¼Œå¤åˆ¶ä¸¤ä»½ï¼Œä¸¤ä¸ªäººè„¸åˆ†åˆ«è¾“å…¥ä¸¤ä¸ªå°ç½‘ç»œï¼Œä¸¤ä¸ªå°ç½‘ç»œå…±äº«å‚æ•°ï¼Œæœ€åè®¡ç®—ä¸¤ä¸ªè¾“å‡ºçš„ç‰¹å¾å‘é‡çš„è·ç¦»ï¼Œç”¨ä¸€ä¸ªå…¨è¿æ¥å±‚æ˜ å°„ä¸ºä¸€ä¸ªé€»è¾‘å•å…ƒï¼ˆç›¸åŒè¿˜æ˜¯ä¸ç›¸åŒï¼‰ã€‚ç½‘ç»œçš„å‚æ•°å’Œä¸Šé¢äººè„¸è¡¨ç¤ºç½‘ç»œçš„ä¸€è‡´ï¼Œä¸ºäº†é˜²æ­¢è¿‡æ‹Ÿåˆï¼Œè®­ç»ƒçš„æ—¶å€™åªè®­ç»ƒæœ€é«˜ä¸¤å±‚ã€‚
åœ¨Siameseç½‘ç»œä¸­ï¼Œä»¥äººè„¸éªŒè¯ä¸ºç›®æ ‡ï¼Œç‰¹å¾æå–å’Œäººè„¸è¯†åˆ«æ˜¯è”åˆå­¦ä¹ ã€‚

{% asset_img 7.webp %}
{% asset_img 8.webp %}

***

### å±€éƒ¨è¿æ¥å±‚

- å…¨è¿æ¥å±‚ï¼ˆFully-Connected Layer,ï¼‰ï¼šæ²¡æœ‰æƒé‡å…±äº«ã€‚åˆ¤æ–­æ–¹æ³•å¦‚ä¸‹ï¼š
    - filter sizeç­‰äºinput sizeåˆ™æ˜¯fully connectedï¼Œæ•´ä¸ªpatchåªç”¨ä¸€ä¸ªå¤§å·ç§¯æ ¸ã€‚
    - ç‚¹å¯¹ç‚¹çš„è¿æ¥éƒ½æ˜¯fully connected.ï¼ˆè¿™é‡Œå…¶å®å°±æ˜¯MLPï¼‰
    - å½“1x1ä¸ç­‰äºinput sizeçš„æ—¶å€™ï¼Œ1x1çš„å·ç§¯æ ¸ä¸€æ ·å…·å¤‡weights shareçš„èƒ½åŠ›ï¼Œæ­¤æ—¶ä¸æ˜¯å…¨è¿æ¥å±‚ã€‚
- å·ç§¯å±‚ï¼ˆConvolutional Layer,CNNï¼‰ï¼šå½“æ•°æ®é›†å…·æœ‰å…¨å±€çš„å±€éƒ¨ç‰¹å¾åˆ†å¸ƒæ—¶ï¼Œä¹Ÿå°±æ˜¯è¯´å±€éƒ¨ç‰¹å¾ä¹‹é—´æœ‰è¾ƒå¼ºçš„ç›¸å…³æ€§ï¼Œé€‚åˆç”¨å…¨å·ç§¯ã€‚æ¯ä¸€ä¸ªç‚¹éƒ½ç”¨åŒä¸€ä¸ªfilterï¼Œæƒé‡å…±äº«ã€‚
    - å·ç§¯å±‚ä¸­çš„å‚æ•°å…±äº«å¹¶ä¸æ˜¯æ¯ä¸ªåœºæ™¯ä¸‹éƒ½åˆé€‚çš„ã€‚æœ‰ä¸€äº›ç‰¹å®šçš„åœºåˆï¼Œç‰¹åˆ«æ˜¯å½“è¾“å…¥å›¾åƒæ˜¯ä¸€äº›æ˜ç¡®çš„ä¸­å¿ƒç»“æ„æ—¶å€™ï¼Œæˆ‘ä»¬ä¸èƒ½æŠŠå›¾ç‰‡ä¸Šçš„è¿™äº›çª—å£æ•°æ®éƒ½è§†ä½œä½œç”¨ç­‰åŒçš„ã€‚å½“å›¾åƒçš„å±€éƒ¨ç›¸ä¼¼æ—¶ï¼Œæˆ‘ä»¬å°±åº”è¯¥æœŸæœ›åœ¨å›¾ç‰‡çš„ä¸åŒä½ç½®å­¦ä¹ åˆ°å®Œå…¨ä¸åŒçš„ç‰¹å¾ã€‚
- å±€éƒ¨è¿æ¥å±‚ï¼ˆLocally Connected Layers,LCNï¼‰ï¼šåœ¨ä¸åŒçš„åŒºåŸŸæœ‰ä¸åŒçš„ç‰¹å¾åˆ†å¸ƒæ—¶ï¼Œé€‚åˆç”¨local-Convã€‚æ¯ä¸ªç‚¹çš„å·ç§¯æ ¸éƒ½ä¸ä¸€æ ·ï¼Œæƒé‡ä¸å…±äº«ã€‚
    - æ¯”å¦‚äººè„¸è¯†åˆ«ä¸­ï¼Œé€šå¸¸å°±æ”¾æ¾å‚æ•°å…±äº«çš„é™åˆ¶ã€‚ä¸€èˆ¬äººçš„é¢éƒ¨éƒ½é›†ä¸­åœ¨å›¾åƒçš„ä¸­å¤®ï¼Œä½ å¯èƒ½æœŸæœ›ä¸åŒçš„ç‰¹å¾ï¼Œæ¯”å¦‚çœ¼ç›ç‰¹å¾æˆ–è€…å˜´ç‰¹å¾å¯èƒ½ï¼ˆä¹Ÿåº”è¯¥ï¼‰ä¼šåœ¨å›¾ç‰‡çš„ä¸åŒä½ç½®è¢«å­¦ä¹ ã€‚å› æ­¤æˆ‘ä»¬å¸Œæœ›ï¼Œæ•°æ®çª—å£æ»‘è¿‡è¿™å—åŒºåŸŸçš„æ—¶å€™ï¼Œæƒé‡å’Œå…¶ä»–è¾¹ç¼˜åŒºåŸŸæ˜¯ä¸åŒçš„ã€‚

{% asset_img 9.webp %}

{% asset_img 10.webp %}

***

### æ•°æ®é›†

- æœ¬æ–‡æå‡ºçš„äººè„¸è¡¨ç¤ºæ˜¯ä»SFCæ•°æ®é›†è®­ç»ƒï¼Œç„¶åå°†è¡¨ç¤ºåº”ç”¨äºLFWï¼Œä»¥åŠYouTube Facesï¼ˆYTFï¼‰æ•°æ®é›†ã€‚
- æ–°æ”¶é›†çš„æ•°æ®é›†ï¼šç¤¾äº¤äººè„¸åˆ†ç±»ï¼ˆSocial Face Classification ï¼Œ SFCï¼‰æ•°æ®é›†ã€‚ SFCæ•°æ®é›†æ¥è‡ªFacebookçš„å¤§é‡ç…§ç‰‡ï¼ŒåŒ…æ‹¬4030ä¸ªäººçš„440ä¸‡å¼ æ ‡è®°äººè„¸ï¼Œæ¯ä¸ªäººå…·æœ‰800åˆ°1200å¼ äººè„¸å›¾ç‰‡ã€‚
- LFWæ•°æ®é›†ï¼šç”±5,749ä¸ªåäººçš„13,323å¼ ç½‘ç»œç…§ç‰‡ç»„æˆï¼Œè¿™äº›ç…§ç‰‡åœ¨10ä¸ªåˆ†ç»„ä¸­åˆ†ä¸º6,000ä¸ªäººè„¸å¯¹ã€‚è¿™æ˜¯åœ¨æ— çº¦æŸç¯å¢ƒä¸­è¿›è¡Œäººè„¸éªŒè¯çš„åŸºå‡†æ•°æ®é›†ã€‚
- YouTube Facesï¼ˆYTFï¼‰è§†é¢‘æ•°æ®é›†ï¼šæ”¶é›†äº†3,425ä¸ª1,595ä¸ªä¸»é¢˜çš„YouTubeè§†é¢‘ï¼Œåˆ†ä¸º5,000ä¸ªè§†é¢‘å¯¹å’Œ10ä¸ªåˆ†ç»„ï¼Œç”¨äºè¯„ä¼°è§†é¢‘çº§äººè„¸éªŒè¯ã€‚

***

### è®­ç»ƒè¡¨ç¤ºç½‘ç»œ

æˆ‘ä»¬é¦–å…ˆä½¿ç”¨ä¸€ä¸ªåŸºäºgpuçš„å¼•æ“å°†SFCä¸Šçš„æ·±åº¦ç¥ç»ç½‘ç»œè®­ç»ƒæˆä¸€ä¸ªå¤šç±»åˆ†ç±»é—®é¢˜ï¼Œé€šè¿‡åŠ¨é‡(è®¾ç½®ä¸º0.9)çš„éšæœºæ¢¯åº¦ä¸‹é™(SGD)åœ¨å‰é¦ˆç½‘ç»œä¸Šå®ç°æ ‡å‡†çš„åå‘ä¼ æ’­ã€‚mini-batch=128ï¼Œå¹¶å°†æ‰€æœ‰å¯è®­ç»ƒå±‚çš„å¹³å‡å­¦ä¹ ç‡è®¾ç½®ä¸º0.01ï¼Œå½“éªŒè¯é”™è¯¯åœæ­¢ä¸‹é™æ—¶ï¼Œæ‰‹åŠ¨å°†å­¦ä¹ ç‡é™ä½ä¸€ä¸ªæ•°é‡çº§ï¼Œæœ€ç»ˆå­¦ä¹ ç‡ä¸º0.0001ã€‚æˆ‘ä»¬åœ¨æ¯ä¸€å±‚åˆå§‹åŒ–æƒé‡ä»é›¶å‡å€¼é«˜æ–¯åˆ†å¸ƒå’ŒÏƒ=0.01å’Œåè§è®¾ç½®ä¸º0.5ã€‚æˆ‘ä»¬å¯¹æ•´ä¸ªç½‘ç»œè¿›è¡Œäº†å¤§çº¦15æ¬¡æ‰«æ(epoch)ï¼Œè€—æ—¶3å¤©ã€‚æœ€åæå–äº†å…¨è¿é€šå±‚F7çš„å“åº”ä½œä¸ºäººè„¸è¡¨ç¤ºã€‚

***

### å®ç°æ•ˆæœ

æˆ‘ä»¬ä»¥5%çš„**SFC**æ•°æ®ä½œä¸ºæµ‹è¯•é›†ï¼Œæ ¹æ®åˆ†ç±»è¯¯å·®å¯¹DNNçš„ä¸åŒè®¾è®¡æ–¹æ¡ˆè¿›è¡Œäº†è¯„ä»·ã€‚ä»1.5Käººåˆ°4.4käººï¼Œå‚ä¸è®­ç»ƒçš„äººæ•°è¶Šå¤šåˆ†ç±»æ•ˆæœè¶Šå¥½ï¼›æ•°æ®é›†æ ·æœ¬æ•°é‡è¶Šå¤šè¯¯å·®è¶Šå°ï¼Œå¤ªå°‘å®¹æ˜“è¿‡æ‹Ÿåˆï¼›ç½‘ç»œå±‚è¶Šæ·±è¯¯å·®è¶Šå°ã€‚

{% asset_img 11.webp %}

**LFW**ä¸Šæµ‹è¯•ï¼Œæ— ç›‘ç£ä¸å¦‚æœ‰ç›‘ç£æ€§èƒ½å¥½ï¼Œé›†æˆå­¦ä¹ æ€§èƒ½æ›´å¥½ï¼Œåœ¨LFWæ•°æ®é›†è¾¾åˆ°äº†97.35ï¼…çš„å‡†ç¡®åº¦ï¼Œå°†å½“æ—¶æŠ€æœ¯æ°´å¹³çš„è¯¯å·®å‡å°‘äº†27ï¼…ä»¥ä¸Šï¼Œæ¥è¿‘äººç±»æ°´å¹³çš„è¡¨ç°ã€‚

- DeepFace-singleï¼šLFWå›¾åƒä¸SFCè®­ç»ƒæ•°æ®é›†ä¸Šç”¨åŒä¸€ç§å¤„ç†æ–¹æ³•ï¼Œè®°ä¸ºDeepFace-singleã€‚æ— ç›‘ç£çš„éªŒè¯æ–¹æ³•è¾¾åˆ°95.97%ï¼Œç›´æ¥æ¯”è¾ƒå½’ä¸€åŒ–ä¹‹åçš„ç‰¹å¾å¯¹çš„å†…ç§¯ã€‚æœ‰ç›‘ç£çš„Ï‡2-distanceæ–¹æ³•åœ¨5400å¯¹å¸¦æ ‡è®°çš„LFWäººè„¸å¯¹ä¸Šæµ‹è¯•ï¼Œè¾¾åˆ°äº†è¾¾åˆ°97%ï¼Œéƒ½è¿œè¿œé«˜äºå½“æ—¶æ°´å¹³ã€‚
- DeepFace-ensembleï¼šé›†æˆæ•ˆæœï¼Œç»“åˆäº†å¤šä¸ªè®­ç»ƒçš„ç½‘ç»œï¼Œé€šè¿‡å°†ä¸åŒç±»å‹çš„è¾“å…¥è¾“å…¥åˆ°DNNï¼ˆåŸºäºä¸‰ç»´å¯¹é½çš„RGBè¾“å…¥çš„DeepFace-singleï¼›ç°åº¦å›¾åŠ ä¸Šå›¾åƒæ¢¯åº¦å¤§å°å’Œæ–¹å‘ï¼›2då¯¹é½çš„RGBå›¾åƒï¼‰ã€‚
    - ä½¿ç”¨åŸºäºCPDæ ¸çš„éçº¿æ€§SVMæ¥å°†è¿™äº›è·ç¦»åº¦é‡ç»“åˆèµ·æ¥ï¼Œæœ‰é™åˆ¶97.15%ï¼š

{% asset_img 12.webp %}

- æ— ç›‘ç£(unrestricted)åè®®åœ¨è®­ç»ƒé›†ä¸Šä¸ºè¿ç®—ç¬¦æä¾›æœ‰å…³æ’ç­‰å¼çš„çŸ¥è¯†ï¼Œå› æ­¤ï¼Œå¯ä»¥ç”Ÿæˆæ›´å¤šçš„è®­ç»ƒå¯¹æ¥æ·»åŠ åˆ°è®­ç»ƒé›†ä¸­ã€‚é€šè¿‡å¾®è°ƒå­ªç”Ÿç½‘ç»œ(å…±äº«)é¢„å…ˆè®­ç»ƒçš„ç‰¹å¾æå–å™¨æ¥å­¦ä¹ éªŒè¯æŒ‡æ ‡è¿‡ç¨‹ä¸­ï¼Œæœ‰å¤§é‡çš„è®­ç»ƒæ•°æ®è¿‡æ‹Ÿåˆã€‚ä½¿ç”¨LFWè®­ç»ƒæ•°æ®ç”Ÿæˆçš„è®­ç»ƒå¯¹æ˜¯å†—ä½™çš„ï¼Œå› ä¸ºå®ƒä»¬æ˜¯ä»å¤§çº¦9Kå¼ ç…§ç‰‡ä¸­ç”Ÿæˆçš„ï¼Œä¸è¶³ä»¥å¯é åœ°ä¼°è®¡è¶…è¿‡1.2äº¿ä¸ªå‚æ•°ã€‚æ‰€ä»¥æˆ‘ä»¬æ”¶é›†äº†ä¸€ä¸ªä¸SFCç›¸åŒç¨‹åºçš„é™„åŠ æ•°æ®é›†ï¼ŒåŒ…å«é¢å¤–çš„10ä¸‡ä¸ªæ–°äººç‰©ï¼Œæ¯ä¸ªäººç‰©æœ‰30ä¸ªæ ·æœ¬ï¼Œå¯ä»ä¸­ç”Ÿæˆç›¸åŒå’Œä¸ç›¸åŒçš„å¯¹ã€‚ç„¶åæˆ‘ä»¬åœ¨æ­¤åŸºç¡€ä¸Šå¯¹å­ªç”Ÿç½‘ç»œè¿›è¡Œè®­ç»ƒï¼Œç„¶ååœ¨LFWæ— ç›‘ç£è®­ç»ƒåˆ†å‰²ä¸Šè¿›è¡Œä¸¤ä¸ªè®­ç»ƒé˜¶æ®µï¼Œä»¥çº æ­£ä¸€äº›æ•°æ®é›†ç›¸å…³åå·®ã€‚å¹¶å°†Siameseç½‘ç»œä¸ä¸Šè¿°ç½‘ç»œç»“åˆèµ·æ¥ï¼Œæ— ç›‘ç£97.25%ï¼š

{% asset_img 13.webp %}

- åˆé¢å¤–å¢åŠ äº†4ä¸ªDeepFace-singleåˆ°é›†æˆï¼Œæ¯ä¸ªéƒ½ä»é›¶å¼€å§‹ç”¨ä¸åŒçš„éšæœºç§å­è®­ç»ƒï¼Œæ— é™åˆ¶97.35%ã€‚

{% asset_img 14.webp %}

- å¦å¤–ä»…ä½¿ç”¨äºŒç»´å¯¹é½æ—¶ï¼Œç²¾åº¦ä»…ä¸º94.3%ã€‚å®Œå…¨æ²¡æœ‰å¯¹é½ï¼Œç²¾åº¦ä¸º87.9%ï¼Œå³é‡‡ç”¨ä¸­å¿ƒè£å‰ªçš„äººè„¸æ£€æµ‹çš„é¢éƒ¨åŒºåŸŸå¯èƒ½ä¼šè„±è½ã€‚æ²¡æœ‰å­¦ä¹ ï¼Œå½“åªä½¿ç”¨æ­£é¢åŒ–å’Œä¸€ä¸ªæœ´ç´ çš„LBP/SVMç»„åˆæ—¶ï¼Œå‡†ç¡®ç‡ä¸º91:4%ã€‚

{% asset_img 15.webp %}

{% asset_img 16.webp %}

**TYF**è§†é¢‘çº§äººè„¸éªŒè¯æ•°æ®é›†ä¸Šæ€§èƒ½ä¹Ÿå¥½å¾ˆå¤šï¼ŒROCæ›²çº¿ä¸ŠDeepFaceåœ¨å·¦ä¸Šè§’ï¼Œæ€§èƒ½æœ€å¥½ã€‚æˆ‘ä»¬é€šè¿‡ä¸ºæ¯å¯¹è®­ç»ƒè§†é¢‘åˆ›å»º50å¯¹å¸§(æ¯ä¸ªè§†é¢‘ä¸€ä¸ªå¸§)æ¥ç›´æ¥ä½¿ç”¨DeepFace-Singleè¡¨ç¤ºï¼Œå¹¶æ ¹æ®è§†é¢‘è®­ç»ƒå¯¹å°†è¿™äº›å¸§æ ‡è®°ä¸ºç›¸åŒæˆ–ä¸ç›¸åŒï¼Œç„¶åè®­ç»ƒç½‘ç»œã€‚æµ‹è¯•æ—¶ï¼Œç»™å‡ºä¸€ä¸ªæµ‹è¯•è§†é¢‘å¯¹åï¼Œä»æ¯æ®µè§†é¢‘ä¸­éšæœºé€‰å‡º100ä¸ªè§†é¢‘å¸§å¯¹ï¼Œå°†è¾“å‡ºçš„ç»“æœå–å‡å€¼ä½œä¸ºåˆ¤æ–­çš„ä¾æ®ã€‚ä½¿ç”¨æœ‰ç›‘ç£weighted Ï‡2éªŒè¯ã€‚åœ¨YTFä¸Š91.4%ï¼Œç”±äºYTFåº“ä¸­æœ‰100ä¸ªæ ‡æ³¨é”™è¯¯çš„è§†é¢‘å¯¹ï¼Œç»è¿‡æ”¹æ­£åï¼Œè¾¾åˆ°äº†92.5%ã€‚è¿™ä¹Ÿè¯æ˜æˆ‘ä»¬çš„DeepFaceæ–¹æ³•ï¼Œåœ¨å…¶ä»–é¢†åŸŸä¹Ÿå…·æœ‰å¾ˆå¥½çš„æ³›åŒ–æ€§èƒ½ï¼ˆè§†é¢‘äººè„¸éªŒè¯ï¼‰ã€‚

**è®¡ç®—é€Ÿåº¦**ï¼šä½¿ç”¨è‹±ç‰¹å°”2.2GHzçš„å•æ ¸å¿ƒCPUï¼Œä»åŸå§‹è¾“å…¥åƒç´ ä¸­æå–ç‰¹å¾0.18ç§’ï¼Œå¯¹é½è¦0.05ç§’ã€‚æ€»çš„æ¥è¯´ï¼ŒDeepFaceæ˜¯æ¯å¹…å›¾åƒ0.33ç§’ï¼Œå«å›¾åƒè§£ç ã€äººè„¸æ£€æµ‹ä¸æ¯”å¯¹ã€å‰é¦ˆç½‘ç»œã€æœ€ç»ˆåˆ†ç±»è¾“å‡ºã€‚

***

### å‚è€ƒèµ„æ–™

> <https://zhuanlan.zhihu.com/p/76513217>
> <https://blog.csdn.net/stdcoutzyx/article/details/46776415>
