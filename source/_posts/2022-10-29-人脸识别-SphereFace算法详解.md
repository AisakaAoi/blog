---
title: äººè„¸è¯†åˆ«-SphereFaceç®—æ³•è¯¦è§£
categories:
  - ğŸŒ™è¿›é˜¶å­¦ä¹ 
  - â­äººå·¥æ™ºèƒ½ Artificial Intelligence
  - ğŸ’«ç ”ç©¶é¢†åŸŸ Research Area
  - ğŸ›°ï¸è®¡ç®—æœºè§†è§‰ Computer Vision
  - â˜„ï¸äººè„¸è¯†åˆ« Face Recognition
abbrlink: e62a374d
date: 2022-10-29 06:37:25
tags:
---

è®ºæ–‡ï¼šSphereFace: Deep Hypersphere Embedding for Face Recognition
è®ºæ–‡é“¾æ¥ï¼š<https://arxiv.org/abs/1704.08063>
ä»£ç åœ°å€ï¼š<https://github.com/wy1iu/sphereface>

è¿™ç¯‡æ˜¯CVPR2017çš„æ–‡ç« ï¼Œç”¨æ”¹è¿›çš„softmaxåšäººè„¸è¯†åˆ«ï¼Œæ”¹è¿›ç‚¹æ˜¯æå‡ºäº† angular softmax lossï¼ˆA-softmax lossï¼‰ç”¨æ¥æ”¹è¿›åŸæ¥çš„softmax lossã€‚å¦‚æœä½ äº†è§£large margin softmax lossï¼ˆä½œè€…å’ŒA-softmax lossæ˜¯åŒä¸€æ‰¹äººï¼‰ï¼Œ**é‚£ä¹ˆA-softmax lossç®€å•è®²å°±æ˜¯åœ¨large margin softmax lossçš„åŸºç¡€ä¸Šæ·»åŠ äº†ä¸¤ä¸ªé™åˆ¶æ¡ä»¶||W||=1å’Œb=0ï¼Œä½¿å¾—é¢„æµ‹ä»…å–å†³äºWå’Œxä¹‹é—´çš„è§’åº¦ã€‚**

<!--more-->

***

Figure2ä¸­å±•ç¤ºçš„æ˜¯ç”¨ä¸€ä¸ªCNNç½‘ç»œæå–ç‰¹å¾ï¼Œç„¶åå°†æå–åˆ°çš„ç‰¹å¾åœ¨ç±»åˆ«é—´çš„åˆ†å¸ƒå±•ç¤ºå‡ºæ¥ã€‚ï¼ˆaï¼‰å’Œï¼ˆbï¼‰æ˜¯softmax lossçš„ç»“æœï¼›ï¼ˆcï¼‰å’Œï¼ˆdï¼‰æ˜¯é™åˆ¶W1å’ŒW2å‘é‡çš„æ¨¡ç­‰äº1ï¼Œè€Œä¸”b1å’Œb2åç½®ç­‰äº0ï¼Œç§°ä¸ºmodified softmax lossï¼›ï¼ˆeï¼‰å’Œï¼ˆfï¼‰æ˜¯æœ¬æ–‡çš„angular softmax lossï¼Œåé¢è¯¦ç»†ä»‹ç»ã€‚æ¥ä¸‹æ¥ä»‹ç»Figure2å›¾çš„å«ä¹‰ï¼šå›¾ä¸­ç‰¹å¾æ˜¯2ç»´çš„ï¼Œå¯¹åº”æ¨ªåæ ‡ï¼Œæ¯•ç«ŸäºŒç»´çš„å®¹æ˜“è§‚å¯Ÿï¼Œè¿™å¯ä»¥é€šè¿‡å°†æœ€åä¸€ä¸ªæç‰¹å¾å±‚ï¼ˆå‡è®¾æœ€åä¸€ä¸ªç‰¹å¾æå–å±‚æ˜¯å·ç§¯å±‚ï¼Œé‚£ä¹ˆå°±å°†å·ç§¯æ ¸æ•°é‡è®¾ç½®ä¸º2ï¼‰å°±èƒ½å¾—åˆ°ï¼Œå› æ­¤å¯¹äºä¸€å¼ è¾“å…¥å›¾åƒï¼Œå°±èƒ½å¾—åˆ°1 * 2ç»´åº¦çš„ç‰¹å¾å‘é‡ï¼Œå°±å¯ä»¥åœ¨äºŒç»´åæ ‡ç©ºé—´ä¸­ç”»å‡ºæ¥è¿™ä¸ªç‚¹äº†ï¼Œå¯¹åº”Figure2ï¼ˆaï¼‰ã€ï¼ˆcï¼‰ã€ï¼ˆeï¼‰ä¸­çš„ç‚¹ã€‚æœ€åæ¥ä¸€ä¸ªå…¨è¿æ¥å±‚ï¼Œå¯¹äºFigure2ä¸­çš„äºŒåˆ†ç±»è€Œè¨€ï¼ˆä¸€ä¸ªç±»åˆ«æ˜¯é»„è‰²ç‚¹ï¼Œå¦ä¸€ä¸ªç±»åˆ«æ˜¯çº¢è‰²ç‚¹ï¼‰ï¼Œå…¨è¿æ¥å±‚çš„ç»´åº¦å°±æ˜¯2 * 2ï¼Œåé¢ä¸€ä¸ª2å°±æ˜¯ç±»åˆ«çš„æ„æ€ã€‚å†çœ‹çœ‹ï¼ˆbï¼‰ï¼ŒW1å’ŒW2åˆ†åˆ«æ˜¯I * 2çš„å‘é‡ï¼Œåˆåœ¨ä¸€èµ·å°±æ˜¯2 * 2çš„å…¨è¿æ¥å±‚å‚æ•°ï¼Œå› æ­¤W1å’ŒW2çš„ç®­å¤´ä½ç½®æ‰€åœ¨çš„åæ ‡å°±æ˜¯1 * 2å‘é‡çš„å€¼ï¼Œè¿™æ ·å°±å¯ä»¥ç”»å‡ºå›¾ä¸­çš„çº¢è‰²ç®­å¤´äº†ï¼Œè‡³äºä¸­é—´çš„çº¢è‰²çº¿ï¼Œå°±æ˜¯åˆ†ç±»ç•Œé™ã€‚åŒç†ï¼ˆdï¼‰ä¸­W1å’ŒW2çš„æ¨¡ç­‰äº1ï¼Œç‰¹å¾ç‚¹ä¹‹æ‰€ä»¥ç±»ä¼¼åœ†å½¢æ˜¯å°†ï¼ˆcï¼‰ä¸­çš„ç‰¹å¾ç‚¹å˜æ¢æˆæ¨¡ä¸º1çš„ç‰¹å¾ç‚¹ï¼›ï¼ˆeï¼‰ã€ï¼ˆfï¼‰çš„å«ä¹‰å’Œï¼ˆcï¼‰ã€ï¼ˆdï¼‰çš„å«ä¹‰åŒç†ã€‚

{% asset_img 1.webp %}

æ¥ä¸‹æ¥ä»‹ç»A-softmax lossçš„å†…å®¹ã€‚è¿˜æ˜¯å…ˆä»softmax losså¼€å§‹è®²èµ·ã€‚å‡è®¾ä¸€ä¸ªäºŒåˆ†ç±»é—®é¢˜ï¼Œé‚£ä¹ˆä¸‹é¢çš„å…¬å¼1å’Œ2åˆ†åˆ«è¡¨ç¤ºæ ·æœ¬xå±äºç±»åˆ«1å’Œç±»åˆ«2çš„æ¦‚ç‡ï¼Œè¿™ä¸ªè®¡ç®—çš„è¿‡ç¨‹å°±æ˜¯softmaxã€‚**è¿™é‡Œçš„W1å’ŒW2éƒ½æ˜¯å‘é‡ï¼ŒäºŒè€…åˆåœ¨ä¸€èµ·ç»„æˆå…¨è¿æ¥å±‚çš„å‚æ•°çŸ©é˜µWï¼Œä¹Ÿå°±æ˜¯W=[W1ï¼ŒW2]ï¼Œå…¨è¿æ¥å±‚çš„è¾“å‡ºä¹Ÿå°±æ˜¯Wxã€‚**å‡è®¾è¾“å‡ºçš„å°ºå¯¸æ˜¯m*nï¼Œé‚£ä¹ˆmå°±è¡¨ç¤ºbatch sizeï¼Œnè¡¨ç¤ºç±»åˆ«æ•°ï¼Œæ‰€ä»¥è¿™é‡Œçš„W1xå’ŒW2xå°±åˆ†åˆ«æ˜¯Wxçš„ä¸¤åˆ—ã€‚åç½®bæ¯”è¾ƒç®€å•å°±ä¸è¯¦ç»†è¯´äº†ã€‚å› æ­¤å¦‚æœp1å¤§äºp2ï¼Œé‚£ä¹ˆxå±äºç±»åˆ«1ã€‚

{% asset_img 2.webp %}

è¿™ä¸ªæ—¶å€™å¯ä»¥è”æƒ³åˆ°æ–‡ç« å‰é¢æåˆ°çš„ä¸€ä¸ªå…¬å¼ï¼š

{% asset_img 3.webp %}

æ–‡ç« è¯´è¿™æ˜¯softmaxçš„decision boundaryï¼Œæ€ä¹ˆç†è§£å‘¢ï¼Ÿ**å…¶å®å°±æ˜¯p1=p2çš„æƒ…å†µï¼Œæ­¤æ—¶W1x+b1=W2x+b2ã€‚å¦‚æœp1>p2ï¼Œä»p1å’Œp2çš„å…¬å¼å¯ä»¥çœ‹å‡ºäºŒè€…çš„åˆ†æ¯æ˜¯ä¸€æ ·çš„ï¼Œåˆ†å­éƒ½æ˜¯ä»¥eä¸ºåº•çš„æŒ‡æ•°å‡½æ•°ï¼Œæ˜¯é€’å¢çš„ï¼Œå› æ­¤å°±ç›¸å½“äºW1x+b1>W2x+b2ã€‚**

å…¬å¼1å’Œ2åªæ˜¯softmaxï¼Œå¹¶ä¸æ˜¯softmax lossï¼Œè¿™ä¸¤è€…æ˜¯æœ‰å·®åˆ«çš„ï¼Œä¸€ä¸ªæ˜¯æ¦‚ç‡ï¼Œä¸€ä¸ªæ˜¯æŸå¤±ã€‚softmax lossçš„å…¬å¼å¦‚ä¸‹ï¼š

{% asset_img 4.webp %}

**å…¬å¼3çš„logå‡½æ•°çš„è¾“å…¥å°±æ˜¯å‰é¢å…¬å¼1å’Œ2çš„p1å’Œp2ï¼Œåªä¸è¿‡ä¸éœ€è¦åˆ†å¼€å†™æˆW1å’ŒW2ï¼Œè€Œæ˜¯ç”¨Wå°±è¡Œã€‚è¿™é‡Œyiè¡¨ç¤ºæŸä¸ªç±»åˆ«ï¼Œjè¡¨ç¤ºæ‰€æœ‰ç±»åˆ«ã€‚**

å…¬å¼4æ˜¯å°†Liå±•å¼€æ¥å†™ï¼Œå¹¶ä¸”å¼•å…¥äº†è§’åº¦å‚æ•°ï¼š

{% asset_img 5.webp %}

ä¸ºä»€ä¹ˆå…¬å¼4çš„ä¸Šä¸‹ä¸¤ä¸ªç­‰å¼æ˜¯æˆç«‹çš„ï¼Ÿå› ä¸ºå¯ä»¥å°†çŸ©é˜µç›¸ä¹˜ï¼š

{% asset_img 6.webp %}

å†™æˆï¼š

{% asset_img 7.webp %}

éå¸¸å®¹æ˜“ç†è§£å§ã€‚

é‚£ä¹ˆå¦‚æœå¼•å…¥ä¸‹é¢è¿™ä¸¤ä¸ªé™åˆ¶æ¡ä»¶å‘¢ï¼Ÿ

{% asset_img 8.webp %}

å’Œ

{% asset_img 9.webp %}

é‚£ä¹ˆå…¬å¼3ï¼ˆç»“åˆå…¬å¼4å’Œä¸Šé¢ä¸¤ä¸ªé™åˆ¶æ¡ä»¶çœ‹ï¼‰å°±ä¼šå˜æˆï¼š

{% asset_img 10.webp %}

**é‚£ä¹ˆä¸ºä»€ä¹ˆè¦å¼•å…¥è¿™ä¸¤ä¸ªé™åˆ¶æ¡ä»¶å‘¢ï¼Ÿ**åŸæ¥çš„decision boundaryæ˜¯è¿™æ ·çš„ï¼š

{% asset_img 11.webp %}

å¦‚æœæœ‰ä¸Šé¢çš„ä¸¤ä¸ªé™åˆ¶æ¡ä»¶ï¼Œé‚£ä¹ˆdecision boundaryå°±å˜æˆäº†ï¼š

{% asset_img 12.webp %}

**ä¹Ÿå°±æ˜¯è¯´è¾¹ç•Œçš„ç¡®å®šå˜æˆåªå–å†³äºè§’åº¦äº†ï¼Œè¿™æ ·å°±èƒ½ç®€åŒ–å¾ˆå¤šé—®é¢˜ã€‚**è€Œä¸”ä»Figure2ä¹Ÿå¯ä»¥çœ‹å‡ºè¿™ç§æ“ä½œå¯¹åˆ†ç±»ç»“æœæœ‰ä¿ƒè¿›ä½œç”¨ã€‚

åœ¨è¿™ä¸¤ä¸ªé™åˆ¶æ¡ä»¶çš„åŸºç¡€ä¸Šï¼Œä½œè€…åˆæ·»åŠ äº†å’Œlarge margin softmax lossä¸€æ ·çš„è§’åº¦å‚æ•°ï¼Œä½¿å¾—å…¬å¼5å˜æˆå¦‚ä¸‹çš„å…¬å¼6ï¼š

{% asset_img 13.webp %}

è¿™éƒ¨åˆ†å¯ä»¥å‚è€ƒ[æŸå¤±å‡½æ•°æ”¹è¿›ä¹‹Large-Margin Softmax Loss](https://blog.csdn.net/u014380165/article/details/76864572)ï¼ŒåŸºæœ¬ä¸€æ ·ã€‚æ˜¾ç„¶må€¼è¶Šå¤§ï¼Œä¼˜åŒ–çš„éš¾åº¦ä¹Ÿè¶Šå¤§ï¼Œä½†ç±»åˆ«ä¹‹é—´çš„angular marginä¹Ÿè¶Šå¤§ï¼Œä¹Ÿå°±æ˜¯ç±»é—´è·ç¦»è¶Šå¤§ï¼ŒåŒæ—¶ç±»å†…è·ç¦»è¶Šå°ï¼Œå› æ­¤æ¨¡å‹æ•ˆæœè¶Šå¥½ã€‚æœ¬æ–‡ä¸­å‚æ•°mé»˜è®¤å–4ã€‚

å› ä¸ºåœ¨å…¬å¼6ä¸­éœ€è¦é™å®šÎ¸yçš„èŒƒå›´ä¸º[0, Ï€/m]ï¼Œå› æ­¤ä¸ºäº†å»æ‰è¿™ä¸ªé™åˆ¶ï¼Œå°±æœ‰äº†å…¬å¼7è¿™ç§èƒ½å¤Ÿåœ¨CNNç½‘ç»œä¸­ä¼˜åŒ–çš„å…¬å¼ã€‚

{% asset_img 14.webp %}

**å…¬å¼7ä¹Ÿå°±æ˜¯ä½œè€…æ–‡ä¸­æœ€ç»ˆä½¿ç”¨çš„losså…¬å¼ã€‚å› æ­¤A-softmax losså¯ä»¥çœ‹æˆæ˜¯large margin softmax lossçš„æ”¹è¿›ç‰ˆï¼Œä¹Ÿå°±æ˜¯åœ¨large margin softmax lossçš„åŸºç¡€ä¸Šæ·»åŠ äº†ä¸¤ä¸ªé™åˆ¶æ¡ä»¶ã€‚**

Table1æ˜¯å…³äºæœ¬æ–‡æåˆ°çš„3ä¸ªlossçš„åˆ†ç±»ç•Œé™ï¼ˆdecision boundaryï¼‰å¯¹æ¯”ï¼Œå¯ä»¥çœ‹å‡ºsoftmax lossçš„ä¼˜åŒ–æ˜¯å¯¹Wå’Œxçš„å†…ç§¯è¿›è¡Œçš„ï¼›modified softmax lossï¼ˆä¹Ÿå°±æ˜¯é™åˆ¶Wiçš„æ¨¡ä¸º1ï¼Œbiä¸º0ï¼‰çš„ä¼˜åŒ–æ˜¯å¯¹è§’åº¦Î¸iè¿›è¡Œçš„ï¼›A-softmax lossçš„ä¼˜åŒ–ä¹Ÿæ˜¯å¯¹Î¸iè¿›è¡Œï¼Œè€Œä¸”ä¼˜åŒ–ç›®æ ‡æ›´åŠ éš¾ï¼ˆå¼•å…¥må‚æ•°ï¼Œä¼˜åŒ–ååœ¨ç±»åˆ«ä¹‹é—´ä¼šå¾—åˆ°angular marginï¼‰ã€‚

{% asset_img 15.webp %}

Figure3è¡¨ç¤ºä»å‡ ä½•è§’åº¦çœ‹A-softmax lossã€‚

{% asset_img 16.webp %}

åé¢ä½œè€…è¿˜é€šè¿‡æ•°å­¦å…¬å¼è¯æ˜äº†å¯¹äº**äºŒåˆ†ç±»**ï¼Œmçš„æœ€å°å€¼è¦æ»¡è¶³ä¸‹é¢è¿™ä¸ªä¸ç­‰å¼ï¼š

{% asset_img 17.webp %}

å¯¹äº**å¤šåˆ†ç±»**ï¼Œmçš„æœ€å°å€¼è¦æ»¡è¶³ä¸‹é¢è¿™ä¸ªä¸ç­‰å¼ï¼š

{% asset_img 18.webp %}

***

### å‚è€ƒèµ„æ–™

> ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºCSDNåšä¸»ã€ŒAIä¹‹è·¯ã€çš„åŸåˆ›æ–‡ç« ï¼Œéµå¾ªCC 4.0 BY-SAç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥åŠæœ¬å£°æ˜ã€‚
> åŸæ–‡é“¾æ¥ï¼šhttps://blog.csdn.net/u014380165/article/details/76946380
