---
title: J NEURAL ENG | 一种基于EEG的新型意识障碍诊断框架
categories:
  - 🌙进阶学习
  - ⭐脑机接口与混合智能研究团队（BCI团队）
  - 💫学习报告
abbrlink: 517f87d6
date: 2024-09-24 23:27:06
tags:
---

{% asset_img 1.webp %}

该论文发表于Journal of Neural Engineering，题目为《DOCTer: a novel EEG-based diagnosis framework for disorders of consciousness》。浙江大学的赵莎特聘研究员为此文的第一作者，浙江大学脑机智能全国重点实验室主任潘纲教授、浙江大学附属第一医院的罗本燕主任为此文的通讯作者。

论文链接：https://iopscience.iop.org/article/10.1088/1741-2552/ad7904

<!--more-->

***

### 论文概要

在临床实践中，准确评估意识障碍（DOC）患者的意识水平是一项重要而复杂的任务。尽管脑电图（EEG）技术在诊断意识障碍方面已取得进展，但目前的应用仍面临挑战，主要体现在两个方面：1）EEG信号的潜力尚未被完全挖掘；2）现有研究通常受限于较小的数据规模，这限制了模型的泛化能力。针对以上问题，本文提出一个新的深度学习框架DOCTer，能够利用静息状态的EEG信号区分最低意识状态（MCS）与无反应觉醒综合征（UWS）。

DOCTer框架通过深度学习技术，从原始EEG信号中提取出多种关键特征，包括时间-频率特征和微状态特征，并结合患者的临床特征信息进行综合分析，实现对MCS和UWS的准确区分。为了验证DOCTer的有效性，研究团队收集了一个包含409个静息状态EEG记录的大规模数据集，其中包括128例UWS和187例MCS患者的数据。研究结果显示，DOCTer在该数据集上表现出比其他现有方法更高的诊断准确性，尤其是时间/频谱特征在诊断任务中起到了关键作用，这为临床实践带来了新的希望，有望帮助医疗人员更准确地评估和治疗意识障碍患者。

***

### 方法

本文的模型采用端到端的设计，将一系列意识障碍（DOC）患者的EEG信号片段和临床特征作为输入，并输出意识水平的分类结果，即MCS（最低意识状态）或UWS（无反应觉醒综合征）。

***

#### 数据集

作者在浙江大学附属第一医院收集了347名受试者的441个静息状态脑电图（EEG）记录，其中包括128名无反应觉醒综合征（UWS）患者和187名最低意识状态（MCS）患者的409个EEG记录，以及32名健康对照者（HC）的32个EEG记录。意识障碍（DOC）患者的意识水平通过昏迷恢复量表-修订版（CRS-R）评估，EEG数据使用BrainAmp和actiCHamp Plus两种设备采集，符合国际10-5系统标准。

***

#### DOCTer框架

如图1所示，DOCTer框架包含四个模块：时间/频谱特征编码器、微状态编码器、临床特征编码器和分类器。具体来说，时间/频谱特征编码器从EEG记录的片段中提取时间和频谱特征；微状态编码器则提取反映一定程度意识水平的微状态特征；临床特征编码器将病因和疾病过程等临床特征转换为嵌入表示；随后，这些多种特征通过特征融合层进行整合，结合后的表示被输入到分类器模块，以确定DOC患者所属的类别。

{% asset_img 2.webp %}
<div align='center'>图1 用于识别UWS或MCS患者的整体DOCTer框架示意图</div>

***

#### 时间/频谱特征编码器

研究表明不同意识水平的患者在EEG的时间和频率域上存在显著差异，因此本文设计了一个CNN-Transformer编码器，用于对EEG记录中的时间和频谱特征进行编码，从而同时捕捉短期和长期特征，这种方法可以更全面地理解EEG信号，提高对意识障碍患者的识别准确性。如图2所示，CNN模块由三个连续的卷积块组成，应用一维卷积来提取特征；将最后一层CNN的输出输入到标准Transformer编码层，对特征向量应用通道注意力机制，学习每个通道位置的权重，从而使模型能够自动加权不同通道的特征表示，以进一步捕捉EEG记录的全局特征。

{% asset_img 3.webp %}
<div align='center'>图2 CNN-Transformer编码器的部分结构</div>

***

#### 微状态编码器

一些研究已经利用微状态进行意识障碍（DOC）诊断，并发现微状态与意识水平之间存在联系。微状态指的是从多通道EEG记录中发现的亚秒级时间尺度上的头皮电位拓扑图的全局模式，是一种自发的EEG活动，能在一定时间内（60-120毫秒）保持稳定，然后迅速转变为另一种模式，并再次保持稳定。为了弥补CNN在时间域上的感受野有限问题，本文将EEG微状态引入到本文的网络架构中。本文使用通过微状态编码器自动编码微状态，并将嵌入表示与其他特征表示相结合以对DOC患者的意识水平进行诊断。如图3展示了一个MCS患者和一个UWS患者的EEG微状态。

{% asset_img 4.webp %}
<div align='center'>图3 数据集中一个MCS和一个UWS案例的四种微状态</div>

***

#### 临床特征编码器

临床特征包括一系列可观察和可测量的特征、体征和症状，对于诊断和了解疾病非常重要，由于研究表明临床特征与意识水平之间存在关联，本文尝试对这些临床特征进行编码，并将其与其他特征相结合，以评估患者的意识水平。在本文的数据集中，每位患者都具有以下类型的临床特征：性别、年龄、病因和病程，但实验表明“性别和年龄不是预测意识水平的重要因素”，故本文将重点放在病因和病程的研究上。

本文根据病因类型分为三大类：脑出血、创伤性脑损伤和缺氧缺血性脑损伤，经过分类，三个类别中的记录数量分别为194（101例MCS，93例UWS）、160（105例MCS，55例UWS）和55（24例MCS，31例UWS）；而病程指的是疾病持续的时间，以月为单位测量。为了在较低维度空间中有效地处理和表示数据，同时保留语义信息，本文将每个病因和病程类别嵌入到128维的可学习向量中。该嵌入过程以正态分布为基础进行随机初始化。随后，这些嵌入向量通过前馈神经网络进行连接和融合，生成一个代表临床特征的128维特征向量。

***

#### 分类器

综上所述，本文获得了多种特征类型，包括EEG特征、微状态特征和临床特征。然后本文将这些特征进行拼接，并通过一个前馈神经网络进行融合，该神经网络由ELU激活函数和全连接层组成，以获得最终输出。

***

#### 实验设置和性能指标

本文采用十折交叉验证，遵循受试者独立策略，确保每个受试者的数据仅出现在一个子集中，每次实验中，9个子集用于训练，1个子集用于验证，重复10次，最终结果取平均值。实验参数方面，学习率为1e-3，批量大小为256，权重衰减为1e-4，学习率每10个周期减半，优化器为Adam，使用7层Transformer。模型在配备Intel Core i9 10900K CPU和8张Geforce 3090 GPU的机器上训练。而评估指标包括准确率、召回率、特异性、精确率、F1值和受试者准确率，MCS视为正类，UWS为负类，指标针对MCS计算。根据每个受试者的所有片段预测结果确定其属于MCS或UWS。如果超过50%的片段被预测为MCS（或UWS），则该受试者被预测为MCS（或UWS），所有患者正确预测的比例即为受试者准确率。

***

### 实验结果

#### 与其他方法的性能比较

为了评估本文方法的有效性，本文将其与其他方法（包括传统机器学习方法和深度学习方法）在相同数据集上进行了比较。性能比较结果见表1和图4。本文的DOCTer在区分MCS和UWS方面优于其他方法，准确率为71.51%，召回率为73.15%，F1值为72.69%，受试者准确率为75.63%，且标准差也是DOCTer值最低，表现最稳定。这表明本文采用结合时间/频谱特征、微状态和临床特征这种方式对任务非常有效。

<div align='center'>表1 与其他方法的性能比较</div>
{% asset_img 5.webp %}

{% asset_img 6.webp %}
<div align='center'>图4 不同方法在准确率上的性能比较箱线图</div>

***

#### 不同特征类型的重要性

本实验中研究了不同特征类型对任务的重要性，包括时间/频谱特征、微状态、临床特征及其组合。表2显示了不同特征类型的平均值和标准差，图5则通过箱线图详细展示了结果分布，均表明不同特征类型的组合有助于提高诊断准确性。

<div align='center'>表2 不同特征类型的性能比较</div>
{% asset_img 7.webp %}

{% asset_img 8.webp %}
<div align='center'>图5 不同特征类型在准确率方面的性能比较箱线图</div>

***

#### 不同采集时长和EEG通道数量的研究

对于脑损伤的DOC患者，平衡EEG采集时长是一个重要的考量，过长的数据采集会导致患者身体不适，甚至可能影响大脑恢复，同时EEG通道数量也会影响临床操作的便利性和患者的舒适，故本实验中本文研究了不同EEG采集时长和通道数量对性能的影响。实验结果如图6所示，综合实验效果和设置成本等因素，当EEG采集时长为240秒，且采用32通道是临床上用于识别DOC的最佳EEG采集选择。

{% asset_img 9.webp %}
<div align='center'>图6 EEG采集时长和EEG通道数量的性能比较</div>

***

#### 不同片段长度的研究

本文还研究了在输入不同长度的片段（epoch）时的性能表现，分别将每位受试者的EEG记录划分为不同长度的片段并进行编码，实验结果表明当输入片段长度设置为12秒时，模型性能达到最佳，准确率为75.15%，召回率为79.78%，F1值为77.05%。因此可以得出结论，12秒的片段长度对于本数据集上的任务是一个合适的选择，能够捕捉到足够的脑活动信号。

***

#### 不同脑区的研究

本部分研究了不同脑区和大脑完整性对模型性能的影响，本文将大脑分成四个区域，并对每个区域的性能进行了评估。本文从每个脑区域的电极EEG记录中提取了时间/频谱特征。由于微状态是从全脑的所有电极提取的，而临床特征是基于个体层面的，因此在此分析中未使用微状态和临床特征。图8展示了性能比较结果，当用于诊断任务的脑区域越多，模型性能越高，这说明大脑完整性对评估意识水平非常重要，可能与脑连接性有关。其中，RP区域的性能最低，且从大脑前半球提取的特征更具预测性。

{% asset_img 10.webp %}
<div align='center'>图8 不同脑区域的性能比较</div>

***

### 讨论和结论

将MCS误诊为UWS可能导致不适当的预后和治疗方法，使患者康复更加困难，在临床上，MCS或UWS的诊断基于CRS-R评分，这具有主观性且依赖于医生的经验。在本研究中，本文提出了一个名为DOCTer的框架，通过静息状态EEG记录、微状态和临床特征等的结合，来客观且准确地识别MCS或UWS。为验证框架的性能，本文收集了大规模数据集对其进行评估，表明DOCTer在区分MCS和UWS方面优于大多数现有方法，可在未来成为辅助医生诊断DOC患者的客观工具。但DOCTer本身仍存在一定的局限性：例如跨设备导致的患者类型比例不均衡、微状态和临床特征单独使用时预测能力较一般等，本文将在未来尝试解决这些问题，以进一步提高DOC患者意识水平评估的准确率。

***

### 原文链接

> <https://www.scholat.com/teamwork/showPostMessage.html?id=16217>
