---
title: MoCoè®ºæ–‡é€æ®µç²¾è¯»-Momentum Contrast for Unsupervised Visual Representation Learning
categories:
  - ğŸŒ™è¿›é˜¶å­¦ä¹ 
  - â­è®ºæ–‡å¸¦è¯»
  - ğŸ’«ç²¾è¯»ç»å…¸
abbrlink: da364ed
date: 2021-12-16 00:08:23
tags:
---

### åŸæ–‡

{% pdf ./file/paper/2020-Momentum-Contrast-for-Unsupervised-Visual-Representation-Learning.pdf %}

**MoCo** è®ºæ–‡é“¾æ¥ï¼š<https://arxiv.org/abs/1911.05722>

<!--more-->

<iframe src="//player.bilibili.com/player.html?aid=422340209&bvid=BV1C3411s7t9&cid=461830701&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"> </iframe>

è¿™æ¬¡è®ºæ–‡ç²¾è¯»ææ²åšå£«ç»§ç»­é‚€è¯·äº†äºšé©¬é€Šè®¡ç®—æœºè§†è§‰ä¸“å®¶æœ±æ¯…åšå£«æ¥ç²¾è¯» **Momentum Contrastï¼ˆMoCoï¼‰**ï¼Œå¼ºçƒˆæ¨èå¤§å®¶å»çœ‹æœ¬æ¬¡çš„è®ºæ–‡ç²¾è¯»è§†é¢‘ã€‚æœ±æ¯…åšå£«å’Œä¸Šæ¬¡ä¸€æ ·è®²è§£åœ°éå¸¸è¯¦ç»†ï¼Œå‡ ä¹æ˜¯é€è¯é€å¥åœ°è®²è§£ï¼Œåœ¨è®²è§£æ—¶æŠŠ **MoCo** ç›¸å…³é¢†åŸŸçš„ç ”ç©¶ä¹Ÿéƒ½ä»‹ç»äº†ï¼Œå¬å®Œä¹‹åæ”¶è·æ»¡æ»¡ã€‚

**MoCo** è·å¾—äº† CVPR2020 æœ€ä½³è®ºæ–‡æåï¼Œæ˜¯è§†è§‰é¢†åŸŸä½¿ç”¨**å¯¹æ¯”å­¦ä¹ **çš„ä¸€ä¸ªé‡Œç¨‹ç¢‘å·¥ä½œã€‚**å¯¹æ¯”å­¦ä¹ **ç›®å‰ä¹Ÿæ˜¯æœºå™¨å­¦ä¹ é¢†åŸŸæœ€ç‚™æ‰‹å¯çƒ­ï¼ˆï¼Ÿï¼‰çš„ä¸€ä¸ªç ”ç©¶æ–¹å‘ï¼Œç”±äºå…¶ç®€å•ã€æœ‰ç”¨ã€å¼ºå¤§ï¼Œä»¥ä¸€å·±ä¹‹åŠ›ç›˜æ´»äº†ä»2017å¹´å¼€å§‹å°±å·çš„éå¸¸å‰å®³çš„è®¡ç®—æœºè§†è§‰é¢†åŸŸã€‚**MoCo æ˜¯ä¸€ä¸ªæ— ç›‘ç£è¡¨å¾å­¦ä¹ çš„å·¥ä½œï¼Œå…¶ä¸ä»…åœ¨åˆ†ç±»ä»»åŠ¡ï¼Œåœ¨æ£€æµ‹ã€åˆ†å‰²å’Œäººä½“å…³é”®ç‚¹æ£€æµ‹ä»»åŠ¡ä¸Šéƒ½é€¼è¿‘æˆ–è¶…è¶Šäº†æœ‰ç›‘ç£å­¦ä¹ æ¨¡å‹**ï¼›**MoCo** çš„å‡ºç°è¯æ˜æˆ‘ä»¬å¯èƒ½**å¹¶ä¸éœ€è¦å¤§é‡æ ‡æ³¨å¥½çš„æ•°æ®å»é¢„è®­ç»ƒ**ã€‚ä¸‹å›¾ä¸­ **Yann LeCun** å°†æœºå™¨å­¦ä¹ æ¯”ä½œä¸€å—è›‹ç³•ï¼Œå¼ºåŒ–å­¦ä¹ æ˜¯è›‹ç³•ä¸Šçš„æ¨±æ¡ƒã€æœ‰ç›‘ç£å­¦ä¹ æ˜¯è›‹ç³•ä¸Šçš„å¥¶æ²¹ã€æ— ç›‘ç£å­¦ä¹ æ‰æ˜¯é‚£å—å¤§è›‹ç³•ï¼Œæ‰æ˜¯é—®é¢˜çš„æœ¬è´¨ï¼Œç›®å‰å¾ˆå¤šçš„å¤§æ¨¡å‹éƒ½æ˜¯é€šè¿‡è‡ªç›‘ç£å­¦ä¹ å¾—åˆ°çš„ã€‚

{% asset_img 1.webp %}

***

### å¯¹æ¯”å­¦ä¹ ä»‹ç»

åœ¨å¼€å§‹ç²¾è¯»è®ºæ–‡ä¹‹å‰ï¼Œæœ±æ¯…åšå£«é¦–å…ˆä»‹ç»äº†ä»€ä¹ˆæ˜¯**å¯¹æ¯”å­¦ä¹ **ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæœ‰ä¸‰å¼ å›¾ç‰‡ï¼Œå›¾1ã€2ä¸ºåŒä¸€ä¸ªäººä¸åŒçš„è¡¨æƒ…ï¼Œå›¾3ä¸ºdogï¼Œ**åœ¨è®­ç»ƒæ—¶ä¸ä¼šä¸ºè¿™ä¸‰ç§å›¾ç‰‡å»æ ‡æ³¨**ã€‚å°†ä¸‰ç§å›¾ç‰‡è¾“å…¥åˆ°æ¨¡å‹ä¸­ï¼Œæ¨¡å‹ä¼šå¾—åˆ°ä¸‰å¼ å›¾ç‰‡å„è‡ªç‰¹å¾ã€‚ç”±äºå›¾1ã€2ä¸ºåŒä¸€ä¸ªäººã€å¯¹æ¯”å­¦ä¹ å°±æ˜¯è®©ç‰¹å¾ fâ‚ ã€ fâ‚‚ æ¯”è¾ƒæ¥è¿‘ï¼Œè€Œç‰¹å¾ fâ‚ƒ ä¸å¦å¤–ä¸¤ä¸ªç‰¹å¾åœ¨ç‰¹å¾ç©ºé—´ç›¸è·è¾ƒè¿œï¼Œè¿™å°±æ˜¯å¯¹æ¯”å­¦ä¹ éœ€è¦è¾¾åˆ°çš„ç›®çš„ã€‚

{% asset_img 2.webp %}

è™½ç„¶åœ¨å¯¹æ¯”å­¦ä¹ ä¸­å¹¶ä¸éœ€è¦ä¸ºå›¾ç‰‡è¿›è¡Œæ ‡æ³¨ï¼Œä½†æ˜¯ä»ç„¶éœ€è¦çŸ¥é“å“ªäº›å›¾ç‰‡æ˜¯ç›¸ä¼¼çš„ï¼Œå“ªäº›å›¾ç‰‡æ˜¯ä¸ç›¸ä¼¼çš„ï¼Œåœ¨è®¡ç®—æœºè§†è§‰ä¸­é€šå¸¸ä½¿ç”¨ä»£ç†ä»»åŠ¡æ¥å®Œæˆã€‚ä¸¾ä¸€ä¸ªå…·ä½“çš„ä¾‹å­ instance discriminationï¼Œå‡è®¾æœ‰ n å¼ å›¾ç‰‡ï¼Œé€‰å–ä¸€å¼ å›¾ç‰‡ xáµ¢ï¼Œç»è¿‡è£å‰ªå’Œæ•°æ®å¢å¼ºåå¾—åˆ°ä¸¤å¼ æ–°çš„å›¾ç‰‡ xáµ¢Â¹ å’Œ xáµ¢Â²ï¼Œåˆ™è¿™ä¸¤å¼ å›¾ç‰‡å’ŒåŸæ¥çš„å›¾ç‰‡å°±æ˜¯ç›¸ä¼¼çš„ï¼Œä¹Ÿè¢«ç§°ä¸ºæ­£æ ·æœ¬ï¼Œå…¶ä½™å›¾ç‰‡å³ j â‰  iï¼Œåˆ™ä¸ºè´Ÿæ ·æœ¬ã€‚å¯¹æ¯”å­¦ä¹ çš„çµæ´»ä¹‹å¤„å°±åœ¨äºæ­£è´Ÿæ ·æœ¬çš„åˆ’åˆ†ï¼Œä¾‹å¦‚åŒä¸€å¼ å›¾ç‰‡ä¸åŒè§†è§’å¯çœ‹ä½œä¸ºæ­£æ ·æœ¬ï¼Œè§†é¢‘ä¸­åŒä¸€æ®µè§†é¢‘ä»»æ„ä¸¤å¸§å¯ä»¥çœ‹ä¸ºæ­£æ ·æœ¬ï¼ŒRGBå’Œæ·±åº¦å›¾ä¹Ÿå¯çœ‹ä½œä¸ºæ­£æ ·æœ¬ç­‰ç­‰ã€‚æ­£æ˜¯ç”±äºå…¶çµæ´»æ€§ï¼Œå¯¹æ¯”å­¦ä¹ çš„åº”ç”¨æ‰å¦‚æ­¤ä¹‹å¹¿ã€‚

{% asset_img 3.webp %}

***

### æ ‡é¢˜ã€æ‘˜è¦ã€å¼•è¨€ã€ç»“è®º

å…ˆæ˜¯è®ºæ–‡**æ ‡é¢˜**ï¼Œè®ºæ–‡æ ‡é¢˜çš„æ„æ€æ˜¯ï¼šä½¿ç”¨åŠ¨é‡å¯¹æ¯”å»åšæ— ç›‘ç£è§†è§‰è¡¨å¾å­¦ä¹ ï¼Œ**MoCo** å°±æ¥è‡ªäºè®ºæ–‡å‰ä¸¤ä¸ªå•è¯å‰ä¸¤ä¸ªå­—æ¯ã€‚ç®€å•ä»‹ç»ä»€ä¹ˆæ˜¯**åŠ¨é‡**ï¼Œ**åŠ¨é‡**åœ¨æ•°å­¦ä¸Šå°±æ˜¯åŠ æƒç§»åŠ¨å¹³å‡ã€‚ä¾‹å¦‚ yâ‚œ = m Ã— yâ‚œâ‚‹â‚ + (1 âˆ’ m) Ã— xâ‚œï¼Œyâ‚œâ‚‹â‚ ä¸ºä¸Šä¸€æ—¶åˆ»çš„è¾“å‡ºï¼Œxâ‚œ ä¸ºå½“å‰è¾“å…¥ï¼Œm ä¸ºåŠ¨é‡å‚æ•°ï¼›å½“ m å¾ˆå¤§æ—¶ï¼Œyâ‚œ å°±å–å†³äºä¸Šä¸€æ—¶åˆ»è¾“å‡ºï¼Œå…¶æ›´æ–°å°±å¾ˆç¼“æ…¢ï¼›å½“ m å¾ˆå°æ—¶ï¼Œyâ‚œ å°±å–å†³äºå½“å‰æ—¶åˆ»è¾“å…¥ã€‚

ä½œè€…å›¢é˜Ÿæ¥è‡ªäº**FAIR**ï¼Œå°±ä¸è¿‡å¤šä»‹ç»äº†ï¼Œäº”ä¸ªäººè°·æ­Œå­¦æœ¯å¼•ç”¨æ•°è¾¾åˆ°äº†50ä¸‡+ã€‚

{% asset_img 4.webp %}

***

ä¸‹é¢æ˜¯è®ºæ–‡**æ‘˜è¦**ï¼Œæ‘˜è¦å†™çš„å¾ˆç®€æ´ï¼Œæ€»å…±åªæœ‰7å¥è¯ã€‚

- ç¬¬1å¥è¯ç›´æ¥ä»‹ç»ä¸»é¢˜ï¼Œæˆ‘ä»¬æå‡ºäº† **MoCo** ç”¨äºæ— ç›‘ç£è§†è§‰è¡¨å¾å­¦ä¹ ã€‚ç¬¬2å¥è¯æ„æ€æ˜¯æˆ‘ä»¬æŠŠå¯¹æ¯”å­¦ä¹ çœ‹ä½œæ˜¯**å­—å…¸æŸ¥è¯¢**ï¼Œæˆ‘ä»¬å»ºç«‹äº†ä¸€ä¸ªåŠ¨æ€å­—å…¸ï¼Œä½¿ç”¨åˆ°äº†**é˜Ÿåˆ—**å’Œ**ç§»åŠ¨å¹³å‡ç¼–ç å™¨**ã€‚
- ç¬¬3å¥è¯æ„æ€æ˜¯ä½¿ç”¨é˜Ÿåˆ—å’Œç§»åŠ¨å¹³å‡ç¼–ç å™¨ï¼Œæˆ‘ä»¬å¯ä»¥å»ºç«‹ä¸€ä¸ªå¾ˆå¤§ä¸”ä¸€è‡´çš„å­—å…¸ï¼Œæœ‰åŠ©äºå¯¹æ¯”æ— ç›‘ç£å­¦ä¹ ã€‚
- ç¬¬4-6å¥è¯æ˜¯æ¨¡å‹æ•ˆæœï¼Œ**MoCo** åœ¨ **ImageNet** åˆ†ç±»ä¸Šå–å¾—äº†å¾ˆæœ‰ç«äº‰åŠ›çš„ç»“æœï¼Œå…¶ä¸­ **linear protocol** çš„æ„æ€æ˜¯è¯´å°†ä¸»å¹²ç½‘å†»ç»“ï¼Œåªè®­ç»ƒåˆ†ç±»å¤´ã€‚æ›´é‡è¦çš„ï¼Œå°† MoCo å­¦åˆ°çš„ç‰¹å¾è¿ç§»åˆ°ä¸‹æµä»»åŠ¡æ—¶ï¼Œåœ¨7ä¸ªæ£€æµ‹å’Œåˆ†å‰²ä»»åŠ¡ä¸Šï¼Œ**MoCo** éƒ½è¶…è¿‡å®ƒçš„æœ‰ç›‘ç£é¢„è®­ç»ƒå¯¹æ‰‹ï¼Œ**counterpart** çš„æ„æ€æ˜¯æœ‰ç›‘ç£å’Œæ— ç›‘ç£è®­ç»ƒéƒ½ä½¿ç”¨åŒä¸€ä¸ªç½‘ç»œï¼Œä¾‹å¦‚ResNet-50ã€‚
- æœ€åä¸€å¥è¯çš„æ„æ€æ˜¯ï¼Œåœ¨è®¸å¤šè§†è§‰ä»»åŠ¡ä¸Šï¼Œæ— ç›‘ç£å’Œæœ‰ç›‘ç£ç‰¹å¾å­¦ä¹ ä¹‹é—´çš„é¸¿æ²Ÿè¢«å¤§å¹…åº¦çš„å¡«ä¸Šäº†ã€‚

{% asset_img 5.webp %}

***

ä¸‹é¢æ˜¯è®ºæ–‡**å¼•è¨€**éƒ¨åˆ†ï¼Œæ€»å…±æœ‰6æ®µã€‚

- ç¬¬1æ®µè¯´æ— ç›‘ç£å­¦ä¹ åœ¨è‡ªç„¶è¯­è¨€å¤„ç†ä»»åŠ¡ä¸­å–å¾—äº†å¾ˆå¤§çš„æˆåŠŸï¼Œä½†æ˜¯åœ¨è®¡ç®—æœºè§†è§‰ä¸­ï¼Œä»ç„¶æ˜¯æœ‰ç›‘ç£é¢„è®­ç»ƒå ç»Ÿæ²»å®šä½ã€‚åŸå› å¯èƒ½æ˜¯å„è‡ªä¿¡å·ç©ºé—´çš„ä¸åŒã€‚è¯­è¨€ä»»åŠ¡æœ‰ç€ç¦»æ•£çš„ä¿¡å·ç©ºé—´ï¼ˆå•è¯ã€è¯æ ¹ã€è¯ç¼€ç­‰ï¼‰ï¼›ä½†æ˜¯è®¡ç®—æœºè§†è§‰ï¼ŒåŸå§‹ä¿¡å·å¾€å¾€æ˜¯è¿ç»­ã€é«˜ç»´çš„ï¼Œåœ¨æ„å»ºå­—å…¸æ—¶ä¼šæœ‰å¾ˆå¤šé—®é¢˜ã€‚
- ç¬¬2æ®µè¯´æœ€è¿‘çš„æ— ç›‘ç£å­¦ä¹ ç ”ç©¶éƒ½ä½¿ç”¨äº†**å¯¹æ¯”å­¦ä¹ **ã€‚è¿™äº›æ–¹æ³•å¯ä»¥çœ‹ä½œæ˜¯**æ„å»ºåŠ¨æ€å­—å…¸**ã€‚ä½¿ç”¨ç¼–ç å™¨ç½‘ç»œå°†å›¾åƒæˆ–å›¾åƒå—è¡¨ç¤ºæˆ **key**ã€‚æ— ç›‘ç£å­¦ä¹ è®­ç»ƒç¼–ç å™¨æ—¶æ˜¯è¿™æ ·è¿›è¡Œå­—å…¸æŸ¥è¯¢ï¼š**ä¸€ä¸ªç¼–ç åçš„ query åº”è¯¥å’Œå®ƒåŒ¹é…çš„ key ç›¸ä¼¼ï¼Œè€Œå’Œå…¶å®ƒ key ä¸ç›¸ä¼¼**ã€‚è¿™æ ·ä¸€ä¸ªå­¦ä¹ å°±å˜æˆäº†æœ€å°åŒ–å¯¹æ¯”æŸå¤±çš„é—®é¢˜ã€‚
- ç¬¬3æ®µè¯´æˆ‘ä»¬æƒ³æ„å»ºè¿™æ ·çš„ä¸€ä¸ªå­—å…¸ï¼š**ï¼ˆ1ï¼‰å¤§ï¼ˆ2ï¼‰åœ¨è®­ç»ƒæ—¶ä¿æŒä¸€è‡´**ã€‚å¤§çš„å­—å…¸å¯ä»¥è®©æˆ‘ä»¬é‡‡æ ·åˆ°æƒ³è¦çš„è¿ç»­ã€é«˜ç»´è§†è§‰ç©ºé—´ï¼›å­—å…¸ä¸­çš„ key åº”è¯¥å°½å¯èƒ½ä½¿ç”¨ç›¸åŒæˆ–ç›¸ä¼¼çš„ç¼–ç å™¨æ¥è¡¨ç¤ºï¼Œè¿™æ ·å®ƒä»¬å’Œ **quary** çš„æ¯”è¾ƒæ‰èƒ½ä¸€è‡´ã€‚å¦‚ä½•è®©å­—å…¸åˆå¤§åˆä¸€è‡´ï¼Œä½œè€…åœ¨åé¢ä¼šè¯¦ç»†ä»‹ç»ã€‚

{% asset_img 6.webp %}

ç¬¬4æ®µè¯´æˆ‘ä»¬æå‡ºäº† **MoCo** æ¨¡å‹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œé€šè¿‡æ¯”è¾ƒ **query** å’Œ **key** åœ°ç›¸ä¼¼æ€§æ¥è®­ç»ƒç¼–ç å™¨ã€‚æˆ‘ä»¬ç”¨**é˜Ÿåˆ—**æ¥å­˜å‚¨å­—å…¸æ•°æ®ï¼Œå½“å‰æ—¶åˆ»æ•°æ®ç¼–ç åæ–°çš„ç‰¹å¾å…¥é˜Ÿï¼Œæœ€è€çš„æ•°æ®ç‰¹å¾å‡ºé˜Ÿï¼Œè¿™æ ·å­—å…¸å¤§å°å’Œmini-batchå¤§å°å°±è§£è€¦äº†ï¼Œå°±èƒ½ä¿è¯æ„å»ºä¸€ä¸ªå¤§çš„å­—å…¸ï¼›åŒæ—¶ä½¿ç”¨åŠ¨é‡å»æ›´æ–°ç¼–ç å™¨å‚æ•°ï¼Œèƒ½ä¿è¯å­—å…¸ä¸­çš„ç‰¹å¾å°½å¯èƒ½åœ°ä¸€è‡´ã€‚ä½¿ç”¨æ•°å­¦å…¬å¼è¡¨è¾¾çš„è¯å°±æ˜¯ï¼šÎ¸â‚– = mÎ¸â‚–â‚‹â‚ + (1 âˆ’ m)Î¸qã€‚

{% asset_img 7.webp %}

ç¬¬5æ®µä»‹ç»äº†**ä»£ç†ä»»åŠ¡**ï¼Œä½œè€…ä½¿ç”¨ä¸ªä½“åˆ¤åˆ«ä½œä¸ºä»£ç†ä»»åŠ¡ï¼Œå³åŒä¸€å¼ å›¾ç‰‡ä¸åŒè§†è§’çš„ **query** å’Œ **key** çœ‹ä½œæ˜¯ç›¸ä¼¼çš„ã€‚åœ¨ **ImageNet** æ•°æ®çº¿æ€§åˆ†ç±»é—®é¢˜ä¸Š **MoCo** æ˜¾ç¤ºå‡ºäº†å¾ˆæœ‰ç«äº‰åŠ›çš„ç»“æœã€‚ç¬¬6æ®µä½œè€…è¯´æ— ç›‘ç£å­¦ä¹ æœ€ä¸»è¦çš„ç›®çš„æ˜¯å°†é¢„è®­ç»ƒå¥½çš„ç‰¹å¾è¿ç§»åˆ°ä¸‹æ¸¸ä»»åŠ¡ä¸­ã€‚åœ¨7ä¸ªæ£€æµ‹å’Œåˆ†å‰²ä»»åŠ¡ä¸Šï¼Œ**MoCo** éƒ½æœ‰ç€å¾ˆå¥½çš„æ•ˆæœã€‚æ— è®ºæ˜¯ç™¾ä¸‡å¼ å›¾ç‰‡è¿˜æ˜¯10äº¿å¼ å›¾ç‰‡ï¼Œ**MoCo** éƒ½å·¥ä½œåœ°å¾ˆå¥½ã€‚æ„å‘³ç€æ— ç›‘ç£å­¦ä¹ å’Œæœ‰ç›‘ç£å­¦ä¹ ä¹‹é—´çš„å·®è·è¶Šæ¥è¶Šå°äº†ï¼Œåœ¨è®¸å¤šåº”ç”¨ä¸­é€æ¸å¯ä»¥æ›¿ä»£æœ‰ç›‘ç£é¢„è®­ç»ƒæ¨¡å‹ã€‚

{% asset_img 8.webp %}

***

ä¸‹é¢æ˜¯**ç»“è®ºå’Œè®¨è®º**éƒ¨åˆ†ï¼Œç»“è®ºå°±1å¥è¯ï¼Œæˆ‘ä»¬çš„æ— ç›‘ç£å­¦ä¹ æ–¹æ³•åœ¨è®¸å¤šè®¡ç®—æœºè§†è§‰æ•°æ®å’Œä»»åŠ¡ä¸Šéƒ½æœ‰ç€å¾ˆå¥½çš„ç»“æœã€‚**MoCo** ä»ç™¾ä¸‡æ•°æ®åˆ°åäº¿æ•°æ®æ€§èƒ½æå‡æ˜¯æœ‰çš„ï¼Œä½†æ˜¯å¾ˆå°ï¼Œå¯èƒ½æ˜¯è¿™äº›å¤§è§„æ¨¡æ•°æ®æœªå……åˆ†åˆ©ç”¨ï¼Œå¸Œæœ›æœ‰æ›´é«˜çº§çš„ä»£ç†ä»»åŠ¡æ¥æé«˜æ¨¡å‹æ€§èƒ½ï¼›æœ‰å¯èƒ½å°† **MoCo** è°ƒæ•´åˆ°åƒ **masked auto-encoding** è¿™æ ·çš„ä»£ç†ä»»åŠ¡ä¸Šï¼ˆæœ€è¿‘ä½œè€…å°±æå‡ºäº†å¤§ç«çš„ **MAE**ï¼‰ã€‚æœ€åä½œè€…å¸Œæœ› **MoCo** èƒ½åœ¨å…¶å®ƒå¯¹æ¯”å­¦ä¹ ç ”ç©¶ä¸­æœ‰å¸®åŠ©ã€‚

{% asset_img 9.webp %}

***

### ç›¸å…³å·¥ä½œ

ä¸‹é¢æ˜¯è®ºæ–‡**ç›¸å…³å·¥ä½œ**éƒ¨åˆ†ï¼Œæ— ç›‘ç£å­¦ä¹ é€šå¸¸åŒ…å«ä¸¤æ–¹é¢ï¼š**ä»£ç†ä»»åŠ¡**å’Œ**æŸå¤±å‡½æ•°**ã€‚ä»£ç†ä»»åŠ¡é€šå¸¸ä¸æ˜¯å¤§å®¶å®é™…æ„Ÿå…´è¶£çš„ä»»åŠ¡ (å¦‚æ£€æµ‹ã€åˆ†ç±»ã€åˆ†å‰²)ï¼Œè€Œæ˜¯ä¸ºäº†å­¦ä¹ ä¸€ä¸ªå¥½çš„æ•°æ®ç‰¹å¾è¡¨ç¤ºï¼›æŸå¤±å‡½æ•°å¯ä»¥å’Œä»£ç†ä»»åŠ¡åˆ†å¼€ç ”ç©¶ï¼Œ**MoCo** å…³æ³¨çš„å°±æ˜¯æŸå¤±å‡½æ•°ç ”ç©¶ã€‚

æŸå¤±å‡½æ•°æ˜¯ä¸ºäº†è¡¡é‡æ¨¡å‹çš„é¢„æµ‹è¾“å‡ºå’Œå›ºå®šç›®æ ‡ä¹‹é—´çš„å·®å¼‚ï¼Œå¦‚é€šè¿‡ **L1ã€L2** æŸå¤±é‡æ„åƒç´ æˆ–é€šè¿‡äº¤å‰ç†µå¯¹è¾“å…¥è¿›è¡Œåˆ†ç±»ã€‚å¯¹æ¯”å­¦ä¹ çš„æŸå¤±æµ‹é‡çš„æ˜¯æ ·æœ¬å¯¹åœ¨ç‰¹å¾ç©ºé—´çš„ç›¸ä¼¼æ€§ï¼Œåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œç›®æ ‡é€šå¸¸æ˜¯ä¸å›ºå®šçš„ã€‚å¯¹æŠ—å­¦ä¹ çš„æŸå¤±è¡¡é‡çš„æ˜¯æ¦‚ç‡åˆ†å¸ƒçš„å·®å¼‚ï¼Œç»å¸¸ç”¨åœ¨æ— ç›‘ç£æ•°æ®ç”Ÿæˆã€‚

å„ç§å„æ ·çš„ä»£ç†ä»»åŠ¡è¢«æå‡ºæ¥ï¼Œå¦‚é‡æ„æ•´å¼ å›¾ã€é‡æ„æŸä¸ª **patch**ã€ç»™å›¾ç‰‡ç»˜ä¸Šé¢œè‰²ã€‚ä¸åŒçš„ä»£ç†ä»»åŠ¡å¯ä»¥å’Œå¯¹æ¯”å­¦ä¹ æŸå¤±å‡½æ•°ç»“åˆä½¿ç”¨ï¼Œå¦‚ **CPCã€CMC**ã€‚

{% asset_img 10.webp %}

***

### MoCoæ–¹æ³•ã€å®éªŒ

ä¸‹é¢æ˜¯è®ºæ–‡**æ–¹æ³•**éƒ¨åˆ†ï¼Œå¯¹æ¯”å­¦ä¹ ä»¥åŠæœ€æ–°å®ƒçš„ä¸€äº›æœ€æ–°è¿›å±•ï¼Œéƒ½å¯ä»¥çœ‹ä½œæˆæ˜¯è®­ç»ƒä¸€ä¸ªç¼–ç å™¨ï¼Œä»è€Œå»åšä¸€ä¸ª**å­—å…¸æŸ¥è¯¢**çš„ä»»åŠ¡ã€‚å‡è®¾æœ‰ä¸€ä¸ªç¼–ç å¥½çš„æŸ¥è¯¢ **q**ï¼Œä»¥åŠä¸€ç³»åˆ—å·²ç»ç¼–ç å¥½çš„æ ·æœ¬ï¼Œä¹Ÿå°±æ˜¯ {undefined kâ‚€ã€kâ‚ã€kâ‚‚}ç­‰ï¼Œè¿™äº›å¯ä»¥çœ‹ä½œæ˜¯å­—å…¸ä¸­çš„ **key**ã€‚

è¿™é‡Œå­˜åœ¨ä¸€ä¸ªå‡è®¾ï¼šåœ¨å­—å…¸ä¸­åªæœ‰ä¸€ä¸ª **key** æ˜¯è·Ÿ **query** åŒ¹é…çš„ï¼Œä¸¤ä¸ªäº’ä¸ºæ­£æ ·æœ¬å¯¹ï¼Œè¿™ä¸ª **key** å«åš **key positive**ï¼ˆkâ‚Šï¼‰ã€‚å®šä¹‰å¥½äº†æ­£æ ·æœ¬å’Œè´Ÿæ ·æœ¬ï¼Œæ¥ä¸‹æ¥å°±éœ€è¦ä¸€ä¸ªå¯¹æ¯”å­¦ä¹ çš„ç›®æ ‡å‡½æ•°ï¼Œè¿™ä¸ªå¯¹æ¯”å­¦ä¹ çš„ç›®æ ‡å‡½æ•°æœ€å¥½èƒ½æ»¡è¶³ä»¥ä¸‹è¦æ±‚ï¼šï¼ˆ1ï¼‰å½“ **q** å’Œå”¯ä¸€çš„æ­£æ ·æœ¬ kâ‚Š ç›¸ä¼¼çš„æ—¶å€™ï¼Œå®ƒçš„losså€¼åº”è¯¥æ¯”è¾ƒä½ï¼›ï¼ˆ2ï¼‰å½“ **q** å’Œå…¶ä»–æ‰€æœ‰çš„ **key** éƒ½ä¸ç›¸ä¼¼çš„æ—¶å€™ï¼Œè¿™ä¸ªlossçš„å€¼ä¹Ÿåº”è¯¥æ¯”è¾ƒä½ã€‚é€šè¿‡ç‚¹ç§¯è®¡ç®—ç›¸ä¼¼æ€§ï¼Œæˆ‘ä»¬ä½¿ç”¨ **InfoNCE** å½“ä½œå¯¹æ¯”å­¦ä¹ æŸå¤±å‡½æ•°ï¼Œå½¢å¼ä¸ºï¼š

{% asset_img 11.webp %}

å…¬å¼ä¸­çš„ Ï„ æ˜¯ä¸€ä¸ªæ¸©åº¦è¶…å‚æ•°ï¼Œæ˜¯ä¸€ä¸ªæ ‡é‡ï¼Œå¦‚æœå¿½ç•¥æ‰å®ƒï¼Œå°±ä¼šå‘ç°ï¼Œå…¶å®è¿™ä¸ª **InfoNCE** æŸå¤±å°±æ˜¯äº¤å‰ç†µæŸå¤±ï¼Œå”¯ä¸€çš„åŒºåˆ«å°±åœ¨äºåœ¨**äº¤å‰ç†µæŸå¤±ä¸­kæŒ‡ä»£çš„æ˜¯æ•°æ®é›†é‡Œç±»åˆ«çš„å¤šå°‘**ï¼Œä½†æ˜¯åœ¨å¯¹æ¯”å­¦ä¹ çš„ **InfoNCE** æŸå¤±ä¸­ï¼Œk æŒ‡çš„æ˜¯**è´Ÿæ ·æœ¬çš„æ•°é‡**ã€‚

é€šå¸¸æ¥è¯´ï¼ŒæŸ¥è¯¢ **q** æ˜¯ä¸€ä¸ªè¾“å…¥ x_q é€šè¿‡ä¸€ä¸ªç¼–ç å™¨ f_q å¾—åˆ°çš„ï¼ŒåŒç†æ‰€æœ‰çš„ **k** çš„è¡¨ç¤ºä¹Ÿéƒ½æ˜¯è¾“å…¥ xáµ é€šè¿‡ä¸€ä¸ªç¼–ç å™¨ fâ‚– å¾—åˆ°ï¼Œè¾“å…¥å’Œæ¨¡å‹å…·ä½“çš„å®ç°æ˜¯ç”±å…·ä½“çš„ä»£ç†ä»»åŠ¡å†³å®šã€‚æ—¢å¯ä»¥æ˜¯å›¾ç‰‡ï¼Œä¹Ÿå¯ä»¥æ˜¯å›¾ç‰‡å—ï¼Œæˆ–è€…æ˜¯å«æœ‰ä¸Šä¸‹æ–‡çš„ä¸€ç³»åˆ—çš„å›¾ç‰‡å—ï¼›å¯¹äºæ¨¡å‹ï¼Œ**q** çš„ç¼–ç å™¨å’Œ **key** çš„ç¼–ç å™¨æ—¢å¯ä»¥æ˜¯ä¸€æ ·çš„ã€ä¹Ÿå¯ä»¥æ˜¯éƒ¨åˆ†å…±äº«çš„ï¼Œè¿˜å¯ä»¥æ˜¯ä¸ä¸€æ ·çš„ã€‚

{% asset_img 12.webp %}

***

ä¸‹é¢ä»‹ç»**åŠ¨é‡å¯¹æ¯”å­¦ä¹ **ï¼Œå¯¹æ¯”å­¦ä¹ æ˜¯ä¸€ç§åœ¨é«˜ç»´çš„è¿ç»­çš„è¾“å…¥ä¿¡å·ä¸Šå»æ„å»ºå­—å…¸çš„ä¸€ç§æ–¹å¼ã€‚é«˜ç»´å’Œè¿ç»­æŒ‡çš„æ˜¯å›¾ç‰‡ï¼Œå­—å…¸æ˜¯åŠ¨æ€çš„ï¼Œä¹‹æ‰€ä»¥æ˜¯åŠ¨æ€çš„æ˜¯å› ä¸ºè¿™ä¸ªå­—å…¸ä¸­çš„ **key** éƒ½æ˜¯éšæœºé€‰å–çš„ï¼Œè€Œä¸” **key** çš„ç¼–ç å™¨åœ¨è®­ç»ƒçš„è¿‡ç¨‹ä¸­ä¹Ÿæ˜¯åœ¨ä¸åœçš„å˜åŒ–ã€‚å¦‚æœæƒ³å­¦ä¸€ä¸ªå¥½çš„ç‰¹å¾ï¼Œè¿™ä¸ªå­—å…¸å°±å¿…é¡»æ‹¥æœ‰ä¸¤ä¸ªç‰¹æ€§ï¼ˆ**å¤§**ï¼Œå¤§çš„å­—å…¸èƒ½å¤ŸåŒ…å«å¾ˆå¤šè¯­ä¹‰ä¸°å¯Œçš„è´Ÿæ ·æœ¬ï¼Œä»è€Œæœ‰åŠ©äºå­¦åˆ°æ›´æœ‰åˆ¤åˆ«æ€§çš„ç‰¹å¾ï¼›**ä¸€è‡´æ€§**ä¸»è¦æ˜¯ä¸ºäº†æ¨¡å‹çš„è®­ç»ƒæ–¹ä¾¿ï¼‰åŸºäºä»¥ä¸ŠåŠ¨æœºï¼Œä½œè€…å°±æå‡ºäº†åŠ¨é‡å¯¹æ¯”å­¦ä¹ ã€‚

- é¦–å…ˆå°±æ˜¯**æŠŠä¸€ä¸ªå­—å…¸ç”¨é˜Ÿåˆ—çš„å½¢å¼è¡¨ç°å‡ºæ¥**ã€‚é˜Ÿåˆ—å…¶å®å°±æ˜¯ä¸€ç§æ•°æ®ç»“æ„ï¼Œä¸€èˆ¬è¢«ç§°ä½œæ˜¯ä¸€ä¸ª**fifo**ï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰çš„æ•°æ®ç»“æ„ã€‚ä½œè€…åœ¨è¿™é‡Œæ˜¯ç”¨ä¸€ä¸ªé˜Ÿåˆ—å»ä»£è¡¨ä¸€ä¸ªå­—å…¸ï¼Œä¹Ÿå°±æ˜¯è¯´æ•´ä¸ªé˜Ÿåˆ—å°±æ˜¯ä¸€ä¸ªå­—å…¸ï¼Œé‡Œé¢çš„å…ƒç´ å°±æ˜¯æ”¾è¿›å»çš„ **key**ã€‚åœ¨æ¨¡å‹è®­ç»ƒçš„è¿‡ç¨‹ä¸­ï¼Œæ¯ä¸€ä¸ª **mini-batch** å°±ä¼šæœ‰æ–°çš„ä¸€æ‰¹ **key** è¢«é€è¿›æ¥ï¼ŒåŒæ—¶ä¹Ÿä¼šæœ‰ä¸€æ‰¹è€çš„ **key** ç§»å‡ºå»ï¼Œæ‰€ä»¥ç”¨é˜Ÿåˆ—çš„å¥½å¤„æ˜¯å¯ä»¥é‡å¤ä½¿ç”¨é‚£äº›å·²ç»ç¼–ç å¥½çš„ **key**ï¼Œè€Œè¿™äº› **key** æ˜¯ä»ä¹‹å‰çš„é‚£äº› **mini-batch** ä¸­å¾—åˆ°çš„ã€‚è¿™æ ·ä½¿ç”¨äº†é˜Ÿåˆ—ä¹‹åï¼Œ**å°±å¯ä»¥æŠŠå­—å…¸çš„å¤§å°å’Œmini-batchçš„å¤§å°å½»åº•å‰¥ç¦»å¼€äº†**ï¼Œå°±å¯ä»¥åœ¨æ¨¡å‹çš„è®­ç»ƒè¿‡ç¨‹ä¸­ä½¿ç”¨ä¸€ä¸ªæ¯”è¾ƒæ ‡å‡†çš„mini-batch sizeï¼Œä¸€èˆ¬æ˜¯128æˆ–è€…æ˜¯256ï¼Œä½†æ˜¯å­—å…¸çš„å¤§å°å¯ä»¥å˜å¾—éå¸¸å¤§ï¼Œå®ƒçš„å¤§å°éå¸¸çµæ´»ï¼Œè€Œä¸”å¯ä»¥å½“ä½œä¸€ä¸ªè¶…å‚æ•°ä¸€æ ·å•ç‹¬è®¾ç½®ã€‚åŒæ—¶åœ¨ç®—å¯¹æ¯”å­¦ä¹ ç›®æ ‡å‡½æ•°çš„æ—¶å€™åªæ˜¯å–ä¸€ä¸ªè¿‘ä¼¼ï¼Œè€Œä¸æ˜¯åœ¨æ•´ä¸ªæ•°æ®é›†ä¸Šç®—lossï¼Œä½¿ç”¨é˜Ÿåˆ—çš„æ•°æ®ç»“æ„ï¼Œå¯ä»¥è®©ç»´æŠ¤è¿™ä¸ªå­—å…¸çš„è®¡ç®—å¼€é”€éå¸¸å°ã€‚

- ç”¨é˜Ÿåˆ—çš„å½¢å¼å¯ä»¥ä½¿è¿™ä¸ªå­—å…¸å˜å¾—å¾ˆå¤§ï¼Œä½†æ˜¯ä¹Ÿå› ä¸ºä½¿ç”¨äº†éå¸¸å¤§çš„å­—å…¸ï¼Œä¹Ÿå°±æ˜¯éå¸¸é•¿çš„é˜Ÿåˆ—ï¼Œå¯¼è‡´æ²¡åŠæ³•ç»™é˜Ÿåˆ—ä¸­æ‰€æœ‰çš„å…ƒç´ è¿›è¡Œæ¢¯åº¦å›ä¼ ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œ**key** çš„ç¼–ç å™¨æ— æ³•é€šè¿‡åå‘ä¼ æ’­çš„æ–¹å¼å»æ›´æ–°å®ƒçš„å‚æ•°ã€‚å¦‚æœæƒ³æ›´æ–°è¿™ä¸ª **key** çš„ç¼–ç å™¨ï¼Œå…¶å®æœ‰ä¸€ä¸ªéå¸¸ç®€å•çš„æ–¹æ³•ï¼šå°±æ˜¯æ¯ä¸ªè®­ç»ƒè¿­ä»£ç»“æŸåï¼Œå°†æ›´æ–°å¥½çš„ f_q ç¼–ç å™¨å‚æ•°ç›´æ¥å¤åˆ¶è¿‡æ¥ç»™ fâ‚– ç¼–ç å™¨å°±å¯ä»¥äº†ã€‚è¿™ä¸ªæƒ³æ³•ç®€å•ç¡®å®æ˜¯ç®€å•ï¼Œä½†æ˜¯ä½œè€…ç´§æ¥ç€è¯´è¿™ç§æ–¹å¼çš„ç»“æœå¹¶ä¸å¥½ï¼ŒåŸå› æ˜¯ä¸€ä¸ªå¿«é€Ÿæ”¹å˜çš„ç¼–ç å™¨é™ä½äº†è¿™ä¸ªé˜Ÿåˆ—ä¸­æ‰€æœ‰ **key** çš„ç‰¹å¾çš„ä¸€è‡´æ€§ã€‚å› æ­¤ä½œè€…æå‡ºäº†**åŠ¨é‡æ›´æ–°**çš„æ–¹æ³•ï¼Œå¦‚æœå°† **key** ç¼–ç å™¨å‚æ•°è®¾ä¸º Î¸â‚–ï¼Œ**q** ç¼–ç å™¨çš„å‚æ•°è®¾ä¸º Î¸_qï¼Œé‚£ Î¸â‚– å°±æ˜¯ä»¥ä¸‹é¢å…¬å¼è¿›è¡Œæ›´æ–°ï¼š

{% asset_img 13.webp %}

- ä¸Šå¼ä¸­ m æ˜¯åŠ¨é‡å‚æ•°ï¼Œå®ƒæ˜¯ä¸€ä¸ª0åˆ°1ä¹‹é—´çš„æ•°ã€‚**q** çš„ç¼–ç å™¨ ï¼Œæ˜¯é€šè¿‡æ¢¯åº¦åå‘å›ä¼ æ¥æ›´æ–°æ¨¡å‹å‚æ•°ï¼ŒÎ¸â‚– é™¤äº†åˆšå¼€å§‹æ˜¯ç”¨ Î¸_q åˆå§‹åŒ–ä»¥å¤–ï¼Œåé¢çš„æ›´æ–°å¤§éƒ¨åˆ†ä¸»è¦æ˜¯é è‡ªå·±ã€‚å¦‚æœåŠ¨é‡å‚æ•° m è®¾çš„å¾ˆå¤§ï¼Œé‚£ä¹ˆ Î¸â‚– æ›´æ–°å°±éå¸¸ç¼“æ…¢ï¼Œæ‰€ä»¥ä½œè€…æ¥ä¸‹æ¥è¯´ï¼Œå› ä¸ºä½¿ç”¨äº†è¿™ç§åŠ¨é‡æ›´æ–°çš„æ–¹å¼ï¼Œè™½ç„¶åœ¨é˜Ÿåˆ—é‡Œçš„ **key** éƒ½æ˜¯ç”±ä¸åŒçš„ç¼–ç å™¨äº§ç”Ÿå¾—åˆ°çš„ï¼Œä½†æ˜¯å› ä¸ºè¿™äº›ç¼–ç å™¨ä¹‹é—´çš„åŒºåˆ«æå°ï¼Œæ‰€ä»¥äº§ç”Ÿçš„ **key** çš„ä¸€è‡´æ€§éƒ½å¾ˆå¼ºã€‚

{% asset_img 14.webp %}

- ä¸‹é¢ä½œè€…è¿˜ä»‹ç»äº† **MoCo** å’Œä¹‹å‰ç ”ç©¶çš„å¯¹æ¯”ã€‚ä¹‹å‰çš„å¯¹æ¯”å­¦ä¹ ç ”ç©¶éƒ½å¯ä»¥çœ‹ä½œæ˜¯**å­—å…¸æŸ¥æ‰¾**ï¼Œä½†æ˜¯å®ƒä»¬éƒ½æˆ–å¤šæˆ–å°‘å—é™äº**å­—å…¸çš„å¤§å°**å’Œ**å­—å…¸çš„ä¸€è‡´æ€§**é—®é¢˜ï¼Œè¿™é‡Œä½œè€…å°†ä¹‹å‰çš„æ–¹æ³•æ€»ç»“äº†ä¸€ä¸‹ï¼Œå½’çº³æˆäº†ä¸¤ç§ç»“æ„ã€‚ç¬¬ä¸€ç§å°±æ˜¯æ¯”è¾ƒç›´æ¥çš„**ç«¯åˆ°ç«¯å­¦ä¹ **ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºç¼–ç å™¨å¯ä»¥é€šè¿‡æ¢¯åº¦å›ä¼ æ¥æ›´æ–°æ¨¡å‹å‚æ•°ã€‚ç”±äºæ¨¡å‹çš„æ­£è´Ÿæ ·æœ¬éƒ½æ˜¯ä»åŒä¸€ä¸ª **mini-batch** é‡Œæ¥çš„ï¼Œä¹Ÿå°±æ˜¯ x_q å’Œ xâ‚– éƒ½æ˜¯ä»åŒä¸€ä¸ª **batch** ä¸­æ¥çš„ï¼Œå®ƒåšä¸€æ¬¡å‰å‘ä¼ æ’­å°±èƒ½å¾—åˆ°æ‰€æœ‰æ ·æœ¬çš„ç‰¹å¾ï¼Œè€Œä¸”è¿™äº›æ ·æœ¬æ˜¯é«˜åº¦ä¸€è‡´çš„ï¼Œå› ä¸ºéƒ½æ˜¯æ¥è‡ªä¸€ä¸ªç¼–ç å™¨ã€‚å¬èµ·æ¥ç¡®å®å¾ˆç¾å¥½ï¼Œç¼–ç å™¨èƒ½ç”¨åå‘å›ä¼ å­¦ä¹ ï¼Œç‰¹å¾ä¹Ÿé«˜åº¦ä¸€è‡´äº†ï¼Œä½†æ˜¯å®ƒçš„**å±€é™æ€§å°±åœ¨äºå­—å…¸çš„å¤§å°**ï¼Œå› ä¸ºåœ¨ç«¯åˆ°ç«¯çš„å­¦ä¹ æ¡†æ¶ä¸­ï¼Œ**å­—å…¸çš„å¤§å°å’Œ mini-batch size çš„å¤§å°æ˜¯ç­‰ä»·çš„**ï¼Œå¦‚æœæƒ³è¦ä¸€ä¸ªå¾ˆå¤§çš„å­—å…¸ï¼Œé‡Œé¢æœ‰æˆåƒä¸Šä¸‡ä¸ª **key** çš„è¯ï¼Œä¹Ÿå°±æ„å‘³ç€ **mini-batch size** çš„å¤§å°å¿…é¡»ä¹Ÿæ˜¯æˆåƒä¸Šä¸‡çš„ï¼Œè¿™ä¸ªéš¾åº¦å°±æ¯”è¾ƒé«˜äº†ã€‚ç«¯åˆ°ç«¯å­¦ä¹ çš„ä¼˜ç‚¹åœ¨äºç¼–ç å™¨æ˜¯å¯ä»¥å®æ—¶æ›´æ–°çš„ï¼Œæ‰€ä»¥å¯¼è‡´å®ƒå­—å…¸é‡Œçš„é‚£äº› key çš„ä¸€è‡´æ€§æ˜¯éå¸¸é«˜çš„ï¼Œä½†æ˜¯å®ƒçš„ç¼ºç‚¹åœ¨äºå› ä¸ºå®ƒçš„å­—å…¸å¤§å°ï¼ˆå°±æ˜¯batch-sizeçš„å¤§å°ï¼‰ï¼Œå¯¼è‡´è¿™ä¸ªå­—å…¸ä¸èƒ½è®¾ç½®çš„è¿‡å¤§ï¼Œå¦åˆ™ç¡¬ä»¶å†…å­˜åƒä¸æ¶ˆã€‚

- åœ¨ **memory bank** ä¸­å…¶å®å°±åªæœ‰ä¸€ä¸ªç¼–ç å™¨ï¼Œ**query** çš„ç¼–ç å™¨æ˜¯å¯ä»¥é€šè¿‡æ¢¯åº¦å›ä¼ æ¥è¿›è¡Œæ›´æ–°å­¦ä¹ ã€‚ä½†æ˜¯å¯¹äºå­—å…¸ä¸­çš„ **key** æ˜¯æ²¡æœ‰ä¸€ä¸ªå•ç‹¬çš„ç¼–ç å™¨ï¼Œ**memory bank** æŠŠæ•´ä¸ªæ•°æ®é›†çš„ç‰¹å¾éƒ½å­˜åˆ°äº†ä¸€èµ·ï¼Œå¯¹äº **ImageNet** æ¥è¯´ï¼Œ**memory bank** ä¸­å°±æœ‰128ä¸‡ä¸ªç‰¹å¾ï¼ˆçœ‹ä¸Šå»å¥½åƒå¾ˆå¤§ï¼Œä½†æ˜¯æ¯ä¸€ä¸ªç‰¹å¾åªæœ‰128ç»´ï¼Œæ‰€ä»¥å³ä½¿æ•´ä¸ª **memory bank** ä¸­æœ‰128ä¸‡ä¸ª **key** ï¼Œæœ€åä¹Ÿåªéœ€è¦600Mçš„ç©ºé—´å°±èƒ½æŠŠæ‰€æœ‰çš„è¿™äº›keyå­˜ä¸‹æ¥äº†ï¼‰ã€‚ä¸€æ—¦æœ‰äº†è¿™ä¸ª **memory bank**ï¼Œåœ¨æ¯æ¬¡æ¨¡å‹åšè®­ç»ƒçš„æ—¶å€™ï¼Œåªéœ€è¦ä» **memory bank** ä¸­éšæœºæŠ½æ ·å¾ˆå¤šçš„ **key** å‡ºæ¥å½“ä½œå­—å…¸å°±å¯ä»¥äº†ã€‚è¿™é‡Œä¹Ÿæœ‰ä¸€ä¸ªé—®é¢˜ï¼šå› ä¸ºè¿™é‡Œçš„ç‰¹å¾éƒ½æ˜¯åœ¨ä¸åŒæ—¶åˆ»çš„ç¼–ç å™¨å¾—åˆ°çš„ï¼Œè€Œä¸”è¿™äº›ç¼–ç å™¨éƒ½æ˜¯é€šè¿‡æ¢¯åº¦å›ä¼ æ¥è¿›è¡Œå¿«é€Ÿæ›´æ–°çš„ï¼Œè¿™ä¹Ÿå°±æ„å‘³ç€è¿™é‡Œå¾—åˆ°çš„**ç‰¹å¾éƒ½ç¼ºä¹ä¸€è‡´æ€§**ã€‚

- æ˜¾ç„¶ï¼Œæ— è®ºæ˜¯**ç«¯åˆ°ç«¯çš„å­¦ä¹ **è¿˜æ˜¯ **memory bank** çš„æ–¹æ³•ï¼Œéƒ½å’Œä½œè€…è¯´çš„ä¸€æ ·ï¼Œ**å—é™äºå­—å…¸å¤§å°**å’Œ**ç‰¹å¾ä¸€è‡´æ€§**è¿™ä¸¤æ–¹é¢ä¸­çš„è‡³å°‘ä¸€ä¸ªï¼Œæ‰€ä»¥ä¸ºäº†è§£å†³ä¹‹å‰è¿™ä¸¤ç§åšæ³•çš„å±€é™æ€§ï¼Œä½œè€…å°±æå‡ºäº† **MoCo**ã€‚**MoCo** é‡‡ç”¨é˜Ÿåˆ—çš„å½¢å¼å»å®ç°å­—å…¸ï¼Œä»è€Œä½¿å¾—å®ƒä¸åƒç«¯åˆ°ç«¯çš„å­¦ä¹ ä¸€æ ·å—é™äº **batch-size** çš„å¤§å°ï¼ŒåŒæ—¶ä¸ºäº†æé«˜å­—å…¸ä¸­ç‰¹å¾çš„ä¸€è‡´æ€§ï¼ŒMoCoä½¿ç”¨äº†**åŠ¨é‡ç¼–ç å™¨**ã€‚

{% asset_img 15.webp %}

åˆ°è¿™é‡Œï¼Œå…¶å® **MoCo** çš„ä¸»è¦è´¡çŒ®æ—§å·²ç»è®²å®Œäº†ï¼Œä½†æ˜¯å¦‚æœå¯¹**å¯¹æ¯”å­¦ä¹ **ä¸æ˜¯å¾ˆç†Ÿçš„äººæ¥è¯´å¯èƒ½è¿˜æ˜¯ä¸å¤ªç†è§£ **MoCo** çš„å‰å‘è¿‡ç¨‹åˆ°åº•æ˜¯ä»€ä¹ˆæ ·å­çš„ï¼Œå¯æƒœçš„æ˜¯è¿™ç¯‡è®ºæ–‡å¹¶æ²¡æœ‰æä¾›ä¸€ä¸ªå¾ˆç›´è§‚ã€å½¢è±¡çš„æ¨¡å‹æ€»è§ˆå›¾ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯ä¼ªä»£ç ï¼Œå†™å¾—ç›¸å½“ç®€æ´æ˜äº†ï¼Œç†è§£å’Œå¤ç°éƒ½æ¯”è¾ƒå®¹æ˜“ã€‚

{% asset_img 16.webp %}

***

ä¸‹é¢æ˜¯è®ºæ–‡**å®éªŒ**éƒ¨åˆ†ï¼Œä½œè€…åˆ†åˆ«åœ¨ **ImageNet-1K** å’Œ **Instagram-1B** æ•°æ®é›†ä¸Šè¿›è¡Œäº†æ¨¡å‹è®­ç»ƒï¼Œä½¿ç”¨çš„ä¸»å¹²ç½‘æ˜¯ **ResNet-50**ã€‚é¦–å…ˆæ˜¯**çº¿æ€§åˆ†ç±»**ç»“æœçš„å±•ç¤ºï¼Œåœ¨å®Œæˆäº†æ— ç›‘ç£å­¦ä¹ çš„é¢„è®­ç»ƒä¹‹åï¼Œå°†æ¨¡å‹çš„ **backbone** å†»ä½ï¼Œåªå°†å®ƒä½œä¸ºä¸€ä¸ªç‰¹å¾æå–å™¨ï¼Œç„¶ååœ¨ä¸Šé¢è®­ç»ƒä¸€ä¸ªå…¨è¿æ¥å±‚å»å……å½“åˆ†ç±»å™¨ï¼Œæ˜¯åœ¨ **ImageNet** éªŒè¯é›†ä¸Šæµ‹è¯•ï¼Œ**top-1** åˆ†ç±»å‡†ç¡®ç‡ã€‚

- å¦‚å·¦å›¾æ‰€ç¤ºï¼Œä¸‰ç§å¯¹æ¯”å­¦ä¹ æ–¹æ³•ç»“æœå¯¹æ¯”ï¼šé»‘è‰²çš„çº¿è¡¨ç¤ºçš„æ˜¯ç«¯åˆ°ç«¯çš„å­¦ä¹ ï¼Œå®ƒçš„ç»“æœåªæœ‰ä¸‰ä¸ªç‚¹ï¼Œå› ä¸ºå—é™äºæ˜¾å¡å†…å­˜ï¼Œè“è‰²çš„çº¿è¡¨ç¤ºçš„æ˜¯ **memory bank** çš„å½¢å¼ï¼Œå®ƒå¯ä»¥ç”¨å¾ˆå¤§çš„å­—å…¸ï¼Œæ‰€ä»¥å®ƒå¯ä»¥éšç€å­—å…¸å¢å¤§ä¸€ç›´è®­ç»ƒï¼Œä½†æ˜¯å®ƒçš„æ•ˆæœæ•´ä½“ä¸Šè¦æ¯”ç«¯åˆ°ç«¯å­¦ä¹ å’Œ **MoCo** çš„ç»“æœéƒ½è¦å·®ä¸€æˆªã€‚ä½œè€…è¯´è¿™å¯èƒ½æ˜¯å› ä¸ºç‰¹å¾çš„ä¸ä¸€è‡´æ€§å¯¼è‡´çš„ã€‚æ©™è‰²çš„çº¿è¡¨ç¤º **MoCo**ï¼Œ**MoCo** ç¡®å®å¯ä»¥æœ‰å¾ˆå¤§çš„å­—å…¸ï¼Œä¹‹æ‰€ä»¥åœåœ¨65536è¿™ä¸ªæ•°å­—ï¼Œä»å›¾ä¸­å¯ä»¥çœ‹åˆ°ï¼Œä»16384åˆ°65536æ€§èƒ½ä¹Ÿå·²ç»æ¯”è¾ƒé¥±å’Œäº†ï¼Œæ‰€ä»¥å†å¤§ä¹Ÿå¯èƒ½ä¸ä¼šå¸¦æ¥æ›´å¤šçš„æ€§èƒ½æå‡äº†ã€‚å¦‚æœæ‹¿ **MoCo** å’Œç«¯åˆ°ç«¯å­¦ä¹ çš„æ–¹æ³•åšæ¯”è¾ƒï¼Œå¯ä»¥å‘ç°å®ƒä»¬çš„æ›²çº¿åœ¨åˆšå¼€å§‹çš„æ—¶å€™çš„é‡åˆåº¦è¿˜æ˜¯æ¯”è¾ƒé«˜çš„ï¼Œä½†æ˜¯ä½œè€…è¯´ï¼Œå› ä¸ºæ²¡æœ‰å®éªŒçš„æ”¯æ’‘ï¼Œä¸çŸ¥é“é»‘çº¿æ˜¯å¦èƒ½ç»§ç»­æŒ‰ç…§ç°æœ‰çš„è¶‹åŠ¿ç»§ç»­å¢é•¿ä¸‹å»ï¼Œæœ‰å¯èƒ½ç»“æœä¼šæ›´é«˜ï¼Œä¹Ÿæœ‰å¯èƒ½ç»“æœä¼šæ›´ä½ï¼Œä½†æ˜¯å› ä¸ºåšä¸äº†å®éªŒï¼Œæ‰€ä»¥æ— ä»å¾—çŸ¥ã€‚

- å¦‚ä¸‹å›¾è¡¨æ ¼æ‰€ç¤ºï¼ŒåŠ¨é‡ä½¿ç”¨ä¸€ä¸ªç›¸å¯¹è¾ƒå¤§çš„å€¼ï¼ˆ0.999æˆ–è€…0.9999ï¼‰çš„æ—¶å€™æ€§èƒ½æ˜¯æœ€å¥½çš„ï¼Œå·®ä¸å¤šéƒ½æ˜¯59ï¼Œè¿™å°±è¯´æ˜äº†ä¸€ä¸ªå˜åŒ–éå¸¸ç¼“æ…¢çš„ç¼–ç å™¨æ˜¯å¯¹å¯¹æ¯”å­¦ä¹ æœ‰å¥½å¤„çš„ï¼Œå› ä¸ºå®ƒèƒ½å¤Ÿæä¾›ä¸€ä¸ªä¸€è‡´æ€§çš„ç‰¹å¾ã€‚ä½†æ˜¯å½“æŠŠåŠ¨é‡é€æ¸å˜å°ï¼Œå˜åˆ°0.99æˆ–è€…æ˜¯0.9çš„æ—¶å€™ï¼Œæ€§èƒ½çš„ä¸‹é™å°±æ¯”è¾ƒæ˜æ˜¾äº†ï¼Œå°¤å…¶æ˜¯å½“ç›´æ¥å»æ‰åŠ¨é‡ï¼Œç›´æ¥å°† **query** çš„ç¼–ç å™¨æ‹¿è¿‡æ¥å½“ **key** ç¼–ç å™¨ç”¨çš„æ—¶å€™ï¼Œå°±ä¼šå‘ç°ä¸å…‰æ˜¯æ€§èƒ½ä¸‹é™çš„é—®é¢˜ï¼Œæ•´ä¸ªæ¨¡å‹ç”šè‡³éƒ½ä¸èƒ½æ”¶æ•›ã€‚

- å³ä¸‹å›¾æ˜¯å’Œå…¶å®ƒåˆ†ç±»æ–¹æ³•çš„æ¯”è¾ƒï¼Œé¦–å…ˆå¯ä»¥å‘ç°ï¼Œå¯¹æ¯”å­¦ä¹ çš„æ•ˆæœè¿˜æ˜¯ä¸é”™çš„ï¼Œå› ä¸ºå‡†ç¡®ç‡è¦æ¯”æ²¡æœ‰ä½¿ç”¨å¯¹æ¯”å­¦ä¹ å¾—åˆ°å¾—ç»“æœè¦å¥½ã€‚ä½œè€…è¿˜å¼ºè°ƒï¼šåœ¨æ— ç›‘ç£å­¦ä¹ ä¸­ï¼Œæ¨¡å‹çš„å¤§å°è¿˜æ˜¯éå¸¸å…³é”®çš„ï¼ˆæ¨¡å‹è¶Šå¤§ï¼Œä¸€èˆ¬æ•ˆæœå°±ä¼šè¶Šå¥½ï¼‰ï¼Œæ‰€ä»¥åªæ˜¯æ¯”è¾ƒæœ€åçš„å‡†ç¡®ç‡ï¼Œè€Œä¸å»å…³æ³¨æ¨¡å‹å¤§å°çš„è¯ï¼Œå°±ä¸å¤ªå…¬å¹³äº†ï¼Œä»å›¾ä¸­å¯ä»¥çœ‹åˆ° **MoCo** æ—¢èƒ½åœ¨å°æ¨¡å‹ä¸Šå¾—åˆ°æœ€å¥½çš„æ•ˆæœï¼Œä¹Ÿèƒ½åœ¨å¤§æ¨¡å‹çš„æ¯”è¾ƒä¸­å¾—åˆ°æœ€å¥½çš„ç»“æœã€‚

{% asset_img 17.webp %}

æ— ç›‘ç£å­¦ä¹ æœ€é‡è¦çš„ç›®æ ‡æ˜¯å­¦ä¹ åˆ°å¯è¿ç§»çš„ç‰¹å¾ï¼Œä½œè€…ç”¨è§†è§‰é¢†åŸŸä¸­æœ€å¸¸è§ã€åº”ç”¨æœ€å¹¿çš„æ£€æµ‹ä»»åŠ¡æ¥åšæ— ç›‘ç£çš„**MoCo** é¢„è®­ç»ƒæ¨¡å‹å’Œ **ImageNet** çš„æœ‰ç›‘ç£é¢„è®­ç»ƒæ¨¡å‹ä¹‹é—´çš„æ¯”è¾ƒã€‚è¡¨2ç§ç¬¬ä¸€è¡Œä½¿ç”¨çš„æ˜¯**éšæœºåˆå§‹åŒ–**çš„æ¨¡å‹å†åšå¾®è°ƒï¼Œæ‰€ä»¥å®ƒæ˜¯ä¸€ä¸ªåŸºçº¿ç½‘ç»œï¼Œåˆ†æ•°æ¯”è¾ƒä½ï¼›ç¬¬äºŒè¡Œä½¿ç”¨çš„æ˜¯ **æœ‰ç›‘ç£ImageNet** çš„é¢„è®­ç»ƒçš„æ¨¡å‹åšåˆå§‹åŒ–ç„¶åå†åšå¾®è°ƒï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªæ¯”è¾ƒå¼ºçš„åŸºçº¿ç»“æœï¼›æœ€åä¸¤è¡Œåˆ†åˆ«æ˜¯ **MoCo** åœ¨ **ImageNet-1M** ä¸Šå’Œåœ¨ **Instagram-1** ä¸Šåšæ— ç›‘ç£é¢„è®­ç»ƒå½“ä½œæ¨¡å‹çš„åˆå§‹åŒ–ï¼Œç„¶åå†åšå¾®è°ƒã€‚å¯ä»¥çœ‹åˆ°å¤§å¤šæ•°ç»“æœæ˜¾ç¤º **MoCo** åœ¨ **ImageNet-1M** ä¸Šçš„é¢„è®­ç»ƒå°±å·²ç»è¶…è¿‡äº†æœ‰ç›‘ç£çš„é¢„è®­ç»ƒæ¨¡å‹ã€‚å½“æ¢æˆæ›´å¤§çš„æ•°æ®é›†çš„æ—¶å€™è¿˜ä¼šæœ‰è¿›ä¸€æ­¥çš„æå‡ã€‚

æ¥ä¸‹æ¥ä½œè€…åˆå†æ¬¡æ¯”è¾ƒäº†ä¸‰ç§å¯¹æ¯”å­¦ä¹ çš„æ£€æµ‹ç»“æœï¼Œä»è¡¨3å¯ä»¥çœ‹åˆ° **MoCo** å’Œå‰é¢ä¸¤ç§æ–¹å¼æ¯”èµ·æ¥ç¡®å®æ˜¯å¥½äº†å¾ˆå¤šï¼Œè€Œä¸”æœ€ä¸»è¦çš„æ˜¯ä¹‹å‰çš„ä¸¤ç§æ–¹æ³•éƒ½æ²¡æœ‰è¶…è¶Šæœ‰ç›‘ç£é¢„è®­ç»ƒæ¨¡å‹çš„ç»“æœï¼Œåªæœ‰MoCoæ˜¯çœŸçš„è¶…è¶Šäº†ã€‚

{% asset_img 18.webp %}

ä½œè€…åˆåœ¨ **COCO** æ•°æ®ä¸Šè¿›è¡Œäº†å¯¹æ¯”ã€‚é™¤äº†åœ¨è®¾ç½®aé‡Œé¢ **MoCo** çš„æ¨¡å‹ç¨æ˜¾é€Šè‰²ï¼Œåœ¨å‰©ä¸‹çš„ä¸‰ä¸ªè®¾ç½®ä¸‹ï¼Œ**MoCo** é¢„è®­ç»ƒçš„æ¨¡å‹éƒ½æ¯” **ImageNet** æœ‰ç›‘ç£é¢„è®­ç»ƒæ¨¡å‹å¾—åˆ°çš„æ•ˆæœè¦å¥½ã€‚

{% asset_img 19.webp %}

***

æœ€åç®€å•æ€»ç»“ä¸‹ï¼Œ**MoCo** åœ¨å¾ˆå¤šçš„è§†è§‰ä»»åŠ¡ä¸Šï¼Œå·²ç»å¤§å¹…åº¦çš„æŠŠæ— ç›‘ç£å’Œæœ‰ç›‘ç£ä¹‹é—´çš„å‘ç»™å¡«ä¸Šäº†ã€‚**MoCo** åœ¨ **Instagram** æ•°æ®é›†ä¸­æ˜¯è¦æ¯” **ImageNet** è®­ç»ƒå‡ºæ¥çš„æ¨¡å‹è¦å¥½çš„ï¼Œè€Œä¸”æ˜¯åœ¨æ‰€æœ‰ä»»åŠ¡ä¸Šæ™®éè¡¨ç°çš„éƒ½å¾ˆå¥½ï¼Œè¿™è¯´æ˜äº† **MoCo** çš„å¯æ‰©å±•æ€§å¾ˆå¥½ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœæœ‰æ›´å¤šçš„æ•°æ®ï¼Œ**MoCo** æœ‰å¯èƒ½å°±èƒ½å­¦åˆ°æ›´å¥½çš„æ¨¡å‹ï¼Œè¿™å’Œ **NLP** ä¸­å¾—åˆ°çš„ç»“è®ºæ˜¯ä¸€æ ·çš„ï¼Œè¿™ä¹Ÿç¬¦åˆäº†æ— ç›‘ç£å­¦ä¹ çš„ç»ˆæç›®æ ‡ã€‚

**MoCo** è¿™ç¯‡è®ºæ–‡ä»¥åŠå®ƒé«˜æ•ˆçš„å®ç°ï¼Œèƒ½è®©å¤§å¤šæ•°äººæœ‰æœºä¼šç”¨æ™®é€šçš„GPUå°±èƒ½è·‘å¯¹æ¯”å­¦ä¹ çš„å®éªŒã€åšç ”ç©¶ã€‚å› ä¸º **MoCo** åœ¨å„ä¸ªè§†è§‰ä»»åŠ¡ä¸Šå–å¾—äº†æ›´å¥½çš„æ€§èƒ½ï¼Œä¹Ÿæ¿€å‘äº†å¾ˆå¤šåç»­åˆ†ææ€§çš„å·¥ä½œï¼Œå»ç ”ç©¶ **MoCo** å­¦å‡ºæ¥çš„ç‰¹å¾åˆ°åº•å’Œæœ‰ç›‘ç£å­¦å‡ºæ¥çš„ç‰¹å¾æœ‰ä»€ä¹ˆä¸åŒï¼Œè¿˜èƒ½ä»åˆ«çš„ä»€ä¹ˆæ–¹å‘å»æé«˜å¯¹æ¯”å­¦ä¹ ã€‚

***

### å‚è€ƒèµ„æ–™

> <https://www.bilibili.com/video/BV1C3411s7t9/>
