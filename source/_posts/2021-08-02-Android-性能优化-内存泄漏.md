---
title: Android-æ€§èƒ½ä¼˜åŒ–-å†…å­˜æ³„æ¼
categories:
  - ğŸŒ™åŸºç¡€å­¦ä¹ 
  - â­Android
abbrlink: 8c27d4dd
date: 2021-08-02 11:45:46
tags:
---

## Androidå†…å­˜æ³„æ¼åŸå› 

ä»Javaä¸Šçœ‹ï¼Œä¸»è¦æœ‰3ä¸ªåŸå› ï¼š

1. listenerï¼šè®¾ç½®ç›‘å¬ï¼Œåœ¨ä¸€ä¸ªç±»ä¸­è®¾ç½®æˆå‘˜å˜é‡å¹¶æŠŠå¦ä¸€ä¸ªç±»ä½œä¸ºlistenerç»™setè¿›å»ï¼šmListener = setListener(listener);ï¼Œä½†åœ¨ä¸éœ€è¦æ—¶æ²¡æœ‰setä¸ºnullï¼Œå¯¼è‡´ä¸€ç›´æŒæœ‰è¯¥å¯¹è±¡å¼ºå¼•ç”¨æ— æ³•è¢«å›æ”¶ã€‚å¤–éƒ¨çš„ç±»æ²¡æœ‰è¢«å›æ”¶ï¼Œæ‰€ä»¥å†…éƒ¨çš„listenerä¹Ÿæ²¡æœ‰è¢«å›æ”¶ã€‚

2. inner-classï¼šå†…éƒ¨ç±»æŒæœ‰å¤–éƒ¨çš„å¼•ç”¨ï¼Œä¾‹å¦‚æŒæœ‰Acticityçš„thisï¼Œè§£å†³æ–¹æ³•æ˜¯å¯¹åº”çš„éœ€è¦ä»€ä¹ˆå°±ä¼ ä»€ä¹ˆï¼Œé¿å…æŒæœ‰å¤–éƒ¨å¼•ç”¨æ— æ³•è¢«é”€æ¯ã€‚

3. threadï¼šæ— è®ºæ˜¯å†…éƒ¨ç±»çš„threadè¿˜æ˜¯å¤–éƒ¨çš„threadï¼Œæ ¹æœ¬åŸå› è¿˜æ˜¯ç”±1ã€2é€ æˆï¼Œä¾‹å¦‚ç­‰å¾…ç½‘ç»œå›è°ƒç­‰ï¼Œå¯¼è‡´æŒæœ‰å¯¹è±¡æ— æ³•è¢«é”€æ¯ã€‚

<!--more-->

ä»Androidä¸Šçœ‹ï¼Œä¸»è¦æœ‰2ä¸ªåŸå› ï¼š

1. å…¨å±€è¿›ç¨‹ï¼ˆprocess-globalï¼‰çš„staticå˜é‡ã€‚è¿™ä¸ªæ— è§†åº”ç”¨çš„çŠ¶æ€ï¼ŒæŒæœ‰Activityçš„å¼ºå¼•ç”¨ã€‚

2. æ´»åœ¨Activityç”Ÿå‘½å‘¨æœŸä¹‹å¤–çš„çº¿ç¨‹ã€‚æ²¡æœ‰æ¸…ç©ºå¯¹Activityçš„å¼ºå¼•ç”¨ã€‚

***

## Androidå†…å­˜æ³„æ¼çš„å¯èƒ½çš„å…«ç§æƒ…å†µ

ä»¥ä¸‹æƒ…å†µéœ€å…³æ³¨æ˜¯å¦ä¼šå†…å­˜æ³„æ¼ï¼šStatic Activitiesã€Static Viewsã€Inner Classesã€Anonymous Classesã€Handlerã€Threadsã€TimerTaskã€Sensor Manager

ä¸€èˆ¬å†…å­˜æ³„æ¼ï¼šå¿˜è®°é‡Šæ”¾åˆ†é…çš„å†…å­˜ï¼Œä¾‹å¦‚cursor

é€»è¾‘å†…å­˜æ³„æ¼ï¼šå½“åº”ç”¨ä¸å†éœ€è¦è¿™ä¸ªå¯¹è±¡æˆ–ç»“æŸç”Ÿå‘½å‘¨æœŸï¼Œä»æœªé‡Šæ”¾è¯¥å¯¹è±¡çš„æ‰€æœ‰å¼•ç”¨

åœ¨Androidä¸­ï¼Œå¯¼è‡´æ½œåœ¨å†…å­˜æ³„æ¼çš„é™·é˜±ï¼š

1. å…¨å±€è¿›ç¨‹çš„staticå˜é‡ï¼Œè¿™ä¸ªæ— è§†åº”ç”¨çš„çŠ¶æ€ï¼ŒæŒæœ‰Activityçš„å¼ºå¼•ç”¨

2. æ´»åœ¨Activityç”Ÿå‘½å‘¨æœŸå¤–çš„çº¿ç¨‹ï¼Œæ²¡æœ‰æ¸…ç©ºå¯¹Activityçš„å¼ºå¼•ç”¨

### Static Activities

åœ¨ç±»ä¸­å®šä¹‰äº†é™æ€Activityå˜é‡ï¼ŒæŠŠå½“å‰è¿è¡Œçš„Activityå®ä¾‹èµ‹å€¼äºè¿™ä¸ªé™æ€å˜é‡ã€‚è¿™ä¸ªé™æ€å˜é‡åœ¨Activityç”Ÿå‘½å‘¨æœŸç»“æŸåæ²¡æœ‰è¢«æ¸…ç©ºå°±å¯¼è‡´äº†å†…å­˜æ³„æ¼ï¼Œå› ä¸ºstaticå˜é‡æ˜¯è´¯ç©¿è¿™ä¸ªåº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸçš„ï¼Œæ‰€ä»¥è¢«æ³„æ¼çš„Activityå°±ä¼šä¸€ç›´å­˜åœ¨äºåº”ç”¨çš„è¿›ç¨‹ä¸­ï¼Œä¸ä¼šè¢«åƒåœ¾å›æ”¶å™¨å›æ”¶ã€‚

``` java
static Activity activity;
void setStaticActivity() {
    activity = this;
}
View sButton = findViewById(R.id.button);
sButton.setOnClickListener(new View.OnClickListener() {
    @Override
    public void onClick(View v) {
        setStaticActivity();
        nextActivity();
    }
});
```

{% asset_img StaticActivities.jpg %}

è§£å†³åŠæ³•ï¼šå¼±å¼•ç”¨ä¸ä¼šé˜»æ­¢å¯¹è±¡çš„å†…å­˜é‡Šæ”¾ï¼Œæ‰€ä»¥å³ä½¿æœ‰å¼±å¼•ç”¨çš„å­˜åœ¨ï¼Œè¯¥å¯¹è±¡ä¹Ÿå¯ä»¥è¢«å›æ”¶ã€‚

``` java
private static WeakReference<MainActivity> activityReference;
void setStaticActivity() {
    activityReference = new WeakReference<MainActivity>(this);
}
```

### Static Views

å¸¸å‘ç”Ÿåœ¨å•ä¾‹æ¨¡å¼ä¸­ï¼Œå¦‚æœActivityç»å¸¸è¢«ç”¨åˆ°ï¼Œé‚£ä¹ˆåœ¨å†…å­˜ä¸­ä¿å­˜ä¸€ä¸ªå®ä¾‹æ˜¯å¾ˆå®ç”¨çš„ã€‚ä½†è„±ç¦»Activityç”Ÿå‘½å‘¨æœŸçš„æ“ä½œæ˜¯å¾ˆå±é™©çš„ã€‚

ç‰¹æ®Šæƒ…å†µï¼šå¦‚æœä¸€ä¸ªViewåˆå§‹åŒ–è€—è´¹å¤§é‡èµ„æºï¼Œè€Œä¸”åœ¨ä¸€ä¸ªActivityç”Ÿå‘½å‘¨æœŸå†…ä¿æŒä¸å˜ï¼Œé‚£ä¹ˆå¯ä»¥æŠŠå®ƒå˜æˆstaticåŠ è½½åˆ°è§†å›¾æ ‘ä¸Šï¼ˆView Hierarchyï¼‰ã€‚ä½†åœ¨Activityè¢«onDestroy()æ—¶ï¼Œåº”å½“å°†è¿™ä¸ªstatic viewç½®nullã€‚ï¼ˆè™½ç„¶ä½†æ˜¯ï¼Œä¸å»ºè®®ä½¿ç”¨static viewï¼‰

``` java
static View view;
void setStaticView() {
    view = findViewById(R.id.button);
}
View sButton = findViewById(R.id.button);
sButton.setOnClickListener(new View.OnClickListener() {
    @Override
    public void onClick(View v) {
        setStaticView();
        nextActivity();
    }
});
```

{% asset_img StaticViews.jpg %}

è§£å†³åŠæ³•ï¼šå¼±å¼•ç”¨æ˜¯ä¸ªæœ‰æ•ˆçš„è§£å†³æ–¹æ³•ï¼Œç„¶è€Œè¿˜æœ‰å¦ä¸€ç§æ–¹æ³•æ˜¯åœ¨ç”Ÿå‘½å‘¨æœŸç»“æŸæ—¶æ¸…é™¤å¼•ç”¨ï¼ŒActivity#onDestroy()æ–¹æ³•å°±å¾ˆé€‚åˆæŠŠå¼•ç”¨ç½®ç©ºã€‚

``` java
private static View view;
@Override
public void onDestroy() {
    super.onDestroy();
    if (view != null) {
        unsetStaticView();
    }
}
void unsetStaticView() {
    view = null;
}
```

### Inner Classes

Activityä¸­æœ‰ä¸ªå†…éƒ¨ç±»ï¼Œè¿™æ ·åšå¯ä»¥æé«˜å¯è¯»æ€§å’Œå°è£…æ€§ã€‚ä½†å¦‚æœè¿™ä¸ªå†…éƒ¨ç±»æŒæœ‰ä¸€ä¸ªé™æ€å˜é‡çš„å¼•ç”¨ï¼Œä¾¿å¾ˆå®¹æ˜“å†…å­˜æ³„æ¼ï¼ˆé™¤éé”€æ¯æ—¶ç½®nullï¼‰ã€‚å†…éƒ¨ç±»çš„ä¼˜åŠ¿ä¹‹ä¸€å°±æ˜¯å¯ä»¥è®¿é—®å¤–éƒ¨ç±»ï¼Œä¸å¹¸çš„æ˜¯ï¼Œå¯¼è‡´å†…å­˜æ³„æ¼çš„åŸå› ï¼Œå°±æ˜¯å†…éƒ¨ç±»æŒæœ‰å¤–éƒ¨ç±»å®ä¾‹çš„å¼ºå¼•ç”¨ã€‚

``` java
private static Object inner;
void createInnerClass() {
    class InnerClass {

    }
    inner = new InnerClass();
}
View icButton = findViewById(R.id.ic_button);
icButton.setOnClickListener(new View.OnClickListener() {
    @Override
    public void onClick(View v) {
        createInnerClass();
        nextActivity();
    }
});
```

{% asset_img InnerClasses.jpg %}

è§£å†³åŠæ³•ï¼šå¼€å‘è€…å¿…é¡»æ³¨æ„å°‘ç”¨éé™æ€å†…éƒ¨ç±»ï¼Œå› ä¸ºéé™æ€å†…éƒ¨ç±»æŒæœ‰å¤–éƒ¨ç±»çš„éšå¼å¼•ç”¨ï¼Œå®¹æ˜“å¯¼è‡´æ„æ–™ä¹‹å¤–çš„æ³„æ¼ã€‚ç„¶è€Œå†…éƒ¨ç±»å¯ä»¥è®¿é—®å¤–éƒ¨ç±»çš„ç§æœ‰å˜é‡ï¼Œåªè¦æˆ‘ä»¬æ³¨æ„å¼•ç”¨çš„ç”Ÿå‘½å‘¨æœŸï¼Œå°±å¯ä»¥é¿å…æ„å¤–çš„å‘ç”Ÿã€‚é¿å…é™æ€å˜é‡ã€‚

``` java
private Object inner;
void createInnerClass() {
    class InnerClass {

    }
    inner = new InnerClass();
}
```

### Anonymous Classes

å¦‚æœåŒ¿åç±»ä¹Ÿç»´æŠ¤äº†å¤–éƒ¨ç±»çš„å¼•ç”¨ï¼Œåœ¨Activityä¸­å®šä¹‰äº†åŒ¿åçš„AsyncTaskï¼Œå°±å®¹æ˜“å‘ç”Ÿå†…å­˜æ³„æ¼ã€‚å½“å¼‚æ­¥ä»»åŠ¡åœ¨åå°æ‰§è¡Œè€—æ—¶ä»»åŠ¡æœŸé—´ï¼ŒActivityè¢«é”€æ¯äº†ï¼ˆç”¨æˆ·é€€å‡ºã€ç³»ç»Ÿå›æ”¶ï¼‰ï¼Œè¿™ä¸ªè¢«AsyncTaskæŒæœ‰çš„Activityå®ä¾‹å°±ä¸ä¼šè¢«GCå›æ”¶ï¼Œç›´åˆ°å¼‚æ­¥ä»»åŠ¡ç»“æŸã€‚

``` java
void startAsyncTask() {
    new AsyncTask<Void, Void, Void>() {
        @Override
        protected Void doInBackground(Void... params) {
            while(true);
        }
    }.execute();
}
super.onCreate(savedInstanceState);
setContentView(R.layout.activity_main);
View aicButton = findViewById(R.id.at_button);
aicButton.setOnClickListener(new View.OnClickListener() {
    @Override
    public void onClick(View v) {
        startAsyncTask();
        nextActivity();
    }
});
```

{% asset_img AnonymousClasses.jpg %}

è§£å†³åŠæ³•ï¼šåŒ¿åç±»å’Œå†…éƒ¨ç±»ä¸€æ ·ï¼Œåªè¦ä¸è·¨è¶Šç”Ÿå‘½å‘¨æœŸæ˜¯å®Œå…¨æ²¡é—®é¢˜çš„ã€‚ä½†æ˜¯ï¼Œè¿™äº›ç±»æ˜¯ç”¨äºäº§ç”Ÿåå°çº¿ç¨‹çš„ï¼Œè¿™äº›Javaçº¿ç¨‹æ˜¯å…¨å±€çš„ï¼Œè€Œä¸”æŒæœ‰åˆ›å»ºè€…çš„å¼•ç”¨ï¼ˆå³åŒ¿åç±»çš„å¼•ç”¨ï¼‰ï¼Œè€ŒåŒ¿åç±»åˆæŒæœ‰å¤–éƒ¨ç±»çš„å¼•ç”¨ã€‚çº¿ç¨‹æ˜¯å¯èƒ½é•¿æ—¶é—´è¿è¡Œçš„ï¼Œæ‰€ä»¥ä¸€ç›´æŒæœ‰Activityçš„å¼•ç”¨å¯¼è‡´å½“é”€æ¯æ—¶æ— æ³•å›æ”¶ã€‚æˆ‘ä»¬ä¸èƒ½é€šè¿‡ç§»é™¤é™æ€æˆå‘˜å˜é‡è§£å†³ï¼Œå› ä¸ºçº¿ç¨‹æ˜¯äºåº”ç”¨ç”Ÿå‘½å‘¨æœŸç›¸å…³çš„ã€‚ä¸ºäº†é¿å…æ³„æ¼ï¼Œå¿…é¡»èˆå¼ƒç®€æ´å·æ‡’çš„å†™æ³•ï¼ŒæŠŠå­ç±»å£°æ˜ä¸ºé™æ€å†…éƒ¨ç±»ã€‚ï¼ˆé™æ€å†…éƒ¨ç±»ä¸æŒæœ‰å¤–éƒ¨ç±»çš„å¼•ç”¨ï¼Œæ‰“ç ´äº†é“¾å¼å¼•ç”¨ã€‚ï¼‰

``` java
private static class NimbleTask extends AsyncTask<Void, VoiVoid> {
    @Override
    protected Void doInBackground(Void... params) {
        while(true);
    }
}
void startAsyncTask() {
    new NimbleTask().execute();
}
```

### Handler

å®šä¹‰äº†åŒ¿åçš„Runnableï¼Œç”¨åŒ¿åç±»Handleræ‰§è¡Œã€‚Runnableå†…éƒ¨ç±»ä¼šæŒæœ‰å¤–éƒ¨ç±»çš„éšå¼å¼•ç”¨ï¼Œè¢«ä¼ é€’åˆ°Handlerçš„æ¶ˆæ¯é˜Ÿåˆ—MessageQueueä¸­ï¼Œåœ¨Messageæ¶ˆæ¯æ²¡æœ‰è¢«å¤„ç†ä¹‹å‰ï¼ŒActivityé”€æ¯å¯¼è‡´äº†å†…å­˜æ³„æ¼ã€‚

``` java
void createHandler() {
    new Handler() {
        @Override
        public void handleMessage(Message message) {
            super.handleMessage(message);
        }
    }.postDelayed(new Runnable() {
        @Override
        public void run() {
            while(true);
        }
    }, Long.MAX_VALUE >> 1);
}
View hButton = findViewById(R.id.h_button);
hButton.setOnClickListener(new View.OnClickListener() {
    @Override
    public void onClick(View v) {
        createHandler();
        nextActivity();
    }
});
```

{% asset_img Handler.jpg %}

è§£å†³åŠæ³•ï¼šåŒ¿åç±»å’Œå†…éƒ¨ç±»ä¸€æ ·ï¼Œåªè¦ä¸è·¨è¶Šç”Ÿå‘½å‘¨æœŸæ˜¯å®Œå…¨æ²¡é—®é¢˜çš„ã€‚ä½†æ˜¯ï¼Œè¿™äº›ç±»æ˜¯ç”¨äºäº§ç”Ÿåå°çº¿ç¨‹çš„ï¼Œè¿™äº›Javaçº¿ç¨‹æ˜¯å…¨å±€çš„ï¼Œè€Œä¸”æŒæœ‰åˆ›å»ºè€…çš„å¼•ç”¨ï¼ˆå³åŒ¿åç±»çš„å¼•ç”¨ï¼‰ï¼Œè€ŒåŒ¿åç±»åˆæŒæœ‰å¤–éƒ¨ç±»çš„å¼•ç”¨ã€‚çº¿ç¨‹æ˜¯å¯èƒ½é•¿æ—¶é—´è¿è¡Œçš„ï¼Œæ‰€ä»¥ä¸€ç›´æŒæœ‰Activityçš„å¼•ç”¨å¯¼è‡´å½“é”€æ¯æ—¶æ— æ³•å›æ”¶ã€‚æˆ‘ä»¬ä¸èƒ½é€šè¿‡ç§»é™¤é™æ€æˆå‘˜å˜é‡è§£å†³ï¼Œå› ä¸ºçº¿ç¨‹æ˜¯äºåº”ç”¨ç”Ÿå‘½å‘¨æœŸç›¸å…³çš„ã€‚ä¸ºäº†é¿å…æ³„æ¼ï¼Œå¿…é¡»èˆå¼ƒç®€æ´å·æ‡’çš„å†™æ³•ï¼ŒæŠŠå­ç±»å£°æ˜ä¸ºé™æ€å†…éƒ¨ç±»ã€‚ï¼ˆé™æ€å†…éƒ¨ç±»ä¸æŒæœ‰å¤–éƒ¨ç±»çš„å¼•ç”¨ï¼Œæ‰“ç ´äº†é“¾å¼å¼•ç”¨ã€‚ï¼‰

``` java
private static class NimbleHandler extends Handler {
    @Override
    public void handleMessage(Message message) {
        super.handleMessage(message);
    }
}
private static class NimbleRunnable implements Runnable {
    @Override
    public void run() {
        while(true);
    }
}
void createHandler() {
    new NimbleHandler().postDelayed(new NimbleRunnable(), Long.MAX_VALUE >> 1);
}
```

### Threads

é€šè¿‡Threadå’ŒTimerTaskæ¥å±•ç°å†…å­˜æ³„æ¼

``` java
void spawnThread() {
    new Thread() {
        @Override public void run() {
            while(true);
        }
    }.start();
}
View tButton = findViewById(R.id.t_button);
tButton.setOnClickListener(new View.OnClickListener() {
    @Override
    public void onClick(View v) {
        spawnThread();
        nextActivity();
    }
});
```

{% asset_img Threads.jpg %}

è§£å†³åŠæ³•ï¼šä½¿ç”¨é™æ€å†…éƒ¨ç±»ï¼Œä¸æŒæœ‰å¤–éƒ¨ç±»çš„å¼•ç”¨ï¼Œæ‰“ç ´äº†é“¾å¼å¼•ç”¨ã€‚ä½†æ˜¯ï¼Œå¦‚æœåšæŒä½¿ç”¨åŒ¿åç±»ï¼Œåªè¦åœ¨ç”Ÿå‘½å‘¨æœŸç»“æŸæ—¶ä¸­æ–­çº¿ç¨‹å°±å¯ä»¥ã€‚

``` java
private Thread thread;
@Override
public void onDestroy() {
    super.onDestroy();
    if (thread != null) {
        thread.interrupt();
    }
}
void spawnThread() {
    thread = new Thread() {
        @Override
        public void run() {
            while (!isInterrupted()) {
            }
        }
    };
    thread.start();
}
```

### TimerTask

åªè¦æ˜¯åŒ¿åç±»çš„å®ä¾‹ï¼Œä¸ç®¡æ˜¯ä¸æ˜¯åœ¨å·¥ä½œçº¿ç¨‹ï¼Œéƒ½ä¼šæŒæœ‰Activityçš„å¼•ç”¨ï¼Œå¯¼è‡´å†…å­˜æ³„æ¼ã€‚

``` java
void scheduleTimer() {
    new Timer().schedule(new TimerTask() {
        @Override
        public void run() {
            while(true);
        }
    }, Long.MAX_VALUE >> 1);
}
View ttButton = findViewById(R.id.tt_button);
ttButton.setOnClickListener(new View.OnClickListener() {
    @Override
    public void onClick(View v) {
        scheduleTimer();
        nextActivity();
    }
});
```

{% asset_img TimerTask.jpg %}

è§£å†³åŠæ³•ï¼šåŒ¿åç±»å’Œå†…éƒ¨ç±»ä¸€æ ·ï¼Œåªè¦ä¸è·¨è¶Šç”Ÿå‘½å‘¨æœŸæ˜¯å®Œå…¨æ²¡é—®é¢˜çš„ã€‚ä½†æ˜¯ï¼Œè¿™äº›ç±»æ˜¯ç”¨äºäº§ç”Ÿåå°çº¿ç¨‹çš„ï¼Œè¿™äº›Javaçº¿ç¨‹æ˜¯å…¨å±€çš„ï¼Œè€Œä¸”æŒæœ‰åˆ›å»ºè€…çš„å¼•ç”¨ï¼ˆå³åŒ¿åç±»çš„å¼•ç”¨ï¼‰ï¼Œè€ŒåŒ¿åç±»åˆæŒæœ‰å¤–éƒ¨ç±»çš„å¼•ç”¨ã€‚çº¿ç¨‹æ˜¯å¯èƒ½é•¿æ—¶é—´è¿è¡Œçš„ï¼Œæ‰€ä»¥ä¸€ç›´æŒæœ‰Activityçš„å¼•ç”¨å¯¼è‡´å½“é”€æ¯æ—¶æ— æ³•å›æ”¶ã€‚æˆ‘ä»¬ä¸èƒ½é€šè¿‡ç§»é™¤é™æ€æˆå‘˜å˜é‡è§£å†³ï¼Œå› ä¸ºçº¿ç¨‹æ˜¯äºåº”ç”¨ç”Ÿå‘½å‘¨æœŸç›¸å…³çš„ã€‚ä¸ºäº†é¿å…æ³„æ¼ï¼Œå¿…é¡»èˆå¼ƒç®€æ´å·æ‡’çš„å†™æ³•ï¼ŒæŠŠå­ç±»å£°æ˜ä¸ºé™æ€å†…éƒ¨ç±»ã€‚ï¼ˆé™æ€å†…éƒ¨ç±»ä¸æŒæœ‰å¤–éƒ¨ç±»çš„å¼•ç”¨ï¼Œæ‰“ç ´äº†é“¾å¼å¼•ç”¨ã€‚ï¼‰

``` java
private static class NimbleTimerTask extends TimerTask {
    @Override
    public void run() {
        while(true);
    }
}
void scheduleTimer() {
    new Timer().schedule(new NimbleTimerTask(), Long.MAX_VALUE >> 1);
}
```

### Sensor Manager

é€šè¿‡Context.getSystemService(int name)å¯ä»¥è·å–ç³»ç»ŸæœåŠ¡ã€‚è¿™äº›æœåŠ¡å·¥ä½œåœ¨å„è‡ªçš„è¿›ç¨‹ä¸­ï¼Œå¸®åŠ©åº”ç”¨å¤„ç†åå°ä»»åŠ¡ï¼Œå¤„ç†ç¡¬ä»¶äº¤äº’ã€‚å¦‚æœéœ€è¦ä½¿ç”¨è¿™äº›æœåŠ¡ï¼Œå¯ä»¥æ³¨å†Œç›‘å¬å™¨ï¼Œè¿™ä¼šå¯¼è‡´æœåŠ¡æŒæœ‰äº†Contextçš„å¼•ç”¨ï¼Œå¦‚æœåœ¨Activityé”€æ¯çš„æ—¶å€™æ²¡æœ‰æ³¨é”€è¿™äº›ç›‘å¬å™¨ï¼Œä¼šå¯¼è‡´å†…å­˜æ³„æ¼ã€‚

``` java
void registerListener() {
    SensorManager sensorManager = (SensorManager) getSystemService(SENSOR_SERVICE);
    Sensor sensor = sensorManager.getDefaultSensor(Sensor.TYPE_ALL);
    sensorManager.registerListener(this, sensor, SensorManager.SENSOR_DELAY_FASTEST);
}
View smButton = findViewById(R.id.sm_button);
smButton.setOnClickListener(new View.OnClickListener() {
    @Override
    public void onClick(View v) {
        registerListener();
        nextActivity();
    }
});
```

{% asset_img SensorManager.jpg %}

è§£å†³åŠæ³•ï¼šåœ¨Activityç»“æŸæ—¶æ³¨é”€ç›‘å¬å™¨

``` java
private SensorManager sensorManager;
private Sensor sensor;
@Override
public void onDestroy() {
    super.onDestroy();
    if (sensor != null) {
        unregisterListener();
   }
}
void unregisterListener() {
    sensorManager.unregisterListener(this, sensor);
}
```
