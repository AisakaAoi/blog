---
title: è®¾è®¡æ¨¡å¼-è¡Œä¸ºå‹æ¨¡å¼-è®¿é—®è€…æ¨¡å¼
categories:
  - ğŸŒ™å¤§å­¦è¯¾ç¨‹
abbrlink: 3d045dd4
date: 2021-01-15 00:41:25
tags:
---

### è®¿é—®è€…æ¨¡å¼ï¼ˆVisitoræ¨¡å¼ï¼‰

åœ¨ç°å®ç”Ÿæ´»ä¸­ï¼Œæœ‰äº›é›†åˆå¯¹è±¡å­˜åœ¨å¤šç§ä¸åŒçš„å…ƒç´ ï¼Œä¸”æ¯ç§å…ƒç´ ä¹Ÿå­˜åœ¨å¤šç§ä¸åŒçš„è®¿é—®è€…å’Œå¤„ç†æ–¹å¼ã€‚ä¾‹å¦‚ï¼Œå…¬å›­ä¸­å­˜åœ¨å¤šä¸ªæ™¯ç‚¹ï¼Œä¹Ÿå­˜åœ¨å¤šä¸ªæ¸¸å®¢ï¼Œä¸åŒçš„æ¸¸å®¢å¯¹åŒä¸€ä¸ªæ™¯ç‚¹çš„è¯„ä»·å¯èƒ½ä¸åŒï¼›åŒ»é™¢åŒ»ç”Ÿå¼€çš„å¤„æ–¹å•ä¸­åŒ…å«å¤šç§è¯å…ƒç´ ï¼ŒæŸ»çœ‹å®ƒçš„åˆ’ä»·å‘˜å’Œè¯æˆ¿å·¥ä½œäººå‘˜å¯¹å®ƒçš„å¤„ç†æ–¹å¼ä¹Ÿä¸åŒï¼Œåˆ’ä»·å‘˜æ ¹æ®å¤„æ–¹å•ä¸Šé¢çš„è¯å“åå’Œæ•°é‡è¿›è¡Œåˆ’ä»·ï¼Œè¯æˆ¿å·¥ä½œäººå‘˜æ ¹æ®å¤„æ–¹å•çš„å†…å®¹è¿›è¡ŒæŠ“è¯ã€‚

è¿™æ ·çš„ä¾‹å­è¿˜æœ‰å¾ˆå¤šï¼Œä¾‹å¦‚ï¼Œç”µå½±æˆ–ç”µè§†å‰§ä¸­çš„äººç‰©è§’è‰²ï¼Œä¸åŒçš„è§‚ä¼—å¯¹ä»–ä»¬çš„è¯„ä»·ä¹Ÿä¸åŒï¼›è¿˜æœ‰é¡¾å®¢åœ¨å•†åœºè´­ç‰©æ—¶æ”¾åœ¨â€œè´­ç‰©è½¦â€ä¸­çš„å•†å“ï¼Œé¡¾å®¢ä¸»è¦å…³å¿ƒæ‰€é€‰å•†å“çš„æ€§ä»·æ¯”ï¼Œè€Œæ”¶é“¶å‘˜å…³å¿ƒçš„æ˜¯å•†å“çš„ä»·æ ¼å’Œæ•°é‡ã€‚

è¿™äº›è¢«å¤„ç†çš„æ•°æ®å…ƒç´ ç›¸å¯¹ç¨³å®šè€Œè®¿é—®æ–¹å¼å¤šç§å¤šæ ·çš„æ•°æ®ç»“æ„ï¼Œå¦‚æœç”¨â€œè®¿é—®è€…æ¨¡å¼â€æ¥å¤„ç†æ¯”è¾ƒæ–¹ä¾¿ã€‚è®¿é—®è€…æ¨¡å¼èƒ½æŠŠå¤„ç†æ–¹æ³•ä»æ•°æ®ç»“æ„ä¸­åˆ†ç¦»å‡ºæ¥ï¼Œå¹¶å¯ä»¥æ ¹æ®éœ€è¦å¢åŠ æ–°çš„å¤„ç†æ–¹æ³•ï¼Œä¸”ä¸ç”¨ä¿®æ”¹åŸæ¥çš„ç¨‹åºä»£ç ä¸æ•°æ®ç»“æ„ï¼Œè¿™æé«˜äº†ç¨‹åºçš„æ‰©å±•æ€§å’Œçµæ´»æ€§ã€‚

***

<!--more-->

### æ¨¡å¼çš„å®šä¹‰ä¸ç‰¹ç‚¹

**è®¿é—®è€…ï¼ˆVisitorï¼‰æ¨¡å¼çš„å®šä¹‰ï¼š**å°†ä½œç”¨äºæŸç§æ•°æ®ç»“æ„ä¸­çš„å„å…ƒç´ çš„æ“ä½œåˆ†ç¦»å‡ºæ¥å°è£…æˆç‹¬ç«‹çš„ç±»ï¼Œä½¿å…¶åœ¨ä¸æ”¹å˜æ•°æ®ç»“æ„çš„å‰æä¸‹å¯ä»¥æ·»åŠ ä½œç”¨äºè¿™äº›å…ƒç´ çš„æ–°çš„æ“ä½œï¼Œä¸ºæ•°æ®ç»“æ„ä¸­çš„æ¯ä¸ªå…ƒç´ æä¾›å¤šç§è®¿é—®æ–¹å¼ã€‚å®ƒå°†å¯¹æ•°æ®çš„æ“ä½œä¸æ•°æ®ç»“æ„è¿›è¡Œåˆ†ç¦»ï¼Œæ˜¯è¡Œä¸ºç±»æ¨¡å¼ä¸­æœ€å¤æ‚çš„ä¸€ç§æ¨¡å¼ã€‚

è®¿é—®è€…ï¼ˆVisitorï¼‰æ¨¡å¼æ˜¯ä¸€ç§å¯¹è±¡è¡Œä¸ºå‹æ¨¡å¼ï¼Œå…¶ä¸»è¦ä¼˜ç‚¹å¦‚ä¸‹ï¼š
1. æ‰©å±•æ€§å¥½ã€‚èƒ½å¤Ÿåœ¨ä¸ä¿®æ”¹å¯¹è±¡ç»“æ„ä¸­çš„å…ƒç´ çš„æƒ…å†µä¸‹ï¼Œä¸ºå¯¹è±¡ç»“æ„ä¸­çš„å…ƒç´ æ·»åŠ æ–°çš„åŠŸèƒ½ã€‚
2. å¤ç”¨æ€§å¥½ã€‚å¯ä»¥é€šè¿‡è®¿é—®è€…æ¥å®šä¹‰æ•´ä¸ªå¯¹è±¡ç»“æ„é€šç”¨çš„åŠŸèƒ½ï¼Œä»è€Œæé«˜ç³»ç»Ÿçš„å¤ç”¨ç¨‹åº¦ã€‚
3. çµæ´»æ€§å¥½ã€‚è®¿é—®è€…æ¨¡å¼å°†æ•°æ®ç»“æ„ä¸ä½œç”¨äºç»“æ„ä¸Šçš„æ“ä½œè§£è€¦ï¼Œä½¿å¾—æ“ä½œé›†åˆå¯ç›¸å¯¹è‡ªç”±åœ°æ¼”åŒ–è€Œä¸å½±å“ç³»ç»Ÿçš„æ•°æ®ç»“æ„ã€‚
4. ç¬¦åˆå•ä¸€èŒè´£åŸåˆ™ã€‚è®¿é—®è€…æ¨¡å¼æŠŠç›¸å…³çš„è¡Œä¸ºå°è£…åœ¨ä¸€èµ·ï¼Œæ„æˆä¸€ä¸ªè®¿é—®è€…ï¼Œä½¿æ¯ä¸€ä¸ªè®¿é—®è€…çš„åŠŸèƒ½éƒ½æ¯”è¾ƒå•ä¸€ã€‚

è®¿é—®è€…ï¼ˆVisitorï¼‰æ¨¡å¼çš„ä¸»è¦ç¼ºç‚¹å¦‚ä¸‹ï¼š
1. å¢åŠ æ–°çš„å…ƒç´ ç±»å¾ˆå›°éš¾ã€‚åœ¨è®¿é—®è€…æ¨¡å¼ä¸­ï¼Œæ¯å¢åŠ ä¸€ä¸ªæ–°çš„å…ƒç´ ç±»ï¼Œéƒ½è¦åœ¨æ¯ä¸€ä¸ªå…·ä½“è®¿é—®è€…ç±»ä¸­å¢åŠ ç›¸åº”çš„å…·ä½“æ“ä½œï¼Œè¿™è¿èƒŒäº†â€œå¼€é—­åŸåˆ™â€ã€‚
2. ç ´åå°è£…ã€‚è®¿é—®è€…æ¨¡å¼ä¸­å…·ä½“å…ƒç´ å¯¹è®¿é—®è€…å…¬å¸ƒç»†èŠ‚ï¼Œè¿™ç ´åäº†å¯¹è±¡çš„å°è£…æ€§ã€‚
3. è¿åäº†ä¾èµ–å€’ç½®åŸåˆ™ã€‚è®¿é—®è€…æ¨¡å¼ä¾èµ–äº†å…·ä½“ç±»ï¼Œè€Œæ²¡æœ‰ä¾èµ–æŠ½è±¡ç±»ã€‚

***

### æ¨¡å¼çš„ç»“æ„ä¸å®ç°

è®¿é—®è€…ï¼ˆVisitorï¼‰æ¨¡å¼å®ç°çš„å…³é”®æ˜¯å¦‚ä½•å°†ä½œç”¨äºå…ƒç´ çš„æ“ä½œåˆ†ç¦»å‡ºæ¥å°è£…æˆç‹¬ç«‹çš„ç±»ï¼Œå…¶åŸºæœ¬ç»“æ„ä¸å®ç°æ–¹æ³•å¦‚ä¸‹ã€‚

#### æ¨¡å¼çš„ç»“æ„

è®¿é—®è€…æ¨¡å¼åŒ…å«ä»¥ä¸‹ä¸»è¦è§’è‰²ï¼š
1. æŠ½è±¡è®¿é—®è€…ï¼ˆVisitorï¼‰è§’è‰²ï¼šå®šä¹‰ä¸€ä¸ªè®¿é—®å…·ä½“å…ƒç´ çš„æ¥å£ï¼Œä¸ºæ¯ä¸ªå…·ä½“å…ƒç´ ç±»å¯¹åº”ä¸€ä¸ªè®¿é—®æ“ä½œ visit() ï¼Œè¯¥æ“ä½œä¸­çš„å‚æ•°ç±»å‹æ ‡è¯†äº†è¢«è®¿é—®çš„å…·ä½“å…ƒç´ ã€‚
2. å…·ä½“è®¿é—®è€…ï¼ˆConcreteVisitorï¼‰è§’è‰²ï¼šå®ç°æŠ½è±¡è®¿é—®è€…è§’è‰²ä¸­å£°æ˜çš„å„ä¸ªè®¿é—®æ“ä½œï¼Œç¡®å®šè®¿é—®è€…è®¿é—®ä¸€ä¸ªå…ƒç´ æ—¶è¯¥åšä»€ä¹ˆã€‚
3. æŠ½è±¡å…ƒç´ ï¼ˆElementï¼‰è§’è‰²ï¼šå£°æ˜ä¸€ä¸ªåŒ…å«æ¥å—æ“ä½œ accept() çš„æ¥å£ï¼Œè¢«æ¥å—çš„è®¿é—®è€…å¯¹è±¡ä½œä¸º accept() æ–¹æ³•çš„å‚æ•°ã€‚
4. å…·ä½“å…ƒç´ ï¼ˆConcreteElementï¼‰è§’è‰²ï¼šå®ç°æŠ½è±¡å…ƒç´ è§’è‰²æä¾›çš„ accept() æ“ä½œï¼Œå…¶æ–¹æ³•ä½“é€šå¸¸éƒ½æ˜¯ visitor.visit(this) ï¼Œå¦å¤–å…·ä½“å…ƒç´ ä¸­å¯èƒ½è¿˜åŒ…å«æœ¬èº«ä¸šåŠ¡é€»è¾‘çš„ç›¸å…³æ“ä½œã€‚
5. å¯¹è±¡ç»“æ„ï¼ˆObject Structureï¼‰è§’è‰²ï¼šæ˜¯ä¸€ä¸ªåŒ…å«å…ƒç´ è§’è‰²çš„å®¹å™¨ï¼Œæä¾›è®©è®¿é—®è€…å¯¹è±¡éå†å®¹å™¨ä¸­çš„æ‰€æœ‰å…ƒç´ çš„æ–¹æ³•ï¼Œé€šå¸¸ç”± Listã€Setã€Map ç­‰èšåˆç±»å®ç°ã€‚

{% asset_img 1.gif %}

#### æ¨¡å¼çš„å®ç°

è®¿é—®è€…æ¨¡å¼çš„å®ç°ä»£ç å¦‚ä¸‹ï¼š

``` java
package net.biancheng.c.visitor;
import java.util.*;
public class VisitorPattern {
    public static void main(String[] args) {
        ObjectStructure os = new ObjectStructure();
        os.add(new ConcreteElementA());
        os.add(new ConcreteElementB());
        Visitor visitor = new ConcreteVisitorA();
        os.accept(visitor);
        System.out.println("------------------------");
        visitor = new ConcreteVisitorB();
        os.accept(visitor);
    }
}
// æŠ½è±¡è®¿é—®è€…
interface Visitor {
    void visit(ConcreteElementA element);
    void visit(ConcreteElementB element);
}
// å…·ä½“è®¿é—®è€…Aç±»
class ConcreteVisitorA implements Visitor {
    public void visit(ConcreteElementA element) {
        System.out.println("å…·ä½“è®¿é—®è€…Aè®¿é—®-->" + element.operationA());
    }
    public void visit(ConcreteElementB element) {
        System.out.println("å…·ä½“è®¿é—®è€…Aè®¿é—®-->" + element.operationB());
    }
}
// å…·ä½“è®¿é—®è€…Bç±»
class ConcreteVisitorB implements Visitor {
    public void visit(ConcreteElementA element) {
        System.out.println("å…·ä½“è®¿é—®è€…Bè®¿é—®-->" + element.operationA());
    }
    public void visit(ConcreteElementB element) {
        System.out.println("å…·ä½“è®¿é—®è€…Bè®¿é—®-->" + element.operationB());
    }
}
// æŠ½è±¡å…ƒç´ ç±»
interface Element {
    void accept(Visitor visitor);
}
// å…·ä½“å…ƒç´ Aç±»
class ConcreteElementA implements Element {
    public void accept(Visitor visitor) {
        visitor.visit(this);
    }
    public String operationA() {
        return "å…·ä½“å…ƒç´ Açš„æ“ä½œã€‚";
    }
}
// å…·ä½“å…ƒç´ Bç±»
class ConcreteElementB implements Element {
    public void accept(Visitor visitor) {
        visitor.visit(this);
    }
    public String operationB() {
        return "å…·ä½“å…ƒç´ Bçš„æ“ä½œã€‚";
    }
}
// å¯¹è±¡ç»“æ„è§’è‰²
class ObjectStructure {
    private List<Element> list = new ArrayList<Element>();
    public void accept(Visitor visitor) {
        Iterator<Element> i = list.iterator();
        while (i.hasNext()) {
            ((Element) i.next()).accept(visitor);
        }
    }
    public void add(Element element) {
        list.add(element);
    }
    public void remove(Element element) {
        list.remove(element);
    }
}
```

ç¨‹åºçš„è¿è¡Œç»“æœå¦‚ä¸‹ï¼š

```
å…·ä½“è®¿é—®è€…Aè®¿é—®-->å…·ä½“å…ƒç´ Açš„æ“ä½œã€‚
å…·ä½“è®¿é—®è€…Aè®¿é—®-->å…·ä½“å…ƒç´ Bçš„æ“ä½œã€‚
------------------------
å…·ä½“è®¿é—®è€…Bè®¿é—®-->å…·ä½“å…ƒç´ Açš„æ“ä½œã€‚
å…·ä½“è®¿é—®è€…Bè®¿é—®-->å…·ä½“å…ƒç´ Bçš„æ“ä½œã€‚
```

***

### æ¨¡å¼çš„åº”ç”¨å®ä¾‹

#### ã€ä¾‹1ã€‘åˆ©ç”¨â€œè®¿é—®è€…ï¼ˆVisitorï¼‰æ¨¡å¼â€æ¨¡æ‹Ÿè‰ºæœ¯å…¬å¸ä¸é€ å¸å…¬å¸çš„åŠŸèƒ½

åˆ†æï¼šè‰ºæœ¯å…¬å¸åˆ©ç”¨â€œé“œâ€å¯ä»¥è®¾è®¡å‡ºé“œåƒï¼Œåˆ©ç”¨â€œçº¸â€å¯ä»¥ç”»å‡ºå›¾ç”»ï¼›é€ å¸å…¬å¸åˆ©ç”¨â€œé“œâ€å¯ä»¥å°å‡ºé“œå¸ï¼Œåˆ©ç”¨â€œçº¸â€å¯ä»¥å°å‡ºçº¸å¸ï¼ˆç‚¹æ­¤ä¸‹è½½è¿è¡Œè¯¥ç¨‹åºåæ‰€è¦æ˜¾ç¤ºçš„å›¾ç‰‡ï¼‰ã€‚å¯¹â€œé“œâ€å’Œâ€œçº¸â€è¿™ä¸¤ç§å…ƒç´ ï¼Œä¸¤ä¸ªå…¬å¸çš„å¤„ç†æ–¹æ³•ä¸åŒï¼Œæ‰€ä»¥è¯¥å®ä¾‹ç”¨è®¿é—®è€…æ¨¡å¼æ¥å®ç°æ¯”è¾ƒé€‚åˆã€‚

é¦–å…ˆï¼Œå®šä¹‰ä¸€ä¸ªå…¬å¸ï¼ˆCompanyï¼‰æ¥å£ï¼Œå®ƒæ˜¯æŠ½è±¡è®¿é—®è€…ï¼Œæä¾›äº†ä¸¤ä¸ªæ ¹æ®çº¸ï¼ˆPaperï¼‰æˆ–é“œï¼ˆCuprumï¼‰è¿™ä¸¤ç§å…ƒç´ åˆ›å»ºä½œå“çš„æ–¹æ³•ï¼›å†å®šä¹‰è‰ºæœ¯å…¬å¸ï¼ˆArtCompanyï¼‰ç±»å’Œé€ å¸å…¬å¸ï¼ˆMintï¼‰ç±»ï¼Œå®ƒä»¬æ˜¯å…·ä½“è®¿é—®è€…ï¼Œå®ç°äº†çˆ¶æ¥å£çš„æ–¹æ³•ã€‚

ç„¶åï¼Œå®šä¹‰ä¸€ä¸ªææ–™ï¼ˆMaterialï¼‰æ¥å£ï¼Œå®ƒæ˜¯æŠ½è±¡å…ƒç´ ï¼Œæä¾›äº† acceptï¼ˆCompany visitorï¼‰æ–¹æ³•æ¥æ¥å—è®¿é—®è€…ï¼ˆCompanyï¼‰å¯¹è±¡è®¿é—®ï¼›å†å®šä¹‰çº¸ï¼ˆPaperï¼‰ç±»å’Œé“œï¼ˆCuprumï¼‰ç±»ï¼Œå®ƒä»¬æ˜¯å…·ä½“å…ƒç´ ç±»ï¼Œå®ç°äº†çˆ¶æ¥å£ä¸­çš„æ–¹æ³•ã€‚

æœ€åï¼Œå®šä¹‰ä¸€ä¸ªææ–™é›†ï¼ˆSetMaterialï¼‰ç±»ï¼Œå®ƒæ˜¯å¯¹è±¡ç»“æ„è§’è‰²ï¼Œæ‹¥æœ‰ä¿å­˜æ‰€æœ‰å…ƒç´ çš„å®¹å™¨ Listï¼Œå¹¶æä¾›è®©è®¿é—®è€…å¯¹è±¡éå†å®¹å™¨ä¸­çš„æ‰€æœ‰å…ƒç´ çš„ acceptï¼ˆCompany visitorï¼‰æ–¹æ³•ï¼›å®¢æˆ·ç±»è®¾è®¡æˆçª—ä½“ç¨‹åºï¼Œå®ƒæä¾›ææ–™é›†ï¼ˆSetMaterialï¼‰å¯¹è±¡ä¾›è®¿é—®è€…ï¼ˆCompanyï¼‰å¯¹è±¡è®¿é—®ï¼Œå®ç°äº† ItemListener æ¥å£ï¼Œå¤„ç†ç”¨æˆ·çš„äº‹ä»¶è¯·æ±‚ã€‚

{% asset_img 2.gif %}

ç¨‹åºä»£ç å¦‚ä¸‹ï¼š

``` java
package net.biancheng.c.visitor;
import javax.swing.*;
import java.awt.event.ItemEvent;
import java.awt.event.ItemListener;
import java.util.ArrayList;
import java.util.Iterator;
import java.util.List;
public class VisitorProducer {
    public static void main(String[] args) {
        new MaterialWin();
    }
}
// çª—ä½“ç±»
class MaterialWin extends JFrame implements ItemListener {
    private static final long serialVersionUID = 1L;
    JPanel CenterJP;
    SetMaterial os;    // ææ–™é›†å¯¹è±¡
    Company visitor1, visitor2;    // è®¿é—®è€…å¯¹è±¡
    String[] select;
    MaterialWin() {
        super("åˆ©ç”¨è®¿é—®è€…æ¨¡å¼è®¾è®¡è‰ºæœ¯å…¬å¸å’Œé€ å¸å…¬å¸");
        JRadioButton Art;
        JRadioButton mint;
        os = new SetMaterial();
        os.add(new Cuprum());
        os.add(new Paper());
        visitor1 = new ArtCompany();// è‰ºæœ¯å…¬å¸
        visitor2 = new Mint(); // é€ å¸å…¬å¸
        this.setBounds(10, 10, 750, 350);
        this.setResizable(false);
        CenterJP = new JPanel();
        this.add("Center", CenterJP);
        JPanel SouthJP = new JPanel();
        JLabel yl = new JLabel("åŸææ–™æœ‰ï¼šé“œå’Œçº¸ï¼Œè¯·é€‰æ‹©ç”Ÿäº§å…¬å¸ï¼š");
        Art = new JRadioButton("è‰ºæœ¯å…¬å¸", true);
        mint = new JRadioButton("é€ å¸å…¬å¸");
        Art.addItemListener(this);
        mint.addItemListener(this);
        ButtonGroup group = new ButtonGroup();
        group.add(Art);
        group.add(mint);
        SouthJP.add(yl);
        SouthJP.add(Art);
        SouthJP.add(mint);
        this.add("South", SouthJP);
        select = (os.accept(visitor1)).split(" ");    // è·å–äº§å“å
        showPicture(select[0], select[1]);    // æ˜¾ç¤ºäº§å“
    }
    // æ˜¾ç¤ºå›¾ç‰‡
    void showPicture(String Cuprum, String paper) {
        CenterJP.removeAll();    // æ¸…é™¤é¢æ¿å†…å®¹
        CenterJP.repaint();    // åˆ·æ–°å±å¹•
        String FileName1 = "src/visitor/Picture/" + Cuprum + ".jpg";
        String FileName2 = "src/visitor/Picture/" + paper + ".jpg";
        JLabel lb = new JLabel(new ImageIcon(FileName1), JLabel.CENTER);
        JLabel rb = new JLabel(new ImageIcon(FileName2), JLabel.CENTER);
        CenterJP.add(lb);
        CenterJP.add(rb);
        this.setVisible(true);
        this.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    }
    @Override
    public void itemStateChanged(ItemEvent arg0) {
        JRadioButton jc = (JRadioButton) arg0.getSource();
        if (jc.isSelected()) {
            if (jc.getText() == "é€ å¸å…¬å¸") {
                select = (os.accept(visitor2)).split(" ");
            } else {
                select = (os.accept(visitor1)).split(" ");
            }
            showPicture(select[0], select[1]);    // æ˜¾ç¤ºé€‰æ‹©çš„äº§å“
        }
    }
}
// æŠ½è±¡è®¿é—®è€…:å…¬å¸
interface Company {
    String create(Paper element);
    String create(Cuprum element);
}
// å…·ä½“è®¿é—®è€…ï¼šè‰ºæœ¯å…¬å¸
class ArtCompany implements Company {
    public String create(Paper element) {
        return "è®²å­¦å›¾";
    }
    public String create(Cuprum element) {
        return "æœ±ç†¹é“œåƒ";
    }
}
// å…·ä½“è®¿é—®è€…ï¼šé€ å¸å…¬å¸
class Mint implements Company {
    public String create(Paper element) {
        return "çº¸å¸";
    }
    public String create(Cuprum element) {
        return "é“œå¸";
    }
}
// æŠ½è±¡å…ƒç´ ï¼šææ–™
interface Material {
    String accept(Company visitor);
}
// å…·ä½“å…ƒç´ ï¼šçº¸
class Paper implements Material {
    public String accept(Company visitor) {
        return (visitor.create(this));
    }
}
// å…·ä½“å…ƒç´ ï¼šé“œ
class Cuprum implements Material {
    public String accept(Company visitor) {
        return (visitor.create(this));
    }
}
// å¯¹è±¡ç»“æ„è§’è‰²:ææ–™é›†
class SetMaterial {
    private List<Material> list = new ArrayList<Material>();
    public String accept(Company visitor) {
        Iterator<Material> i = list.iterator();
        String tmp = "";
        while (i.hasNext()) {
            tmp += ((Material) i.next()).accept(visitor) + " ";
        }
        return tmp; // è¿”å›æŸå…¬å¸çš„ä½œå“é›†
    }
    public void add(Material element) {
        list.add(element);
    }
    public void remove(Material element) {
        list.remove(element);
    }
}
```

ç¨‹åºè¿è¡Œç»“æœå¦‚å›¾æ‰€ç¤ºï¼š

{% asset_img 3.jpg %}

{% asset_img 4.jpg %}

***

### æ¨¡å¼çš„åº”ç”¨åœºæ™¯

å½“ç³»ç»Ÿä¸­å­˜åœ¨ç±»å‹æ•°é‡ç¨³å®šï¼ˆå›ºå®šï¼‰çš„ä¸€ç±»æ•°æ®ç»“æ„æ—¶ï¼Œå¯ä»¥ä½¿ç”¨è®¿é—®è€…æ¨¡å¼æ–¹ä¾¿åœ°å®ç°å¯¹è¯¥ç±»å‹æ‰€æœ‰æ•°æ®ç»“æ„çš„ä¸åŒæ“ä½œï¼Œè€Œåˆä¸ä¼šå¯¹æ•°æ®äº§ç”Ÿä»»ä½•å‰¯ä½œç”¨ï¼ˆè„æ•°æ®ï¼‰ã€‚

ç®€è€Œè¨€ä¹‹ï¼Œå°±æ˜¯å½“å¯¹é›†åˆä¸­çš„ä¸åŒç±»å‹æ•°æ®ï¼ˆç±»å‹æ•°é‡ç¨³å®šï¼‰è¿›è¡Œå¤šç§æ“ä½œæ—¶ï¼Œä½¿ç”¨è®¿é—®è€…æ¨¡å¼ã€‚

é€šå¸¸åœ¨ä»¥ä¸‹æƒ…å†µå¯ä»¥è€ƒè™‘ä½¿ç”¨è®¿é—®è€…ï¼ˆVisitorï¼‰æ¨¡å¼ï¼š
1. å¯¹è±¡ç»“æ„ç›¸å¯¹ç¨³å®šï¼Œä½†å…¶æ“ä½œç®—æ³•ç»å¸¸å˜åŒ–çš„ç¨‹åºã€‚
2. å¯¹è±¡ç»“æ„ä¸­çš„å¯¹è±¡éœ€è¦æä¾›å¤šç§ä¸åŒä¸”ä¸ç›¸å…³çš„æ“ä½œï¼Œè€Œä¸”è¦é¿å…è®©è¿™äº›æ“ä½œçš„å˜åŒ–å½±å“å¯¹è±¡çš„ç»“æ„ã€‚
3. å¯¹è±¡ç»“æ„åŒ…å«å¾ˆå¤šç±»å‹çš„å¯¹è±¡ï¼Œå¸Œæœ›å¯¹è¿™äº›å¯¹è±¡å®æ–½ä¸€äº›ä¾èµ–äºå…¶å…·ä½“ç±»å‹çš„æ“ä½œã€‚

***

### æ¨¡å¼çš„æ‰©å±•

è®¿é—®è€…ï¼ˆVisitorï¼‰æ¨¡å¼æ˜¯ä½¿ç”¨é¢‘ç‡è¾ƒé«˜çš„ä¸€ç§è®¾è®¡æ¨¡å¼ï¼Œå®ƒå¸¸å¸¸åŒä»¥ä¸‹ä¸¤ç§è®¾è®¡æ¨¡å¼è”ç”¨ï¼š

1. ä¸â€œè¿­ä»£å™¨æ¨¡å¼â€è”ç”¨ã€‚å› ä¸ºè®¿é—®è€…æ¨¡å¼ä¸­çš„â€œå¯¹è±¡ç»“æ„â€æ˜¯ä¸€ä¸ªåŒ…å«å…ƒç´ è§’è‰²çš„å®¹å™¨ï¼Œå½“è®¿é—®è€…éå†å®¹å™¨ä¸­çš„æ‰€æœ‰å…ƒç´ æ—¶ï¼Œå¸¸å¸¸è¦ç”¨è¿­ä»£å™¨ã€‚å¦‚ã€ä¾‹1ã€‘ä¸­çš„å¯¹è±¡ç»“æ„æ˜¯ç”¨ List å®ç°çš„ï¼Œå®ƒé€šè¿‡ List å¯¹è±¡çš„ Iterator() æ–¹æ³•è·å–è¿­ä»£å™¨ã€‚å¦‚æœå¯¹è±¡ç»“æ„ä¸­çš„èšåˆç±»æ²¡æœ‰æä¾›è¿­ä»£å™¨ï¼Œä¹Ÿå¯ä»¥ç”¨è¿­ä»£å™¨æ¨¡å¼è‡ªå®šä¹‰ä¸€ä¸ªã€‚

2. è®¿é—®è€…ï¼ˆVisitorï¼‰æ¨¡å¼åŒâ€œç»„åˆæ¨¡å¼â€è”ç”¨ã€‚å› ä¸ºè®¿é—®è€…ï¼ˆVisitorï¼‰æ¨¡å¼ä¸­çš„â€œå…ƒç´ å¯¹è±¡â€å¯èƒ½æ˜¯å¶å­å¯¹è±¡æˆ–è€…æ˜¯å®¹å™¨å¯¹è±¡ï¼Œå¦‚æœå…ƒç´ å¯¹è±¡åŒ…å«å®¹å™¨å¯¹è±¡ï¼Œå°±å¿…é¡»ç”¨åˆ°ç»„åˆæ¨¡å¼ã€‚

{% asset_img 5.gif %}

***

### å‚è€ƒèµ„æ–™

> <http://c.biancheng.net/view/1397.html>
