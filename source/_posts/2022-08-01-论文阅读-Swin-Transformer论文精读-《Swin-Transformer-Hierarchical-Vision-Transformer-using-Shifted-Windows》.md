---
title: >-
  è®ºæ–‡é˜…è¯»-Swin Transformerè®ºæ–‡ç²¾è¯»-ã€ŠSwin Transformer: Hierarchical Vision Transformer
  using Shifted Windowsã€‹
categories:
  - ğŸŒ™è¿›é˜¶å­¦ä¹ 
  - â­è®ºæ–‡é˜…è¯»
  - ğŸ’«ç²¾è¯»ç»å…¸
abbrlink: 7b9e85bd
date: 2022-08-01 05:37:27
tags:
---

### åŸæ–‡

{% pdf ./file/paper/2021-Swin-Transformer-Hierarchical-Vision-Transformer-using-Shifted-Windows.pdf %}

è®ºæ–‡é“¾æ¥ï¼š<https://arxiv.org/pdf/2103.14030.pdf>

<!--more-->

<iframe src="//player.bilibili.com/player.html?aid=850677660&bvid=BV13L4y1475U&cid=483320545&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"> </iframe>

***

### æ€»è§ˆ

Swin Transformer æ˜¯ ICCV 21 çš„æœ€ä½³è®ºæ–‡ï¼Œå®ƒä¹‹æ‰€ä»¥èƒ½æœ‰è¿™ä¹ˆå¤§çš„å½±å“åŠ›ä¸»è¦æ˜¯å› ä¸ºåœ¨ ViT ä¹‹åï¼ŒSwin Transformer é€šè¿‡åœ¨ä¸€ç³»åˆ—è§†è§‰ä»»åŠ¡ä¸Šçš„å¼ºå¤§è¡¨ç°Â ï¼Œè¿›ä¸€æ­¥è¯æ˜äº† Transformer æ˜¯å¯ä»¥åœ¨è§†è§‰é¢†åŸŸå–å¾—å¹¿æ³›åº”ç”¨çš„

Swin Transformer æ˜¯ 3 æœˆä»½ä¼ åˆ° arxiv ä¸Šçš„ï¼Œ4 æœˆä»½ä»£ç åº“å°±æ”¾å‡ºæ¥äº†ï¼Œç´§æ¥ç€ 5 æœˆ 12 å·åˆæ”¾å‡ºæ¥äº†è‡ªç›‘ç£ç‰ˆæœ¬çš„ Swin Transformer--mobyï¼Œå…¶å®å°±æ˜¯æŠŠ MoCo çš„å‰ä¸¤ä¸ªå­—æ¯å’Œ BYOL çš„å‰ä¸¤ä¸ªå­—æ¯åˆåœ¨äº†ä¸€èµ·ï¼Œä»æ–¹æ³•ä¸Šå’Œæ€§èƒ½ä¸Šå…¶å®å’Œ MoCo v3 å’Œ DINO éƒ½å·®ä¸å¤šï¼Œåªæ˜¯æ¢äº†ä¸ªéª¨å¹²ç½‘ç»œï¼Œæ‰€ä»¥åœ¨ä¸Šä¸€ç¯‡å¯¹æ¯”å­¦ä¹ ä¸²è®²ä¸­ä¹Ÿæ²¡æœ‰æè¿™ç¯‡è®ºæ–‡

æ¥ä¸‹æ¥è¿‡äº†ä¸€ä¸ªæœˆï¼ŒSwin Transformer å°±è¢«ç”¨åˆ°äº†è§†é¢‘é¢†åŸŸï¼Œæ¨å‡ºäº† Video-Swin-Transformerï¼Œåœ¨ä¸€ç³»åˆ—æ•°æ®é›†ä¸Šéƒ½å–å¾—äº†éå¸¸å¥½çš„æ•ˆæœ
- æ¯”å¦‚è¯´åœ¨ k-400 è¿™ä¸ªæ•°æ®é›†ä¸Šå°±å·²ç»è¾¾åˆ°äº† 84.9 çš„å‡†ç¡®åº¦

7æœˆåˆçš„æ—¶å€™ï¼Œå› ä¸ºçœ‹åˆ°äº†æœ‰ MLP Mixer è¿™ç¯‡è®ºæ–‡ï¼ŒæŠŠ Swin çš„æ€æƒ³ç”¨åˆ°äº† MLP é‡Œï¼Œæ¨å‡ºäº† Swin MLP

8æœˆåˆçš„æ—¶å€™ï¼ŒæŠŠ Swin Transformer ç”¨åˆ°äº†åŠç›‘ç£çš„ç›®æ ‡æ£€æµ‹é‡Œï¼Œç„¶åå–å¾—äº†éå¸¸å¥½çš„æ•ˆæœ

10æœˆä»½çš„æ—¶å€™è·å¾—äº† ICCV çš„æœ€ä½³è®ºæ–‡å¥–

12æœˆä»½å—åˆ°äº† BEiT å’Œ MAE çš„æ¨åŠ¨ï¼Œç”¨ Swin Transformer åŸºäºæ©ç è‡ªç›‘ç£å­¦ä¹ çš„æ–¹å¼åšäº†ä¸€ä¸ªå« SimMIM çš„è®ºæ–‡

æ‰€ä»¥è¯´åœ¨è¿™å¤§åŠå¹´çš„æ—¶é—´é‡Œï¼ŒåŸä½œè€…å›¢é˜Ÿå°±ä»¥æ¯ä¸ªæœˆä¸€ç¯‡è®ºæ–‡çš„é€Ÿåº¦ï¼ŒåŸºæœ¬æŠŠè§†è§‰é¢†åŸŸæ‰€æœ‰çš„ä»»åŠ¡éƒ½åˆ·äº†ä¸ªéï¼Œè€Œä¸” Swin Transformer ä¸å…‰åº”ç”¨èŒƒå›´å¹¿ï¼Œæ•ˆæœä¹Ÿéå¸¸çš„ç‚¸è£‚

Paperswithcode ç½‘ç«™ä¸Šå¯ä»¥çœ‹åˆ°å®ƒåœ¨æ¯ä¸ªæ•°æ®é›†ä¸Šçš„è¡¨ç°å¦‚ä½•ï¼Œé‰´äº Swin Transformer çš„æå‡ºä¸»è¦æ˜¯ç”¨æ¥åšè§†è§‰çš„ä¸‹æ¸¸ä»»åŠ¡ï¼Œæ‰€ä»¥ä¸»è¦çœ‹ä¸€ä¸‹ COCO å’Œ ADE20K è¿™ä¸¤ä¸ªæ•°æ®é›†ä¸Šçš„è¡¨ç°

{% asset_img 1.png %}

- ä¸Šå›¾å±•ç¤ºäº†å„ç§æ¨¡å‹åœ¨ COCO æ•°æ®é›†ä¸Šçš„è¡¨ç°
- åœ¨ COCO æ•°æ®é›†çš„æ’è¡Œæ¦œä¸Šæ’åç¬¬ä¸€çš„æ˜¯ä¸€ä¸ªå« Swin V2 çš„æ¨¡å‹ï¼Œå…¶å®ä¹Ÿæ˜¯ä½œè€…åŸç­äººé©¬æå‡ºçš„ Version2ï¼Œå°±æ˜¯åšäº†ä¸€ä¸ªæ›´å¤§ç‰ˆæœ¬çš„ Swin Transformerï¼Œæœ‰ 30 äº¿å‚æ•°è€Œä¸”æå‡ºäº†ä¸€ç³»åˆ—æŠ€æœ¯ä½¿å¾— Swin Transformer å¯ä»¥åœ¨ 1536 * 1536 çš„å›¾ç‰‡ä¸Šåšé¢„è®­ç»ƒï¼Œæœ€åä¸‹æ¸¸ä»»åŠ¡çš„æ•ˆæœå°±éå¸¸çš„å¥½ï¼ŒCOCO éƒ½å·²ç»è¢«åˆ·åˆ° 63.1 äº†ï¼ˆå»å¹´å¤§å®¶ç”¨å·ç§¯ç¥ç»ç½‘ç»œçš„æ—¶å€™è¿˜åœ¨ 54ã€55 çš„å‡†ç¡®åº¦ä¸ŠæŒ£æ‰
- æ’åç¬¬äºŒçš„æ˜¯ä¸€ä¸ªå« Florence çš„æ¨¡å‹ï¼Œè¿™æ˜¯ä¸€ä¸ªå¤šæ¨¡æ€çš„å·¥ä½œï¼Œå®ƒé‡Œé¢è´Ÿè´£è§†è§‰çš„é‚£éƒ¨åˆ†ç”¨çš„æ˜¯ä¸€ä¸ªå« CoSwin çš„æ¨¡å‹ï¼Œä¹Ÿæ˜¯ Swin Transformer çš„ä¸€ä¸ªå˜ä½“
- å†å¾€ä¸‹Â GLIP ä¹Ÿæ˜¯ç”¨çš„ Swin largeï¼ŒÂ Soft Teacher ä¹Ÿæ˜¯ Swin largeï¼ŒDyHead ä¹Ÿæ˜¯ Swin largeï¼Œæ€»ä¹‹æ’åå‰åçš„æ–¹æ³•å…¨éƒ½ç”¨åˆ°äº† Swin Transformer

{% asset_img 2.png %}

- ä¸Šå›¾å±•ç¤ºäº†å„ç§æ¨¡å‹åœ¨ ADE20K æ•°æ®é›†ä¸Šçš„è¡¨ç°
- æ’åç¬¬ä¸€çš„è¿˜æ˜¯ Swin V2 ï¼Œå› ä¸ºæ¨¡å‹å®åœ¨æ˜¯å¤ªå¤§äº†
- æ’åäºŒã€ä¸‰ã€å››çš„éƒ½æ˜¯ä¸€ä¸ªå« SeMask çš„è®ºæ–‡ï¼Œä¹Ÿæ˜¯åŸºäº Swin large çš„
- ç¬¬äº”å BEiT ç”¨çš„æ˜¯ ViTï¼Œè€Œä¸æ˜¯ Swin
- ç´§æ¥ç€åé¢æ’å 6ã€7ã€8ã€9 å…¨éƒ½è¿˜æ˜¯ç”¨çš„æ˜¯ Swin Transformer

æ‰€ä»¥è¯´ï¼Œåœ¨ Swin Transformer ä½œè€…å›¢é˜Ÿä¸æ‡ˆçš„åŠªåŠ›ä¸‹ï¼ŒSwin Transformer åœ¨å¤§éƒ¨åˆ†è§†è§‰é¢†åŸŸå¾ˆå¤šæ•°æ®é›†ä¸Šéƒ½å–å¾—äº†æœ€å¥½çš„ç»“æœï¼Œè¿™å°±å¯¼è‡´ Swin Transformer æˆäº†è§†è§‰é¢†åŸŸä¸€ä¸ªç»•ä¸å¼€çš„ Baselineï¼Œæ¥ä¸‹æ¥å†æƒ³åœ¨è¿™äº›æ•°æ®é›†ä¸Šåˆ·åˆ†æˆ–è€…è¯´å†æƒ³å‘è¿™äº›é¢†åŸŸçš„è®ºæ–‡ï¼Œå¤šå¤šå°‘å°‘éƒ½å¾—æåˆ° Swin Transformer æˆ–è€…è·Ÿå®ƒæ¯”ï¼Œæ‰€ä»¥è¯´å®ƒçš„å½±å“åŠ›æ˜¯å·¨å¤§çš„

***

### é¢˜ç›®

Swin Transformer æ˜¯ä¸€ä¸ªç”¨äº†ç§»åŠ¨çª—å£çš„å±‚çº§å¼çš„ Vision Transformer
- Swinï¼šæ¥è‡ªäº Shifted WindowsÂ ï¼ŒS å’Œ winï¼ŒShifted Windowï¼ˆç§»åŠ¨çª—å£ï¼‰ä¹Ÿæ˜¯ Swin Transformer è¿™ç¯‡è®ºæ–‡çš„ä¸»è¦è´¡çŒ®
- å±‚çº§å¼ Hierarchical

å…¶å® Swin Transformer å°±æ˜¯æƒ³è®© Vision Transformer åƒå·ç§¯ç¥ç»ç½‘ç»œä¸€æ ·ï¼Œä¹Ÿèƒ½å¤Ÿåˆ†æˆå‡ ä¸ª blockï¼Œä¹Ÿèƒ½åšå±‚çº§å¼çš„ç‰¹å¾æå–ï¼Œä»è€Œå¯¼è‡´æå‡ºæ¥çš„ç‰¹å¾æœ‰å¤šå°ºåº¦çš„æ¦‚å¿µ

ä½œè€…å›¢é˜Ÿæ¥è‡ª MSRA
- MSRA ç»å¸¸è¢«èª‰ä¸ºæ˜¯ç ”ç©¶è€…çš„é»„åŸ”å†›æ ¡ï¼Œä»é‡Œé¢å‡ºæ¥äº†ä¸€ä¼—å¤§ä½¬ï¼Œè€Œä¸”äº§å‡ºäº†ä¸€ç³»åˆ—éå¸¸æœ‰å½±å“åŠ›çš„å·¥ä½œï¼Œæ¯”å¦‚è¯´å¤§å®¶è€³ç†Ÿèƒ½è¯¦çš„ã€ç°åœ¨å•ç¯‡å¼•ç”¨å·²ç»è¶…è¿‡ 10 ä¸‡çš„ ResNetï¼Œä¹Ÿæ˜¯å››ä½ä½œè€…éƒ½åœ¨ MSRA çš„æ—¶å€™å®Œæˆçš„å·¥ä½œ

***

### æ‘˜è¦

è¿™æ¬¡ç²¾è¯»çš„ç‰ˆæœ¬æ˜¯ä½œè€…åœ¨ 8 æœˆ 17 å·åˆé‡æ–°ä¸Šä¼ çš„ä¸€ä¸ªæ›´æ–°ç‰ˆæœ¬ï¼Œé‡Œé¢çš„å†…å®¹å’Œç»†èŠ‚éƒ½æ›´å¤šä¸€äº›

è¿™ç¯‡è®ºæ–‡æå‡ºäº†ä¸€ä¸ªæ–°çš„ Vision Transformer å«åš Swin Transformerï¼Œå®ƒå¯ä»¥è¢«ç”¨æ¥ä½œä¸ºä¸€ä¸ªè®¡ç®—æœºè§†è§‰é¢†åŸŸä¸€ä¸ªé€šç”¨çš„éª¨å¹²ç½‘ç»œ
- ä¹‹æ‰€ä»¥è¿™ä¹ˆè¯´ï¼Œæ˜¯å› ä¸º ViT åœ¨ç»“è®ºçš„éƒ¨åˆ†æŒ‡å‡ºï¼Œä»–ä»¬é‚£ç¯‡è®ºæ–‡åªæ˜¯åšäº†åˆ†ç±»ä»»åŠ¡ï¼ŒæŠŠä¸‹æ¸¸ä»»åŠ¡æ¯”å¦‚è¯´æ£€æµ‹å’Œåˆ†å‰²ç•™ç»™ä»¥åçš„äººå»æ¢ç´¢ï¼Œæ‰€ä»¥è¯´åœ¨ ViT å‡ºæ¥ä¹‹åï¼Œå¤§å®¶è™½ç„¶çœ‹åˆ°äº† Transformer åœ¨è§†è§‰é¢†åŸŸçš„å¼ºå¤§æ½œåŠ›ï¼Œä½†æ˜¯å¹¶ä¸ç¡®å®š Transformer èƒ½ä¸èƒ½æŠŠæ‰€æœ‰è§†è§‰çš„ä»»åŠ¡éƒ½åšæ‰ï¼Œæ‰€ä»¥ Swin Transformer è¿™ç¯‡è®ºæ–‡çš„ç ”ç©¶åŠ¨æœºå°±æ˜¯æƒ³å‘Šè¯‰å¤§å®¶ç”¨ Transformer æ²¡æ¯›ç—…ï¼Œç»å¯¹èƒ½åœ¨æ–¹æ–¹é¢é¢ä¸Šå–ä»£å·ç§¯ç¥ç»ç½‘ç»œï¼Œæ¥ä¸‹æ¥å¤§å®¶éƒ½ä¸Š Transformer å°±å¥½äº†

ä½†æ˜¯ç›´æ¥æŠŠ Transformer ä» NLP ç”¨åˆ° Vision æ˜¯æœ‰ä¸€äº›æŒ‘æˆ˜çš„ï¼Œè¿™ä¸ªæŒ‘æˆ˜ä¸»è¦æ¥è‡ªäºä¸¤ä¸ªæ–¹é¢
- ä¸€ä¸ªå°±æ˜¯å°ºåº¦ä¸Šçš„é—®é¢˜ã€‚å› ä¸ºæ¯”å¦‚è¯´ç°åœ¨æœ‰ä¸€å¼ è¡—æ™¯çš„å›¾ç‰‡ï¼Œé‡Œé¢æœ‰å¾ˆå¤šè½¦å’Œè¡Œäººï¼Œé‡Œé¢çš„ç‰©ä½“éƒ½å¤§å¤§å°å°ï¼Œé‚£è¿™æ—¶å€™ä»£è¡¨åŒæ ·ä¸€ä¸ªè¯­ä¹‰çš„è¯ï¼Œæ¯”å¦‚è¯´è¡Œäººæˆ–è€…æ±½è½¦å°±æœ‰éå¸¸ä¸åŒçš„å°ºå¯¸ï¼Œè¿™ç§ç°è±¡åœ¨ NLP ä¸­å°±æ²¡æœ‰
- å¦å¤–ä¸€ä¸ªæŒ‘æˆ˜æ˜¯å›¾åƒçš„ resolution å¤ªå¤§äº†ï¼Œå¦‚æœè¦ä»¥åƒç´ ç‚¹ä½œä¸ºåŸºæœ¬å•ä½çš„è¯ï¼Œåºåˆ—çš„é•¿åº¦å°±å˜å¾—é«˜ä¸å¯æ”€ï¼Œæ‰€ä»¥è¯´ä¹‹å‰çš„å·¥ä½œè¦ä¹ˆå°±æ˜¯ç”¨åç»­çš„ç‰¹å¾å›¾æ¥å½“åš Transformer çš„è¾“å…¥ï¼Œè¦ä¹ˆå°±æ˜¯æŠŠå›¾ç‰‡æ‰“æˆ patch å‡å°‘è¿™ä¸ªå›¾ç‰‡çš„ resolutionï¼Œè¦ä¹ˆå°±æ˜¯æŠŠå›¾ç‰‡ç”»æˆä¸€ä¸ªä¸€ä¸ªçš„å°çª—å£ï¼Œç„¶ååœ¨çª—å£é‡Œé¢å»åšè‡ªæ³¨æ„åŠ›ï¼Œæ‰€æœ‰çš„è¿™äº›æ–¹æ³•éƒ½æ˜¯ä¸ºäº†å‡å°‘åºåˆ—é•¿åº¦

åŸºäºè¿™ä¸¤ä¸ªæŒ‘æˆ˜ï¼Œæœ¬æ–‡çš„ä½œè€…å°±æå‡ºäº† hierarchical Transformerï¼Œå®ƒçš„ç‰¹å¾æ˜¯é€šè¿‡ä¸€ç§å«åšç§»åŠ¨çª—å£çš„æ–¹å¼å­¦æ¥çš„
- ç§»åŠ¨çª—å£çš„å¥½å¤„ï¼šä¸ä»…å¸¦æ¥äº†æ›´å¤§çš„æ•ˆç‡ï¼Œå› ä¸ºè·Ÿä¹‹å‰çš„å·¥ä½œä¸€æ ·ï¼Œç°åœ¨è‡ªæ³¨æ„åŠ›æ˜¯åœ¨çª—å£å†…ç®—çš„ï¼Œæ‰€ä»¥è¿™ä¸ªåºåˆ—çš„é•¿åº¦å¤§å¤§çš„é™ä½äº†ï¼›åŒæ—¶é€šè¿‡ shifting ç§»åŠ¨çš„è¿™ä¸ªæ“ä½œï¼Œèƒ½å¤Ÿè®©ç›¸é‚»çš„ä¸¤ä¸ªçª—å£ä¹‹é—´æœ‰äº†äº¤äº’ï¼Œæ‰€ä»¥ä¸Šä¸‹å±‚ä¹‹é—´å°±å¯ä»¥æœ‰ cross-window connectionï¼Œä»è€Œå˜ç›¸çš„è¾¾åˆ°äº†ä¸€ç§å…¨å±€å»ºæ¨¡çš„èƒ½åŠ›

ç„¶åä½œè€…è¯´è¿™ç§å±‚çº§å¼çš„ç»“æ„ä¸ä»…éå¸¸çµæ´»ï¼Œå¯ä»¥æä¾›å„ä¸ªå°ºåº¦çš„ç‰¹å¾ä¿¡æ¯ï¼ŒåŒæ—¶å› ä¸ºè‡ªæ³¨æ„åŠ›æ˜¯åœ¨å°çª—å£ä¹‹å†…ç®—çš„ï¼Œæ‰€ä»¥è¯´å®ƒçš„è®¡ç®—å¤æ‚åº¦æ˜¯éšç€å›¾åƒå¤§å°è€Œçº¿æ€§å¢é•¿ï¼Œè€Œä¸æ˜¯å¹³æ–¹çº§å¢é•¿ï¼Œè¿™å…¶å®ä¹Ÿä¸ºä½œè€…ä¹‹åæå‡º Swin V2 é“ºå¹³äº†é“è·¯ï¼Œä»è€Œè®©ä»–ä»¬å¯ä»¥åœ¨ç‰¹åˆ«å¤§çš„åˆ†è¾¨ç‡ä¸Šå»é¢„è®­ç»ƒæ¨¡å‹

å› ä¸º Swin Transformer æ‹¥æœ‰äº†åƒå·ç§¯ç¥ç»ç½‘ç»œä¸€æ ·åˆ†å±‚çš„ç»“æ„ï¼Œæœ‰äº†è¿™ç§å¤šå°ºåº¦çš„ç‰¹å¾ï¼Œæ‰€ä»¥å®ƒå¾ˆå®¹æ˜“ä½¿ç”¨åˆ°ä¸‹æ¸¸ä»»åŠ¡é‡Œï¼Œæ‰€ä»¥åœ¨è¿™ç¯‡è®ºæ–‡é‡Œï¼Œä½œè€…ä¸å…‰æ˜¯åœ¨ ImageNet-1K ä¸Šåšäº†å®éªŒï¼Œè€Œä¸”è¾¾åˆ°äº†éå¸¸å¥½çš„å‡†ç¡®åº¦ 87.3ï¼›è€Œä¸”è¿˜åœ¨å¯†é›†é¢„æµ‹å‹çš„ä»»åŠ¡ä¸Šï¼Œæ¯”å¦‚è¯´ç‰©ä½“æ£€æµ‹ã€ç‰©ä½“åˆ†å‰²ä¸Šå–å¾—äº†å¾ˆå¥½çš„æˆç»©ï¼Œæ¯”å¦‚è¯´åœ¨ COCO ä¸Šåˆ·åˆ° 58.7 çš„ APï¼Œæ¯”ä¹‹å‰æœ€å¥½çš„æ–¹æ³•é«˜äº† 2.7 ä¸ªç‚¹ï¼›ç„¶ååœ¨è¯­ä¹‰åˆ†å‰²ä¸Šï¼ŒADE ä¸Šä¹Ÿåˆ·åˆ°äº† 53.5ï¼Œæ¯”ä¹‹å‰æœ€å¥½çš„æ–¹æ³•é«˜äº† 3.2 ä¸ªç‚¹

è¿™äº›æ•°æ®é›†å…¶å®éƒ½æ˜¯å¤§å®¶å¸¸åˆ·çš„æ•°æ®é›†ï¼Œåœ¨ä¸Šé¢å¾€å¾€åªè¦èƒ½æå‡ä¸€ä¸ªç‚¹ï¼Œç”šè‡³å¯èƒ½ä¸åˆ°ä¸€ä¸ªç‚¹ï¼Œåªè¦æ•…äº‹è®²çš„å¥½å¯èƒ½éƒ½èƒ½å‘è®ºæ–‡ï¼Œä½†æ˜¯ Swin Transformer éƒ½æçš„å¤§æ¦‚ 3 ä¸ªç‚¹ï¼Œæå‡æ˜¯ç›¸å½“æ˜¾è‘—çš„ï¼Œæ‰€ä»¥ä½œè€…è¯´è¿™ç§åŸºäº Transformer çš„æ¨¡å‹åœ¨è§†è§‰é¢†åŸŸæ˜¯éå¸¸æœ‰æ½œåŠ›çš„

ä¸ºäº†å‡¸æ˜¾è¿™ç¯‡æ–‡ç« çš„è´¡çŒ®ï¼Œä¹Ÿå°±æ˜¯ Shifted Windows ç§»åŠ¨çª—å£çš„ä½œç”¨ï¼Œè¿™ä¸ªç‰ˆæœ¬åˆåŠ äº†ä¸€å¥è¯ï¼šå¯¹äº MLP çš„æ¶æ„ç”¨ shift window çš„æ–¹æ³•ä¹Ÿèƒ½æå‡ï¼Œè¿™å¥è¯å…¶å®è¿™ä¸ªç‰ˆæœ¬æ‰åŠ å…¥çš„ï¼Œä¹‹å‰ç¬¬ä¸€ä¸ªç‰ˆæœ¬å°±æ˜¯æŠ•ç¨¿ä¸Šé‚£ç¯‡è®ºæ–‡å…¶å®æ²¡æœ‰è¿™å¥è¯ï¼Œå› ä¸ºå½“æ—¶è¿˜æ²¡æœ‰ MLP Mixer è¿™ç¯‡è®ºæ–‡

***

### å¼•è¨€

å¼•è¨€çš„å‰ä¸¤æ®µå…¶å®è·Ÿ ViT éå¸¸ä¸€è‡´ï¼Œéƒ½æ˜¯å…ˆè¯´åœ¨è§†è§‰é¢†åŸŸï¼Œä¹‹å‰å·ç§¯ç¥ç»ç½‘ç»œæ˜¯ä¸»å¯¼åœ°ä½ï¼Œä½†æ˜¯ Transformer åœ¨ NLP é¢†åŸŸç”¨çš„è¿™ä¹ˆå¥½ï¼Œæ‰€ä»¥ä¹Ÿæƒ³æŠŠ Transformer ç”¨åˆ°è§†è§‰é¢†åŸŸé‡Œé¢

ä½†å› ä¸º ViT å·²ç»æŠŠè¿™ä»¶äº‹å¹²äº†ï¼Œæ‰€ä»¥è¯´ Swin Transformer åœ¨ç¬¬ä¸‰æ®µçš„å¼€å§‹è¯´ä»–ä»¬çš„ç ”ç©¶åŠ¨æœºï¼Œæ˜¯æƒ³è¯æ˜ Transformer æ˜¯å¯ä»¥ç”¨ä½œä¸€ä¸ªé€šç”¨çš„éª¨å¹²ç½‘ç»œï¼Œå°±æ˜¯å¯¹æ‰€æœ‰è§†è§‰çš„ä»»åŠ¡ï¼Œä¸å…‰æ˜¯åˆ†ç±»ï¼Œåœ¨æ£€æµ‹ã€åˆ†å‰²è§†é¢‘ä¸Šä¹Ÿéƒ½èƒ½å–å¾—å¾ˆå¥½çš„æ•ˆæœ

{% asset_img 3.png %}

- å›¾ä¸€å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œä½œè€…å…ˆè¯´äº†ä¸€ä¸‹ Vision Transformerï¼ŒæŠŠå®ƒæ”¾åœ¨å³è¾¹åšå¯¹æ¯”
- Vision Transformer å°±æ˜¯æŠŠå›¾ç‰‡æ‰“æˆ patchï¼Œå› ä¸º ViT é‡Œç”¨çš„ patch size æ˜¯ 16 * 16 çš„ï¼Œæ‰€ä»¥è¯´è¿™é‡Œçš„ 16 Ã—ï¼Œä¹Ÿå°±æ„å‘³ç€æ˜¯ 16 å€çš„ä¸‹é‡‡æ ·ç‡ï¼Œè¿™ä¹Ÿå°±æ„å‘³ç€æ¯ä¸€ä¸ª patchï¼Œä¹Ÿå°±æ˜¯æ¯ä¸€ä¸ª tokenï¼Œè‡ªå§‹è‡³ç»ˆä»£è¡¨çš„å°ºå¯¸éƒ½æ˜¯å·®ä¸å¤šçš„ï¼›æ¯ä¸€å±‚çš„ Transformer block çœ‹åˆ° token çš„å°ºå¯¸éƒ½æ˜¯ 16 å€ä¸‹é‡‡æ ·ç‡ã€‚è™½ç„¶å®ƒå¯ä»¥é€šè¿‡è¿™ç§å…¨å±€çš„è‡ªæ³¨æ„åŠ›æ“ä½œï¼Œè¾¾åˆ°å…¨å±€çš„å»ºæ¨¡èƒ½åŠ›ï¼Œä½†æ˜¯å®ƒå¯¹å¤šå°ºå¯¸ç‰¹å¾çš„æŠŠæ¡å°±ä¼šå¼±ä¸€äº›
- å¯¹äºè§†è§‰ä»»åŠ¡ï¼Œå°¤å…¶æ˜¯ä¸‹æ¸¸ä»»åŠ¡æ¯”å¦‚è¯´æ£€æµ‹å’Œåˆ†å‰²æ¥è¯´ï¼Œå¤šå°ºå¯¸çš„ç‰¹å¾æ˜¯è‡³å…³é‡è¦çš„ï¼Œæ¯”å¦‚è¯´å¯¹ç›®æ ‡æ£€æµ‹è€Œè¨€ï¼Œè¿ç”¨æœ€å¹¿çš„ä¸€ä¸ªæ–¹æ³•å°±æ˜¯ FPNï¼ˆa feature pyramid networkï¼šå½“æœ‰ä¸€ä¸ªåˆ†å±‚å¼çš„å·ç§¯ç¥ç»ç½‘ç»œä¹‹åï¼Œæ¯ä¸€ä¸ªå·ç§¯å±‚å‡ºæ¥çš„ç‰¹å¾çš„ receptive fieldï¼ˆæ„Ÿå—é‡ï¼‰æ˜¯ä¸ä¸€æ ·çš„ï¼Œèƒ½æŠ“ä½ç‰©ä½“ä¸åŒå°ºå¯¸çš„ç‰¹å¾ï¼Œä»è€Œèƒ½å¤Ÿå¾ˆå¥½çš„å¤„ç†ç‰©ä½“ä¸åŒå°ºå¯¸çš„é—®é¢˜ï¼›å¯¹äºç‰©ä½“åˆ†å‰²ä»»åŠ¡æ¥è¯´ï¼Œé‚£æœ€å¸¸è§çš„ä¸€ä¸ªç½‘ç»œå°±æ˜¯ UNetï¼ŒUNet é‡Œä¸ºäº†å¤„ç†ç‰©ä½“ä¸åŒå°ºå¯¸çš„é—®é¢˜ï¼Œæå‡ºæ¥ä¸€ä¸ªå«åš skip connection çš„æ–¹æ³•ï¼Œå½“ä¸€ç³»åˆ—ä¸‹é‡‡æ ·åšå®Œä»¥åï¼Œå»åšä¸Šé‡‡æ ·çš„æ—¶å€™ï¼Œä¸å…‰æ˜¯ä» bottleneck é‡Œå»æ‹¿ç‰¹å¾ï¼Œè¿˜ä»ä¹‹å‰ä¹Ÿå°±æ˜¯æ¯æ¬¡ä¸‹é‡‡æ ·å®Œä¹‹åçš„ä¸œè¥¿é‡Œå»æ‹¿ç‰¹å¾ï¼Œè¿™æ ·å°±æŠŠé‚£äº›é«˜é¢‘ç‡çš„å›¾åƒç»†èŠ‚åˆå…¨éƒ½èƒ½æ¢å¤å‡ºæ¥äº†ï¼Œå½“ç„¶åˆ†å‰²é‡Œå¤§å®¶å¸¸ç”¨çš„ç½‘ç»œç»“æ„è¿˜æœ‰ PspNetã€DeepLabï¼Œè¿™äº›å·¥ä½œé‡Œä¹Ÿæœ‰ç›¸åº”çš„å¤„ç†å¤šå°ºå¯¸çš„æ–¹æ³•ï¼Œæ¯”å¦‚è¯´ä½¿ç”¨ç©ºæ´å·ç§¯ã€ä½¿ç”¨ psp å’Œ aspp å±‚
- æ€»ä¹‹ï¼Œå¯¹äºè®¡ç®—æœºè§†è§‰çš„ä¸‹æ¸¸ä»»åŠ¡ï¼Œå°¤å…¶æ˜¯å¯†é›†é¢„æµ‹å‹çš„ä»»åŠ¡ï¼ˆæ£€æµ‹ã€åˆ†å‰²ï¼‰ï¼Œæœ‰å¤šå°ºå¯¸çš„ç‰¹å¾æ˜¯è‡³å…³é‡è¦çš„

ä½†æ˜¯åœ¨ ViT é‡Œå¤„ç†çš„ç‰¹å¾éƒ½æ˜¯å•ä¸€å°ºå¯¸ï¼Œè€Œä¸”æ˜¯ low resolutionï¼Œä¹Ÿå°±æ˜¯è¯´è‡ªå§‹è‡³ç»ˆéƒ½æ˜¯å¤„ç†çš„ 16 å€ä¸‹é‡‡æ ·ç‡è¿‡åçš„ç‰¹å¾ï¼Œæ‰€ä»¥è¯´ï¼Œå®ƒå¯èƒ½å°±ä¸é€‚åˆå¤„ç†è¿™ç§å¯†é›†é¢„æµ‹å‹çš„ä»»åŠ¡ï¼ŒåŒæ—¶å¯¹ ViT è€Œè¨€ï¼Œè‡ªæ³¨æ„åŠ›å§‹ç»ˆéƒ½æ˜¯åœ¨æœ€å¤§çš„çª—å£ä¸Šè¿›è¡Œï¼Œä¹Ÿå°±æ˜¯è¯´å§‹ç»ˆéƒ½æ˜¯åœ¨æ•´å›¾ä¸Šè¿›è¡Œçš„ï¼Œæ‰€ä»¥å®ƒæ˜¯ä¸€ä¸ªå…¨å±€å»ºæ¨¡ï¼Œå®ƒçš„å¤æ‚åº¦æ˜¯è·Ÿéšå›¾åƒçš„å°ºå¯¸è¿›è¡Œå¹³æ–¹å€çš„å¢é•¿ï¼Œåƒæ£€æµ‹å’Œåˆ†å‰²é¢†åŸŸï¼Œä¸€èˆ¬ç°åœ¨å¸¸ç”¨çš„è¾“å…¥å°ºå¯¸éƒ½æ˜¯ 800 * 800 æˆ–è€… 1000 * 1000ï¼Œä¹‹å‰è™½ç„¶ç”¨ patch size 16 èƒ½å¤„ç† 224 * 224 çš„å›¾ç‰‡ï¼Œä½†æ˜¯å½“å›¾ç‰‡å˜åˆ°è¿™ä¹ˆå¤§çš„æ—¶å€™ï¼Œå³ä½¿ç”¨ patch size 16ï¼Œåºåˆ—é•¿åº¦è¿˜æ˜¯ä¼šä¸Šåƒï¼Œè®¡ç®—å¤æ‚åº¦è¿˜æ˜¯éš¾ä»¥æ‰¿å—çš„

æ‰€ä»¥åŸºäºè¿™äº›æŒ‘æˆ˜ï¼Œä½œè€…æå‡ºäº† Swin Transformerï¼ŒSwin Transformer å…¶å®æ˜¯å€Ÿé‰´äº†å¾ˆå¤šå·ç§¯ç¥ç»ç½‘ç»œçš„è®¾è®¡ç†å¿µä»¥åŠå…ˆéªŒçŸ¥è¯†
- æ¯”å¦‚è¯´ä¸ºäº†å‡å°‘åºåˆ—çš„é•¿åº¦ã€é™ä½è®¡ç®—å¤æ‚åº¦ï¼ŒSwin Transformer é‡‡å–äº†åœ¨å°çª—å£ä¹‹å†…ç®—è‡ªæ³¨æ„åŠ›ï¼Œè€Œä¸æ˜¯åƒ ViT ä¸€æ ·åœ¨æ•´å›¾ä¸Šç®—è‡ªæ³¨æ„åŠ›ï¼Œè¿™æ ·åªè¦çª—å£å¤§å°æ˜¯å›ºå®šçš„ï¼Œè‡ªæ³¨æ„åŠ›çš„è®¡ç®—å¤æ‚åº¦å°±æ˜¯å›ºå®šçš„ï¼Œæ•´å¼ å›¾çš„è®¡ç®—å¤æ‚åº¦å°±ä¼šè·Ÿå›¾ç‰‡çš„å¤§å°è€Œæˆçš„çº¿æ€§å¢é•¿å…³ç³»ï¼Œå°±æ˜¯è¯´å›¾ç‰‡å¢å¤§äº† x å€ï¼Œçª—å£æ•°é‡ä¹Ÿå¢å¤§äº† x å€ï¼Œè®¡ç®—å¤æ‚åº¦ä¹Ÿå°±ä¹˜ä»¥ xï¼Œè€Œä¸æ˜¯ä¹˜ä»¥ x çš„å¹³æ–¹
- è¿™ä¸ªå°±ç®—æ˜¯åˆ©ç”¨äº†å·ç§¯ç¥ç»ç½‘ç»œé‡Œçš„ Locality çš„ Inductive biasï¼Œå°±æ˜¯åˆ©ç”¨äº†å±€éƒ¨æ€§çš„å…ˆéªŒçŸ¥è¯†ï¼ŒåŒä¸€ä¸ªç‰©ä½“çš„ä¸åŒéƒ¨ä½æˆ–è€…è¯­ä¹‰ç›¸è¿‘çš„ä¸åŒç‰©ä½“è¿˜æ˜¯å¤§æ¦‚ç‡ä¼šå‡ºç°åœ¨ç›¸è¿çš„åœ°æ–¹ï¼Œæ‰€ä»¥å³ä½¿æ˜¯åœ¨ä¸€ä¸ª Localï¼Œä¸€ä¸ªå°èŒƒå›´çš„çª—å£ç®—è‡ªæ³¨æ„åŠ›ä¹Ÿæ˜¯å·®ä¸å¤šå¤Ÿç”¨çš„ï¼Œå…¨å±€è®¡ç®—è‡ªæ³¨æ„åŠ›å¯¹äºè§†è§‰ä»»åŠ¡æ¥è¯´ï¼Œå…¶å®æ˜¯æœ‰ç‚¹æµªè´¹èµ„æºçš„
- å¦å¤–ä¸€ä¸ªæŒ‘æˆ˜æ˜¯å¦‚ä½•ç”Ÿæˆå¤šå°ºå¯¸çš„ç‰¹å¾ï¼Œå·ç§¯ç¥ç»ç½‘ç»œä¸ºä»€ä¹ˆä¼šæœ‰å¤šå°ºå¯¸çš„ç‰¹å¾ï¼Ÿä¸»è¦æ˜¯å› ä¸ºæœ‰ Poolingï¼ˆæ± åŒ–ï¼‰è¿™ä¸ªæ“ä½œï¼Œæ± åŒ–èƒ½å¤Ÿå¢å¤§æ¯ä¸€ä¸ªå·ç§¯æ ¸èƒ½çœ‹åˆ°çš„æ„Ÿå—é‡ï¼Œä»è€Œä½¿å¾—æ¯æ¬¡æ± åŒ–è¿‡åçš„ç‰¹å¾æŠ“ä½ç‰©ä½“çš„ä¸åŒå°ºå¯¸ï¼Œæ‰€ä»¥ç±»ä¼¼çš„ Swin Transformer ä¹Ÿæå‡ºæ¥äº†ä¸€ä¸ªç±»ä¼¼äºæ± åŒ–çš„æ“ä½œå«åš patch mergingï¼Œå°±æ˜¯æŠŠç›¸é‚»çš„å° patch åˆæˆä¸€ä¸ªå¤§ patchï¼Œè¿™æ ·åˆå¹¶å‡ºæ¥çš„è¿™ä¸€ä¸ªå¤§ patch å…¶å®å°±èƒ½çœ‹åˆ°ä¹‹å‰å››ä¸ªå° patch çœ‹åˆ°çš„å†…å®¹ï¼Œå®ƒçš„æ„Ÿå—é‡å°±å¢å¤§äº†ï¼ŒåŒæ—¶ä¹Ÿèƒ½æŠ“ä½å¤šå°ºå¯¸çš„ç‰¹å¾

{% asset_img 4.png %}

- æ‰€ä»¥æ‰€ä¸Šå›¾ä¸­å›¾ä¸€å·¦è¾¹æ‰€ç¤ºï¼ŒSwin Transformer åˆšå¼€å§‹çš„ä¸‹é‡‡æ ·ç‡æ˜¯ 4 å€ï¼Œç„¶åå˜æˆäº† 8 å€ã€16 å€ï¼Œä¹‹æ‰€ä»¥åˆšå¼€å§‹æ˜¯ 4Ã— çš„ï¼Œæ˜¯å› ä¸ºæœ€å¼€å§‹çš„ patch æ˜¯ 4 * 4 å¤§å°çš„ï¼Œä¸€æ—¦æœ‰äº†å¤šå°ºå¯¸çš„ç‰¹å¾ä¿¡æ¯ï¼Œæœ‰äº†è¿™ç§ 4xã€8xã€16x çš„ç‰¹å¾å›¾ï¼Œé‚£è‡ªç„¶å°±å¯ä»¥æŠŠè¿™äº›å¤šå°ºå¯¸çš„ç‰¹å¾å›¾è¾“ç»™ä¸€ä¸ª FPNï¼Œä»è€Œå°±å¯ä»¥å»åšæ£€æµ‹äº†
- åŒæ ·çš„é“ç†ï¼Œæœ‰äº†è¿™äº›å¤šå°ºå¯¸çš„ç‰¹å¾å›¾ä»¥åï¼Œä¹Ÿå¯ä»¥æŠŠå®ƒæ‰”ç»™ä¸€ä¸ª UNETï¼Œç„¶åå°±å¯ä»¥å»åšåˆ†å‰²äº†
- æ‰€ä»¥è¿™å°±æ˜¯ä½œè€…åœ¨è¿™ç¯‡è®ºæ–‡é‡Œåå¤å¼ºè°ƒçš„ï¼ŒSwin Transformer æ˜¯èƒ½å¤Ÿå½“åšä¸€ä¸ªé€šç”¨çš„éª¨å¹²ç½‘ç»œçš„ï¼Œä¸å…‰æ˜¯èƒ½åšå›¾åƒåˆ†ç±»ï¼Œè¿˜èƒ½åšå¯†é›†é¢„æµ‹æ€§çš„ä»»åŠ¡

ç¬¬å››æ®µä¸»è¦å°±å¼€å§‹è®² Swin Transformer ä¸€ä¸ªå…³é”®çš„è®¾è®¡å› ç´ â€”â€”â€”â€”ç§»åŠ¨çª—å£çš„æ“ä½œï¼Œå¦‚ä¸‹å›¾ä¸­å›¾äºŒæ‰€ç¤º

{% asset_img 5.png %}

- å¦‚æœåœ¨ Transformer ç¬¬ L å±‚æŠŠè¾“å…¥æˆ–è€…ç‰¹å¾å›¾åˆ†æˆå°çª—å£çš„è¯ï¼Œå°±ä¼šæœ‰æ•ˆçš„é™ä½åºåˆ—é•¿åº¦ï¼Œä»è€Œå‡å°‘è®¡ç®—å¤æ‚åº¦
- å›¾ä¸­æ¯ä¸€ä¸ªç°è‰²çš„å° patch æ˜¯æœ€åŸºæœ¬çš„å…ƒç´ å•å…ƒï¼Œä¹Ÿå°±æ˜¯å›¾ä¸€ä¸­ 4 * 4 çš„ patchï¼›æ¯ä¸ªçº¢è‰²çš„æ¡†æ˜¯ä¸€ä¸ªä¸­å‹çš„è®¡ç®—å•å…ƒï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªçª—å£
- åœ¨ Swin Transformer è¿™ç¯‡è®ºæ–‡é‡Œï¼Œä¸€ä¸ªå°çª—å£é‡Œé¢é»˜è®¤æœ‰ä¸ƒä¸ƒå››åä¹ä¸ªå° patch çš„

**shift çš„æ“ä½œ**

{% asset_img 6.png %}

- å¦‚æœç”¨ä¸€ä¸ªå¤§çš„è“è‰²çš„æ­£æ–¹å½¢æ¥æè¿°æ•´ä½“çš„ç‰¹å¾å›¾ï¼Œå…¶å® shift æ“ä½œå°±æ˜¯å¾€å³ä¸‹è§’çš„æ–¹å‘æ•´ä½“ç§»äº†ä¸¤ä¸ª patchï¼Œä¹Ÿå°±å˜æˆäº†åƒä¸‹å›¾ä¸­å³å›¾çš„æ ¼å¼

{% asset_img 7.png %}

- ç„¶ååœ¨æ–°çš„ç‰¹å¾å›¾é‡ŒæŠŠå®ƒå†æ¬¡åˆ†æˆå››æ–¹æ ¼ï¼Œå¦‚ä¸‹å›¾ä¸­å³å›¾æ‰€ç¤º

{% asset_img 8.png %}

- æœ€å shift å®Œå°±èƒ½å¾—åˆ°ä¸‹å›¾ä¸­çº¢çº¿æ ‡å‡ºçš„ç»“æœäº†

{% asset_img 9.png %}

è¿™æ ·çš„å¥½å¤„æ˜¯çª—å£ä¸çª—å£ä¹‹é—´å¯ä»¥è¿›è¡Œäº’åŠ¨ï¼Œå› ä¸ºå¦‚æœæŒ‰ç…§åŸæ¥çš„æ–¹å¼ï¼Œå°±æ˜¯æ²¡æœ‰ shiftï¼Œè¿™äº›çª—å£ä¹‹é—´éƒ½æ˜¯ä¸é‡å çš„ï¼Œå¦‚æœæ¯æ¬¡è‡ªæ³¨æ„åŠ›çš„æ“ä½œéƒ½åœ¨å°çš„çª—å£é‡Œå¤´è¿›è¡Œäº†ï¼Œæ¯ä¸ªçª—å£é‡Œçš„ patch å°±æ°¸è¿œæ— æ³•æ³¨æ„åˆ°åˆ«çš„çª—å£é‡Œçš„ patch çš„ä¿¡æ¯ï¼Œè¿™å°±è¾¾ä¸åˆ°ä½¿ç”¨ Transformer çš„åˆè¡·
- å› ä¸º Transformer çš„åˆè¡·å°±æ˜¯æ›´å¥½çš„ç†è§£ä¸Šä¸‹æ–‡ï¼Œå¦‚æœçª—å£éƒ½æ˜¯ä¸é‡å çš„ï¼Œé‚£è‡ªæ³¨æ„åŠ›çœŸçš„å°±å˜æˆå­¤ç«‹è‡ªæ³¨æ„åŠ›ï¼Œå°±æ²¡æœ‰å…¨å±€å»ºæ¨¡çš„èƒ½åŠ›
- ä½†å¦‚æœåŠ ä¸Š shift çš„æ“ä½œï¼Œæ¯ä¸ª patch åŸæ¥åªèƒ½è·Ÿå®ƒæ‰€åœ¨çš„çª—å£é‡Œçš„åˆ«çš„ patch è¿›è¡Œäº¤äº’ï¼Œä½†æ˜¯ shift ä¹‹åï¼Œè¿™ä¸ª patch å°±å¯ä»¥è·Ÿæ–°çš„çª—å£é‡Œçš„åˆ«çš„ patch å°±è¿›è¡Œäº¤äº’äº†ï¼Œè€Œè¿™ä¸ªæ–°çš„çª—å£é‡Œæ‰€æœ‰çš„ patch å…¶å®æ¥è‡ªäºä¸Šä¸€å±‚åˆ«çš„çª—å£é‡Œçš„ patchï¼Œè¿™ä¹Ÿå°±æ˜¯ä½œè€…è¯´çš„èƒ½èµ·åˆ° cross-window connectionï¼Œå°±æ˜¯çª—å£å’Œçª—å£ä¹‹é—´å¯ä»¥äº¤äº’äº†

å†é…åˆä¸Šä¹‹åæå‡ºçš„ patch mergingï¼Œåˆå¹¶åˆ° Transformer æœ€åå‡ å±‚çš„æ—¶å€™ï¼Œæ¯ä¸€ä¸ª patch æœ¬èº«çš„æ„Ÿå—é‡å°±å·²ç»å¾ˆå¤§äº†ï¼Œå°±å·²ç»èƒ½çœ‹åˆ°å¤§éƒ¨åˆ†å›¾ç‰‡äº†ï¼Œç„¶åå†åŠ ä¸Šç§»åŠ¨çª—å£çš„æ“ä½œï¼Œå®ƒæ‰€è°“çš„çª—å£å†…çš„å±€éƒ¨æ³¨æ„åŠ›å…¶å®ä¹Ÿå°±å˜ç›¸çš„ç­‰äºæ˜¯ä¸€ä¸ªå…¨å±€çš„è‡ªæ³¨æ„åŠ›æ“ä½œäº†
- è¿™æ ·å°±æ˜¯æ—¢çœå†…å­˜ï¼Œæ•ˆæœä¹Ÿå¥½

ç¬¬äº”æ®µä½œè€…å†æ¬¡å±•ç¤ºäº†ä¸€ä¸‹ç»“æœï¼Œå› ä¸º Swin Transformer çš„ç»“æœç¡®å®éå¸¸å¥½ï¼Œæœ€åä¸€æ®µä½œè€…å°±å±•æœ›äº†ä¸€ä¸‹ï¼Œä½œè€…è¯´ä»–ä»¬åšä¿¡ä¸€ä¸ª CV å’Œ NLP ä¹‹é—´å¤§ä¸€ç»Ÿçš„æ¡†æ¶æ˜¯èƒ½å¤Ÿä¿ƒè¿›ä¸¤ä¸ªé¢†åŸŸå…±åŒå‘å±•çš„
- ç¡®å®å¦‚æ­¤ï¼Œå› ä¸ºäººåœ¨å­¦ä¹ çš„è¿‡ç¨‹ä¸­ä¹Ÿæ˜¯ä¸€ä¸ªå¤šæ¨¡æ€çš„å­¦ä¹ è¿‡ç¨‹ï¼Œä½† Swin Transformer è¿˜æ˜¯åˆ©ç”¨äº†æ›´å¤šè§†è§‰é‡Œçš„å…ˆéªŒçŸ¥è¯†ï¼Œä»è€Œåœ¨è§†è§‰ä»»åŠ¡ä¸Šå¤§æ€å››æ–¹
- ä½†æ˜¯åœ¨æ¨¡å‹å¤§ä¸€ç»Ÿä¸Šï¼Œä¹Ÿå°±æ˜¯ unified architecture ä¸Šæ¥è¯´ï¼Œå…¶å® ViT è¿˜æ˜¯åšçš„æ›´å¥½çš„ï¼Œå› ä¸ºå®ƒçœŸçš„å¯ä»¥ä»€ä¹ˆéƒ½ä¸æ”¹ï¼Œä»€ä¹ˆå…ˆéªŒä¿¡æ¯éƒ½ä¸åŠ ï¼Œå°±èƒ½è®© Transformer åœ¨ä¸¤ä¸ªé¢†åŸŸéƒ½èƒ½ç”¨çš„å¾ˆå¥½ï¼Œè¿™æ ·æ¨¡å‹ä¸ä»…å¯ä»¥å…±äº«å‚æ•°ï¼Œè€Œä¸”ç”šè‡³å¯ä»¥æŠŠæ‰€æœ‰æ¨¡æ€çš„è¾“å…¥ç›´æ¥å°±æ‹¼æ¥èµ·æ¥ï¼Œå½“æˆä¸€ä¸ªå¾ˆé•¿çš„è¾“å…¥ï¼Œç›´æ¥æ‰”ç»™ Transformer å»åšï¼Œè€Œä¸ç”¨è€ƒè™‘æ¯ä¸ªæ¨¡æ€çš„ç‰¹æ€§

***

### ç»“è®º

è¿™ç¯‡è®ºæ–‡æå‡ºäº† Swin Transformerï¼Œå®ƒæ˜¯ä¸€ä¸ªå±‚çº§å¼çš„ Transformerï¼Œè€Œä¸”å®ƒçš„è®¡ç®—å¤æ‚åº¦æ˜¯è·Ÿè¾“å…¥å›¾åƒçš„å¤§å°å‘ˆçº¿æ€§å¢é•¿çš„

Swin Transformerr åœ¨ COCO å’Œ ADE20K ä¸Šçš„æ•ˆæœéƒ½éå¸¸çš„å¥½ï¼Œè¿œè¿œè¶…è¶Šäº†ä¹‹å‰æœ€å¥½çš„æ–¹æ³•ï¼Œæ‰€ä»¥ä½œè€…è¯´åŸºäºæ­¤ï¼Œå¸Œæœ› Swin Transformer èƒ½å¤Ÿæ¿€å‘å‡ºæ›´å¤šæ›´å¥½çš„å·¥ä½œï¼Œå°¤å…¶æ˜¯åœ¨å¤šæ¨¡æ€æ–¹é¢

å› ä¸ºåœ¨ Swin Transformer è¿™ç¯‡è®ºæ–‡é‡Œæœ€å…³é”®çš„ä¸€ä¸ªè´¡çŒ®å°±æ˜¯åŸºäº Shifted Window çš„è‡ªæ³¨æ„åŠ›ï¼Œå®ƒå¯¹å¾ˆå¤šè§†è§‰çš„ä»»åŠ¡ï¼Œå°¤å…¶æ˜¯å¯¹ä¸‹æ¸¸å¯†é›†é¢„æµ‹å‹çš„ä»»åŠ¡æ˜¯éå¸¸æœ‰å¸®åŠ©çš„ï¼Œä½†æ˜¯å¦‚æœ Shifted Window æ“ä½œä¸èƒ½ç”¨åˆ° NLP é¢†åŸŸé‡Œï¼Œå…¶å®åœ¨æ¨¡å‹å¤§ä¸€ç»Ÿä¸Šè®ºæ®å°±ä¸æ˜¯é‚£ä¹ˆå¼ºäº†ï¼Œæ‰€ä»¥ä½œè€…è¯´æ¥ä¸‹æ¥ä»–ä»¬çš„æœªæ¥å·¥ä½œå°±æ˜¯è¦æŠŠ Shifted Windows ç”¨åˆ° NLP é‡Œé¢ï¼Œè€Œä¸”å¦‚æœçœŸçš„èƒ½åšåˆ°è¿™ä¸€ç‚¹ï¼Œé‚£ Swin Transformer çœŸçš„å°±æ˜¯ä¸€ä¸ªé‡Œç¨‹ç¢‘å¼çš„å·¥ä½œäº†ï¼Œè€Œä¸”æ¨¡å‹å¤§ä¸€ç»Ÿçš„æ•…äº‹ä¹Ÿå°±è®²çš„åœ†æ»¡äº†

***

### ç›¸å…³å·¥ä½œ

è·Ÿ ViT çš„ç›¸å…³å·¥ä½œéå¸¸ç›¸ä¼¼ï¼Œä½œè€…å…ˆå¤§æ¦‚è®²äº†ä¸€ä¸‹å·ç§¯ç¥ç»ç½‘ç»œï¼Œç„¶ååˆè®²äº†ä¸€ä¸‹è‡ªæ³¨æ„åŠ›æˆ–è€… Transformer æ˜¯å¦‚ä½•ç”¨æ¥å¸®åŠ©å·ç§¯ç¥ç»ç½‘ç»œçš„ï¼Œæœ€åçº¯ Transformer ç”¨æ¥åšè§†è§‰é‡Œçš„éª¨å¹²ç½‘ç»œ

***

### æ–¹æ³•

ä¸»è¦åˆ†ä¸ºä¸¤å¤§å—
- å¤§æ¦‚æŠŠæ•´ä½“çš„æµç¨‹è®²äº†ä¸€ä¸‹ï¼Œä¸»è¦å°±æ˜¯è¿‡äº†ä¸€ä¸‹å‰å‘è¿‡ç¨‹ï¼Œä»¥åŠæå‡ºçš„ patch merging æ“ä½œæ˜¯æ€ä¹ˆåšçš„
- åŸºäº Shifted Window çš„è‡ªæ³¨æ„åŠ›ï¼ŒSwin Transformer æ€ä¹ˆæŠŠå®ƒå˜æˆä¸€ä¸ª transformer block è¿›è¡Œè®¡ç®—

æ¨¡å‹æ€»è§ˆå›¾å¦‚ä¸‹å›¾æ‰€ç¤º

{% asset_img 10.png %}

***

#### å‰å‘è¿‡ç¨‹

- å‡è®¾è¯´æœ‰ä¸€å¼  224 * 224 * 3ï¼ˆImageNet æ ‡å‡†å°ºå¯¸ï¼‰çš„è¾“å…¥å›¾ç‰‡
- ç¬¬ä¸€æ­¥å°±æ˜¯åƒ ViT é‚£æ ·æŠŠå›¾ç‰‡æ‰“æˆ patchï¼Œåœ¨ Swin Transformer è¿™ç¯‡è®ºæ–‡é‡Œï¼Œå®ƒçš„ patch size æ˜¯ 4 * 4ï¼Œè€Œä¸æ˜¯åƒ ViT ä¸€æ · 16 * 16ï¼Œæ‰€ä»¥è¯´å®ƒç»è¿‡ patch partitionÂ æ‰“æˆ patch ä¹‹åï¼Œå¾—åˆ°å›¾ç‰‡çš„å°ºå¯¸æ˜¯ 56 * 56 * 48ï¼Œ56 å°±æ˜¯ 224 / 4ï¼Œå› ä¸º patch size æ˜¯ 4ï¼Œå‘é‡çš„ç»´åº¦ 48ï¼Œå› ä¸º 4 * 4 * 3ï¼Œ3 æ˜¯å›¾ç‰‡çš„ RGB é€šé“
- æ‰“å®Œäº† patch ï¼Œæ¥ä¸‹æ¥å°±è¦åš Linear Embeddingï¼Œä¹Ÿå°±æ˜¯è¯´è¦æŠŠå‘é‡çš„ç»´åº¦å˜æˆä¸€ä¸ªé¢„å…ˆè®¾ç½®å¥½çš„å€¼ï¼Œå°±æ˜¯ Transformer èƒ½å¤Ÿæ¥å—çš„å€¼ï¼Œåœ¨ Swin Transformer çš„è®ºæ–‡é‡ŒæŠŠè¿™ä¸ªè¶…å‚æ•°è®¾ä¸º cï¼Œå¯¹äº Swin tiny ç½‘ç»œæ¥è¯´ï¼Œä¹Ÿå°±æ˜¯ä¸Šå›¾ä¸­ç”»çš„ç½‘ç»œæ€»è§ˆå›¾ï¼Œå®ƒçš„ c æ˜¯ 96ï¼Œæ‰€ä»¥ç»å†å®Œ Linear Embedding ä¹‹åï¼Œè¾“å…¥çš„å°ºå¯¸å°±å˜æˆäº† 56 * 56 * 96ï¼Œå‰é¢çš„ 56 * 56 å°±ä¼šæ‹‰ç›´å˜æˆ 3136ï¼Œå˜æˆäº†åºåˆ—é•¿åº¦ï¼Œåé¢çš„ 96 å°±å˜æˆäº†æ¯ä¸€ä¸ª token å‘é‡çš„ç»´åº¦ï¼Œå…¶å® Patch Partition å’Œ Linear Embedding å°±ç›¸å½“äºæ˜¯ ViT é‡Œçš„ Patch Projection æ“ä½œï¼Œè€Œåœ¨ä»£ç é‡Œä¹Ÿæ˜¯ç”¨ä¸€æ¬¡å·ç§¯æ“ä½œå°±å®Œæˆäº†
- ç¬¬ä¸€éƒ¨åˆ†è·Ÿ ViT å…¶å®è¿˜æ˜¯æ²¡æœ‰åŒºåˆ«çš„ï¼Œä½†ç´§æ¥ç€åŒºåˆ«å°±æ¥äº†
- é¦–å…ˆåºåˆ—é•¿åº¦æ˜¯ 3136ï¼Œå¯¹äº ViT æ¥è¯´ï¼Œç”¨ patch size 16 * 16ï¼Œå®ƒçš„åºåˆ—é•¿åº¦å°±åªæœ‰ 196ï¼Œæ˜¯ç›¸å¯¹çŸ­å¾ˆå¤šçš„ï¼Œè¿™é‡Œçš„ 3136 å°±å¤ªé•¿äº†ï¼Œæ˜¯ç›®å‰æ¥è¯´ Transformer ä¸èƒ½æ¥å—çš„åºåˆ—é•¿åº¦ï¼Œæ‰€ä»¥ Swin Transformer å°±å¼•å…¥äº†åŸºäºçª—å£çš„è‡ªæ³¨æ„åŠ›è®¡ç®—ï¼Œæ¯ä¸ªçª—å£æŒ‰ç…§é»˜è®¤æ¥è¯´ï¼Œéƒ½åªæœ‰ä¸ƒä¸ƒå››åä¹ä¸ª patchï¼Œæ‰€ä»¥è¯´åºåˆ—é•¿åº¦å°±åªæœ‰ 49 å°±ç›¸å½“å°äº†ï¼Œè¿™æ ·å°±è§£å†³äº†è®¡ç®—å¤æ‚åº¦çš„é—®é¢˜
- æ‰€ä»¥ä¹Ÿå°±æ˜¯è¯´ï¼Œstage1 ä¸­çš„ swin transformer block æ˜¯åŸºäºçª—å£è®¡ç®—è‡ªæ³¨æ„åŠ›çš„ï¼Œç°åœ¨æš‚æ—¶å…ˆæŠŠ transformer block å½“æˆæ˜¯ä¸€ä¸ªé»‘ç›’ï¼Œåªå…³æ³¨è¾“å…¥å’Œè¾“å‡ºçš„ç»´åº¦ï¼Œå¯¹äº Transformer æ¥è¯´ï¼Œå¦‚æœä¸å¯¹å®ƒåšæ›´å¤šçº¦æŸçš„è¯ï¼ŒTransformer è¾“å…¥çš„åºåˆ—é•¿åº¦æ˜¯å¤šå°‘ï¼Œè¾“å‡ºçš„åºåˆ—é•¿åº¦ä¹Ÿæ˜¯å¤šå°‘ï¼Œå®ƒçš„è¾“å…¥è¾“å‡ºçš„å°ºå¯¸æ˜¯ä¸å˜çš„ï¼Œæ‰€ä»¥è¯´åœ¨ stage1 ä¸­ç»è¿‡ä¸¤å±‚ Swin Transformer block ä¹‹åï¼Œè¾“å‡ºè¿˜æ˜¯ 56 * 56 * 96
- åˆ°è¿™å…¶å® Swin Transformer çš„ç¬¬ä¸€ä¸ªé˜¶æ®µå°±èµ°å®Œäº†ï¼Œä¹Ÿå°±æ˜¯å…ˆè¿‡ä¸€ä¸ª Patch Projection å±‚ï¼Œç„¶åå†è¿‡ä¸€äº› Swin Transformer blockï¼Œæ¥ä¸‹æ¥å¦‚æœæƒ³è¦æœ‰å¤šå°ºå¯¸çš„ç‰¹å¾ä¿¡æ¯ï¼Œå°±è¦æ„å»ºä¸€ä¸ªå±‚çº§å¼çš„ transformerï¼Œä¹Ÿå°±æ˜¯è¯´éœ€è¦ä¸€ä¸ªåƒå·ç§¯ç¥ç»ç½‘ç»œé‡Œä¸€æ ·ï¼Œæœ‰ä¸€ä¸ªç±»ä¼¼äºæ± åŒ–çš„æ“ä½œ

è¿™ç¯‡è®ºæ–‡é‡Œä½œè€…å°±æå‡º Patch Merging çš„æ“ä½œï¼ŒPatch Merging å…¶å®åœ¨ä¹‹å‰ä¸€äº›å·¥ä½œé‡Œä¹Ÿæœ‰ç”¨åˆ°ï¼Œå®ƒå¾ˆåƒ Pixel Shuffle çš„ä¸Šé‡‡æ ·çš„ä¸€ä¸ªåè¿‡ç¨‹ï¼ŒPixel Shuffle æ˜¯ lower level ä»»åŠ¡ä¸­å¾ˆå¸¸ç”¨çš„ä¸€ä¸ªä¸Šé‡‡æ ·æ–¹å¼

**Patch Merging** æ“ä½œä¸¾ä¾‹å¦‚ä¸‹å›¾æ‰€ç¤º

{% asset_img 11.png %}

- å‡å¦‚æœ‰ä¸€ä¸ªå¼ é‡ï¼ŒPatch Merging é¡¾åæ€ä¹‰å°±æ˜¯æŠŠä¸´è¿‘çš„å° patchÂ åˆå¹¶æˆä¸€ä¸ªå¤§ patchï¼Œè¿™æ ·å°±å¯ä»¥èµ·åˆ°ä¸‹é‡‡æ ·ä¸€ä¸ªç‰¹å¾å›¾çš„æ•ˆæœäº†
- è¿™é‡Œå› ä¸ºæ˜¯æƒ³ä¸‹é‡‡æ ·ä¸¤å€ï¼Œæ‰€ä»¥è¯´åœ¨é€‰ç‚¹çš„æ—¶å€™æ˜¯æ¯éš”ä¸€ä¸ªç‚¹é€‰ä¸€ä¸ªï¼Œä¹Ÿå°±æ„å‘³ç€è¯´å¯¹äºè¿™ä¸ªå¼ é‡æ¥è¯´ï¼Œæ¯æ¬¡é€‰çš„ç‚¹æ˜¯1ã€1ã€1ã€1

{% asset_img 12.png %}

- å…¶å®åœ¨è¿™é‡Œçš„ 1ã€2ã€3ã€4 å¹¶ä¸æ˜¯çŸ©é˜µé‡Œæœ‰çš„å€¼ï¼Œè€Œæ˜¯ç»™å®ƒçš„ä¸€ä¸ªåºå·ï¼ŒåŒæ ·åºå·ä½ç½®ä¸Šçš„ patch å°±ä¼šè¢« merge åˆ°ä¸€èµ·ï¼Œè¿™ä¸ªåºå·åªæ˜¯ä¸ºäº†å¸®åŠ©ç†è§£
- ç»è¿‡éš”ä¸€ä¸ªç‚¹é‡‡ä¸€ä¸ªæ ·ä¹‹åï¼ŒåŸæ¥çš„è¿™ä¸ªå¼ é‡å°±å˜æˆäº†å››ä¸ªå¼ é‡ï¼Œä¹Ÿå°±æ˜¯è¯´æ‰€æœ‰çš„ 1 éƒ½åœ¨ä¸€èµ·äº†ï¼Œ2 åœ¨ä¸€èµ·ï¼Œ3 åœ¨ä¸€èµ·ï¼Œ4 åœ¨ä¸€èµ·ï¼Œå¦‚æœåŸå¼ é‡çš„ç»´åº¦æ˜¯ h * w * cÂ ï¼Œå½“ç„¶è¿™é‡Œ c æ²¡æœ‰ç”»å‡ºæ¥ï¼Œç»è¿‡è¿™æ¬¡é‡‡æ ·ä¹‹åå°±å¾—åˆ°äº† 4 ä¸ªå¼ é‡ï¼Œæ¯ä¸ªå¼ é‡çš„å¤§å°æ˜¯ h/2ã€w/2ï¼Œå®ƒçš„å°ºå¯¸éƒ½ç¼©å°äº†ä¸€å€
- ç°åœ¨æŠŠè¿™å››ä¸ªå¼ é‡åœ¨ c çš„ç»´åº¦ä¸Šæ‹¼æ¥èµ·æ¥ï¼Œä¹Ÿå°±å˜æˆäº†ä¸‹å›¾ä¸­çº¢çº¿æ‰€ç”»å‡ºæ¥çš„å½¢å¼ï¼Œå¼ é‡çš„å¤§å°å°±å˜æˆäº† h/2 * w/2 * 4cï¼Œç›¸å½“äºç”¨ç©ºé—´ä¸Šçš„ç»´åº¦æ¢äº†æ›´å¤šçš„é€šé“æ•°

{% asset_img 13.png %}

- é€šè¿‡è¿™ä¸ªæ“ä½œï¼Œå°±æŠŠåŸæ¥ä¸€ä¸ªå¤§çš„å¼ é‡å˜å°äº†ï¼Œå°±åƒå·ç§¯ç¥ç»ç½‘ç»œé‡Œçš„æ± åŒ–æ“ä½œä¸€æ ·ï¼Œä¸ºäº†è·Ÿå·ç§¯ç¥ç»ç½‘ç»œé‚£è¾¹ä¿æŒä¸€è‡´ï¼ˆä¸è®ºæ˜¯ VGGNet è¿˜æ˜¯ ResNetï¼Œä¸€èˆ¬åœ¨æ± åŒ–æ“ä½œé™ç»´ä¹‹åï¼Œé€šé“æ•°éƒ½ä¼šç¿»å€ï¼Œä» 128 å˜æˆ 256ï¼Œä» 256 å†å˜æˆ 512ï¼‰ï¼Œæ‰€ä»¥è¿™é‡Œä¹Ÿåªæƒ³è®©ä»–ç¿»å€ï¼Œè€Œä¸æ˜¯å˜æˆ 4 å€ï¼Œæ‰€ä»¥ç´§æ¥ç€åˆå†åšäº†ä¸€æ¬¡æ“ä½œï¼Œå°±æ˜¯åœ¨ c çš„ç»´åº¦ä¸Šç”¨ä¸€ä¸ª 1 * 1 çš„å·ç§¯ï¼ŒæŠŠé€šé“æ•°é™ä¸‹æ¥å˜æˆ 2cï¼Œé€šè¿‡è¿™ä¸ªæ“ä½œå°±èƒ½æŠŠåŸæ¥ä¸€ä¸ªå¤§å°ä¸º h * w * c çš„å¼ é‡å˜æˆ h/2 * w/2 * 2c çš„ä¸€ä¸ªå¼ é‡ï¼Œä¹Ÿå°±æ˜¯è¯´ç©ºé—´å¤§å°å‡åŠï¼Œä½†æ˜¯é€šé“æ•°ä¹˜ 2ï¼Œè¿™æ ·å°±è·Ÿå·ç§¯ç¥ç»ç½‘ç»œå®Œå…¨å¯¹ç­‰èµ·æ¥äº†

æ•´ä¸ªè¿™ä¸ªè¿‡ç¨‹å°±æ˜¯ Patch Mergingï¼Œç»å†è¿‡è¿™æ¬¡ Patch Merging æ“ä½œä¹‹åï¼Œè¾“å‡ºçš„å¤§å°å°±ä» 56 * 56 * 96 å˜æˆäº† 28 * 28 * 192ï¼Œç»è¿‡ stage2 ä¸­çš„ Transformer blockï¼Œå°ºå¯¸æ˜¯ä¸å˜çš„ï¼Œæ‰€ä»¥å‡ºæ¥ä¹‹åè¿˜æ˜¯ 28 * 28 * 192

{% asset_img 14.png %}

è¿™æ ·ç¬¬äºŒé˜¶æ®µä¹Ÿå°±å®Œæˆäº†ï¼Œç¬¬ä¸‰å’Œç¬¬å››é˜¶æ®µéƒ½æ˜¯åŒç†ï¼Œéƒ½æ˜¯å…ˆè¿›æ¥åšä¸€æ¬¡ Patch Mergingï¼Œç„¶åå†é€šè¿‡ä¸€äº› Swin Transformer blockï¼Œæ‰€ä»¥ç»´åº¦å°±è¿›ä¸€æ­¥é™æˆäº† 14 * 14 * 384 ä»¥åŠ 7 * 7 * 768

è¿™é‡Œå…¶å®ä¼šå‘ç°ï¼Œç‰¹å¾å›¾çš„ç»´åº¦çœŸçš„è·Ÿå·ç§¯ç¥ç»ç½‘ç»œå¥½åƒï¼Œå› ä¸ºå¦‚æœå›æƒ³æ®‹å·®ç½‘ç»œçš„å¤šå°ºå¯¸çš„ç‰¹å¾ï¼Œå°±æ˜¯ç»è¿‡æ¯ä¸ªæ®‹å·®é˜¶æ®µä¹‹åçš„ç‰¹å¾å›¾å¤§å°ä¹Ÿæ˜¯ 56 * 56ã€28 * 28ã€14 * 14ï¼Œæœ€åæ˜¯ 7 * 7

{% asset_img 15.png %}

è€Œä¸”ä¸ºäº†å’Œå·ç§¯ç¥ç»ç½‘ç»œä¿æŒä¸€è‡´ï¼ŒSwin Transformer è¿™ç¯‡è®ºæ–‡å¹¶æ²¡æœ‰åƒ ViT ä¸€æ ·ä½¿ç”¨ CLS tokenï¼ŒViT æ˜¯ç»™åˆšå¼€å§‹çš„è¾“å…¥åºåˆ—åˆåŠ äº†ä¸€ä¸ª CLS tokenï¼Œæ‰€ä»¥è¿™ä¸ªé•¿åº¦å°±ä» 196 å˜æˆäº† 197ï¼Œæœ€åæ‹¿ CLS token çš„ç‰¹å¾ç›´æ¥å»åšåˆ†ç±»ï¼Œä½† Swin Transformer æ²¡æœ‰ç”¨è¿™ä¸ª tokenï¼Œå®ƒæ˜¯åƒå·ç§¯ç¥ç»ç½‘ç»œä¸€æ ·ï¼Œåœ¨å¾—åˆ°æœ€åçš„ç‰¹å¾å›¾ä¹‹åç”¨global average pollingï¼Œå°±æ˜¯å…¨å±€æ± åŒ–çš„æ“ä½œï¼Œç›´æ¥æŠŠ 7 * 7 å°±å–å¹³å‡æ‹‰ç›´å˜æˆ 1 äº†
- ä½œè€…è¿™ä¸ªå›¾é‡Œå¹¶æ²¡æœ‰ç”»ï¼Œå› ä¸º Swin Transformer çš„æœ¬æ„å¹¶ä¸æ˜¯åªåšåˆ†ç±»ï¼Œå®ƒè¿˜ä¼šå»åšæ£€æµ‹å’Œåˆ†å‰²ï¼Œæ‰€ä»¥è¯´å®ƒåªç”»äº†éª¨å¹²ç½‘ç»œçš„éƒ¨åˆ†ï¼Œæ²¡æœ‰å»ç”»æœ€åçš„åˆ†ç±»å¤´æˆ–è€…æ£€æµ‹å¤´ï¼Œä½†æ˜¯å¦‚æœæ˜¯åšåˆ†ç±»çš„è¯ï¼Œæœ€åå°±å˜æˆäº† 1 * 768ï¼Œç„¶ååˆå˜æˆäº† 1 * 1,000

{% asset_img 16.png %}

- å¦‚æœæ˜¯åšImageNetçš„è¯ï¼Œè¿™æ ·å°±å®Œæˆäº†æ•´ä¸ªä¸€ä¸ªåˆ†ç±»ç½‘ç»œçš„å‰å‘è¿‡ç¨‹

æ‰€ä»¥çœ‹å®Œæ•´ä¸ªå‰å‘è¿‡ç¨‹ä¹‹åï¼Œå°±ä¼šå‘ç° Swin Transformer æœ‰å››ä¸ª stageï¼Œè¿˜æœ‰ç±»ä¼¼äºæ± åŒ–çš„ patch merging æ“ä½œï¼Œè‡ªæ³¨æ„åŠ›è¿˜æ˜¯åœ¨å°çª—å£ä¹‹å†…åšçš„ä»¥åŠæœ€åè¿˜ç”¨çš„æ˜¯ global average pollingï¼Œæ‰€ä»¥è¯´ Swin Transformer è¿™ç¯‡è®ºæ–‡çœŸçš„æ˜¯æŠŠå·ç§¯ç¥ç»ç½‘ç»œå’Œ Transformer è¿™ä¸¤ç³»åˆ—çš„å·¥ä½œå®Œç¾çš„ç»“åˆåˆ°äº†ä¸€èµ·ï¼Œä¹Ÿå¯ä»¥è¯´å®ƒæ˜¯æŠ«ç€ Transformer çš®çš„å·ç§¯ç¥ç»ç½‘ç»œ

***

#### ä¸»è¦è´¡çŒ®

è¿™ç¯‡è®ºæ–‡çš„ä¸»è¦è´¡çŒ®å°±æ˜¯åŸºäºçª—å£æˆ–è€…ç§»åŠ¨çª—å£çš„è‡ªæ³¨æ„åŠ›ï¼Œè¿™é‡Œä½œè€…åˆå†™äº†ä¸€æ®µç ”ç©¶åŠ¨æœºï¼Œå°±æ˜¯ä¸ºä»€ä¹ˆè¦å¼•å…¥çª—å£çš„è‡ªæ³¨æ„åŠ›ï¼Œå…¶å®è·Ÿä¹‹å‰å¼•è¨€é‡Œè¯´çš„éƒ½æ˜¯ä¸€ä¸ªäº‹æƒ…ï¼Œå°±æ˜¯è¯´å…¨å±€è‡ªæ³¨æ„åŠ›çš„è®¡ç®—ä¼šå¯¼è‡´å¹³æ–¹å€çš„å¤æ‚åº¦ï¼ŒåŒæ ·å½“å»åšè§†è§‰é‡Œçš„ä¸‹æ¸¸ä»»åŠ¡ï¼Œå°¤å…¶æ˜¯å¯†é›†é¢„æµ‹å‹çš„ä»»åŠ¡ï¼Œæˆ–è€…è¯´é‡åˆ°éå¸¸å¤§å°ºå¯¸çš„å›¾ç‰‡æ—¶å€™ï¼Œè¿™ç§å…¨å±€ç®—è‡ªæ³¨æ„åŠ›çš„è®¡ç®—å¤æ‚åº¦å°±éå¸¸è´µäº†ï¼Œæ‰€ä»¥å°±ç”¨çª—å£çš„æ–¹å¼å»åšè‡ªæ³¨æ„åŠ›

***

##### çª—å£åˆ’åˆ†ä¸¾ä¾‹

åŸå›¾ç‰‡ä¼šè¢«å¹³å‡çš„åˆ†æˆä¸€äº›æ²¡æœ‰é‡å çš„çª—å£ï¼Œæ‹¿ç¬¬ä¸€å±‚ä¹‹å‰çš„è¾“å…¥æ¥ä¸¾ä¾‹ï¼Œå®ƒçš„å°ºå¯¸å°±æ˜¯ 56 * 56 * 96ï¼Œä¹Ÿå°±è¯´æœ‰ä¸€ä¸ªç»´åº¦æ˜¯ 56 * 56 å¼ é‡ï¼Œç„¶åæŠŠå®ƒåˆ‡æˆä¸€äº›ä¸é‡å çš„æ–¹æ ¼ï¼Œä¹Ÿå°±æ˜¯ä¸‹å›¾ä¸­ç”¨æ©˜é»„è‰²è¡¨ç¤ºçš„æ–¹æ ¼

{% asset_img 17.png %}

- æ¯ä¸€ä¸ªæ©˜é»„è‰²çš„æ–¹æ ¼å°±æ˜¯ä¸€ä¸ªçª—å£ï¼Œä½†æ˜¯è¿™ä¸ªçª—å£å¹¶ä¸æ˜¯æœ€å°çš„è®¡ç®—å•å…ƒï¼Œæœ€å°çš„è®¡ç®—å•å…ƒå…¶å®è¿˜æ˜¯ä¹‹å‰çš„é‚£ä¸ª patchï¼Œä¹Ÿå°±æ„å‘³ç€æ¯ä¸€ä¸ªå°çª—å£é‡Œå…¶å®è¿˜æœ‰ m * m ä¸ª patchï¼Œåœ¨ Swin Transformer è¿™ç¯‡è®ºæ–‡é‡Œä¸€èˆ¬ m é»˜è®¤ä¸º 7ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€ä¸ªæ©˜é»„è‰²çš„å°æ–¹æ ¼é‡Œæœ‰ä¸ƒä¸ƒå››åä¹ä¸ªå° patch
- ç°åœ¨æ‰€æœ‰è‡ªæ³¨æ„åŠ›çš„è®¡ç®—éƒ½æ˜¯åœ¨è¿™äº›å°çª—å£é‡Œå®Œæˆçš„ï¼Œå°±æ˜¯è¯´åºåˆ—é•¿åº¦æ°¸è¿œéƒ½æ˜¯ä¸ƒä¸ƒå››åä¹
- åŸæ¥å¤§çš„æ•´ä½“ç‰¹å¾å›¾åˆ°åº•é‡Œé¢ä¼šæœ‰å¤šå°‘ä¸ªçª—å£å‘¢ï¼Ÿå…¶å®ä¹Ÿå°±æ˜¯æ¯æ¡è¾¹ 56 / 7 å°± 8 ä¸ªçª—å£ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€å…±ä¼šæœ‰ 8 * 8 ç­‰äº 64 ä¸ªçª—å£ï¼Œå°±æ˜¯è¯´ä¼šåœ¨è¿™ 64 ä¸ªçª—å£é‡Œåˆ†åˆ«å»ç®—å®ƒä»¬çš„è‡ªæ³¨æ„åŠ›

***

#### åŸºäºçª—å£çš„è‡ªæ³¨æ„åŠ›æ¨¡å¼çš„è®¡ç®—å¤æ‚åº¦

è¯´åˆ°åº•ï¼ŒåŸºäºçª—å£çš„è‡ªæ³¨æ„åŠ›è®¡ç®—æ–¹å¼èƒ½æ¯”å…¨å±€çš„è‡ªæ³¨æ„åŠ›æ–¹å¼çœå¤šå°‘å‘¢ï¼Ÿåœ¨ Swin Transformer è¿™ç¯‡è®ºæ–‡é‡Œä½œè€…å°±ç»™å‡ºäº†ä¸€ä¸ªå¤§æ¦‚çš„ä¼°è®¡ï¼Œå®ƒç»™å‡ºäº†ä¸¤ä¸ªå…¬å¼å¦‚ä¸‹å›¾æ‰€ç¤º

{% asset_img 18.png %}

- å…¬å¼ï¼ˆ1ï¼‰å¯¹åº”çš„æ˜¯æ ‡å‡†çš„å¤šå¤´è‡ªæ³¨æ„åŠ›çš„è®¡ç®—å¤æ‚åº¦
- æ¯ä¸€ä¸ªå›¾ç‰‡å¤§æ¦‚ä¼šæœ‰ h * w ä¸ª patchï¼Œåœ¨åˆšæ‰çš„ä¾‹å­é‡Œï¼Œh å’Œ w åˆ†åˆ«éƒ½æ˜¯ 56ï¼Œc æ˜¯ç‰¹å¾çš„ç»´åº¦
- å…¬å¼ï¼ˆ2ï¼‰å¯¹åº”çš„æ˜¯åŸºäºçª—å£çš„è‡ªæ³¨æ„åŠ›è®¡ç®—çš„å¤æ‚åº¦ï¼Œè¿™é‡Œçš„ M å°±æ˜¯åˆšæ‰çš„ 7ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€ä¸ªçª—å£çš„æŸæ¡è¾¹ä¸Šæœ‰å¤šå°‘ä¸ª patch

***

#### å…¬å¼æ¨ç®—

ä»¥æ ‡å‡†çš„å¤šå¤´è‡ªæ³¨æ„åŠ›ä¸ºä¾‹

{% asset_img 19.png %}

- å¦‚æœç°åœ¨æœ‰ä¸€ä¸ªè¾“å…¥ï¼Œè‡ªæ³¨æ„åŠ›é¦–å…ˆæŠŠå®ƒå˜æˆ q k v ä¸‰ä¸ªå‘é‡ï¼Œè¿™ä¸ªè¿‡ç¨‹å…¶å®å°±æ˜¯åŸæ¥çš„å‘é‡åˆ†åˆ«ä¹˜äº†ä¸‰ä¸ªç³»æ•°çŸ©é˜µ
- ä¸€æ—¦å¾—åˆ° query å’Œ k ä¹‹åï¼Œå®ƒä»¬å°±ä¼šç›¸ä¹˜ï¼Œæœ€åå¾—åˆ° attentionï¼Œä¹Ÿå°±æ˜¯è‡ªæ³¨æ„åŠ›çš„çŸ©é˜µ
- æœ‰äº†è‡ªæ³¨æ„åŠ›ä¹‹åï¼Œå°±ä¼šå’Œ value åšä¸€æ¬¡ä¹˜æ³•ï¼Œä¹Ÿå°±ç›¸å½“äºæ˜¯åšäº†ä¸€æ¬¡åŠ æƒ
- æœ€åå› ä¸ºæ˜¯å¤šå¤´è‡ªæ³¨æ„åŠ›ï¼Œæ‰€ä»¥æœ€åè¿˜ä¼šæœ‰ä¸€ä¸ª projection layerï¼Œè¿™ä¸ªæŠ•å°„å±‚ä¼šæŠŠå‘é‡çš„ç»´åº¦æŠ•å°„åˆ°æˆ‘ä»¬æƒ³è¦çš„ç»´åº¦

å¦‚æœè¿™äº›å‘é‡éƒ½åŠ ä¸Šå®ƒä»¬è¯¥æœ‰çš„ç»´åº¦ï¼Œä¹Ÿå°±æ˜¯è¯´åˆšå¼€å§‹è¾“å…¥æ˜¯ h * w * c

{% asset_img 20.png %}

- é¦–å…ˆï¼Œto_q_k_v()å‡½æ•°ç›¸å½“äºæ˜¯ç”¨ä¸€ä¸ª h * w * c çš„å‘é‡ä¹˜ä»¥ä¸€ä¸ª c * c çš„ç³»æ•°çŸ©é˜µï¼Œæœ€åå¾—åˆ°äº† h * w * cã€‚æ‰€ä»¥æ¯ä¸€ä¸ªè®¡ç®—çš„å¤æ‚åº¦æ˜¯ h * w * c^2ï¼Œå› ä¸ºæœ‰ä¸‰æ¬¡æ“ä½œï¼Œæ‰€ä»¥æ˜¯ä¸‰å€çš„ h * w * c^2
- ç„¶åï¼Œç®—è‡ªæ³¨æ„åŠ›å°±æ˜¯ h * w * c ä¹˜ä»¥ k çš„è½¬ç½®ï¼Œä¹Ÿå°±æ˜¯ c * h * wï¼Œæ‰€ä»¥å¾—åˆ°äº† h * w * h * wï¼Œè¿™ä¸ªè®¡ç®—å¤æ‚åº¦å°±æ˜¯(h * w)^2 * c
- æ¥ä¸‹æ¥ï¼Œè‡ªæ³¨æ„åŠ›çŸ©é˜µå’Œ value çš„ä¹˜ç§¯çš„è®¡ç®—å¤æ‚åº¦è¿˜æ˜¯ (h * w)^2 * cï¼Œæ‰€ä»¥ç°åœ¨å°±æˆäº† 2 * (h * w)^2 * c
- æœ€åä¸€æ­¥ï¼ŒæŠ•å°„å±‚ä¹Ÿå°±æ˜¯ h * w * c ä¹˜ä»¥ c * c å˜æˆäº† h * w * c ï¼Œå®ƒçš„è®¡ç®—å¤æ‚åº¦å°±åˆæ˜¯ h * w * c^2
- æœ€ååˆå¹¶èµ·æ¥å°±æ˜¯æœ€åçš„å…¬å¼ï¼ˆ1ï¼‰

åŸºäºçª—å£çš„è‡ªæ³¨æ„åŠ›è®¡ç®—å¤æ‚åº¦åˆæ˜¯å¦‚ä½•å¾—åˆ°çš„å‘¢ï¼Ÿ

- å› ä¸ºåœ¨æ¯ä¸ªçª—å£é‡Œç®—çš„è¿˜æ˜¯å¤šå¤´è‡ªæ³¨æ„åŠ›ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥å¥—ç”¨å…¬å¼ï¼ˆ1ï¼‰ï¼Œåªä¸è¿‡é«˜åº¦å’Œå®½åº¦å˜åŒ–äº†ï¼Œç°åœ¨é«˜åº¦å’Œå®½åº¦ä¸å†æ˜¯ h * wï¼Œè€Œæ˜¯å˜æˆçª—å£æœ‰å¤šå¤§äº†ï¼Œä¹Ÿå°±æ˜¯ M * Mï¼Œä¹Ÿå°±æ˜¯è¯´ç°åœ¨ h å˜æˆäº† Mï¼Œw ä¹Ÿæ˜¯ Mï¼Œå®ƒçš„åºåˆ—é•¿åº¦åªæœ‰ M * M è¿™ä¹ˆå¤§
- æ‰€ä»¥å½“æŠŠ M å€¼å¸¦å…¥åˆ°å…¬å¼ï¼ˆ1ï¼‰ä¹‹åï¼Œå°±å¾—åˆ°è®¡ç®—å¤æ‚åº¦æ˜¯ 4 * M^2 * c^2 + 2 * M^4 * cï¼Œè¿™ä¸ªå°±æ˜¯åœ¨ä¸€ä¸ªçª—å£é‡Œç®—å¤šå¤´è‡ªæ³¨æ„åŠ›æ‰€éœ€è¦çš„è®¡ç®—å¤æ‚åº¦
- é‚£æˆ‘ä»¬ç°åœ¨ä¸€å…±æœ‰ h/M * w/M ä¸ªçª—å£ï¼Œç°åœ¨ç”¨è¿™ä¹ˆå¤šä¸ªçª—å£ä¹˜ä»¥æ¯ä¸ªçª—å£æ‰€éœ€è¦çš„è®¡ç®—å¤æ‚åº¦å°±èƒ½å¾—åˆ°å…¬å¼ï¼ˆ2ï¼‰äº†

å¯¹æ¯”å…¬å¼ï¼ˆ1ï¼‰å’Œå…¬å¼ï¼ˆ2ï¼‰ï¼Œè™½ç„¶è¿™ä¸¤ä¸ªå…¬å¼å‰é¢è¿™ä¸¤é¡¹æ˜¯ä¸€æ ·çš„ï¼Œåªæœ‰åé¢ä» (h * w)^2 å˜æˆäº† M^2 * h * wï¼Œçœ‹èµ·æ¥å¥½åƒå·®åˆ«ä¸å¤§ï¼Œä½†å…¶å®å¦‚æœä»”ç»†å¸¦å…¥æ•°å­—è¿›å»è®¡ç®—å°±ä¼šå‘ç°ï¼Œè®¡ç®—å¤æ‚çš„å·®è·æ˜¯ç›¸å½“å·¨å¤§çš„ï¼Œå› ä¸ºè¿™é‡Œçš„ h * w å¦‚æœæ˜¯ 56 * 56 çš„è¯ï¼Œ M^2 å…¶å®åªæœ‰ 49ï¼Œæ‰€ä»¥æ˜¯ç›¸å·®äº†å‡ åç”šè‡³ä¸Šç™¾å€çš„

è¿™ç§åŸºäºçª—å£è®¡ç®—è‡ªæ³¨æ„åŠ›çš„æ–¹å¼è™½ç„¶å¾ˆå¥½åœ°è§£å†³äº†å†…å­˜å’Œè®¡ç®—é‡çš„é—®é¢˜ï¼Œä½†æ˜¯çª—å£å’Œçª—å£ä¹‹é—´æ²¡æœ‰é€šä¿¡ï¼Œè¿™æ ·å°±è¾¾ä¸åˆ°å…¨å±€å»ºæ¨¡äº†ï¼Œä¹Ÿå°±æ–‡ç« é‡Œè¯´çš„ä¼šé™åˆ¶æ¨¡å‹çš„èƒ½åŠ›ï¼Œæ‰€ä»¥æœ€å¥½è¿˜æ˜¯è¦æœ‰ä¸€ç§æ–¹å¼èƒ½è®©çª—å£å’Œçª—å£ä¹‹é—´äº’ç›¸é€šä¿¡èµ·æ¥ï¼Œè¿™æ ·æ•ˆæœåº”è¯¥ä¼šæ›´å¥½ï¼Œå› ä¸ºå…·æœ‰ä¸Šä¸‹æ–‡çš„ä¿¡æ¯ï¼Œæ‰€ä»¥ä½œè€…å°±æå‡ºç§»åŠ¨çª—å£çš„æ–¹å¼

ç§»åŠ¨çª—å£å°±æ˜¯æŠŠåŸæ¥çš„çª—å£å¾€å³ä¸‹è§’ç§»åŠ¨ä¸€åŠçª—å£çš„è·ç¦»ï¼Œå¦‚æœ Transformer æ˜¯ä¸Šä¸‹ä¸¤å±‚è¿ç€åšè¿™ç§æ“ä½œï¼Œå…ˆæ˜¯ window å†æ˜¯ shifted window çš„è¯ï¼Œå°±èƒ½èµ·åˆ°çª—å£å’Œçª—å£ä¹‹é—´äº’ç›¸é€šä¿¡çš„ç›®çš„äº†

æ‰€ä»¥è¯´åœ¨ Swin Transformer é‡Œï¼Œ transformer block çš„å®‰æ’æ˜¯æœ‰è®²ç©¶çš„ï¼Œæ¯æ¬¡éƒ½æ˜¯å…ˆè¦åšä¸€æ¬¡åŸºäºçª—å£çš„å¤šå¤´è‡ªæ³¨æ„åŠ›ï¼Œç„¶åå†åšä¸€æ¬¡åŸºäºç§»åŠ¨çª—å£çš„å¤šå¤´è‡ªæ³¨æ„åŠ›ï¼Œè¿™æ ·å°±è¾¾åˆ°äº†çª—å£å’Œçª—å£ä¹‹é—´çš„äº’ç›¸é€šä¿¡ã€‚å¦‚ä¸‹å›¾æ‰€ç¤º

{% asset_img 21.png %}

- æ¯æ¬¡è¾“å…¥å…ˆè¿›æ¥ä¹‹åå…ˆåšä¸€æ¬¡ Layernormï¼Œç„¶ååšçª—å£çš„å¤šå¤´è‡ªæ³¨æ„åŠ›ï¼Œç„¶åå†è¿‡ Layernorm è¿‡ MLPï¼Œç¬¬ä¸€ä¸ª block å°±ç»“æŸäº†
- è¿™ä¸ª block ç»“æŸä»¥åï¼Œç´§æ¥ç€åšä¸€æ¬¡ Shifted windowï¼Œä¹Ÿå°±æ˜¯åŸºäºç§»åŠ¨çª—å£çš„å¤šå¤´è‡ªæ³¨æ„åŠ›ï¼Œç„¶åå†è¿‡ MLP å¾—åˆ°è¾“å‡º
- è¿™ä¸¤ä¸ª block åŠ èµ·æ¥å…¶å®æ‰ç®—æ˜¯ Swin Transformer ä¸€ä¸ªåŸºæœ¬çš„è®¡ç®—å•å…ƒï¼Œè¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆ stage1ã€2ã€3ã€4 ä¸­çš„ swin transformer block ä¸ºä»€ä¹ˆæ˜¯ *2ã€*2ã€*6ã€*2ï¼Œä¹Ÿå°±æ˜¯ä¸€å…±æœ‰å¤šå°‘å±‚ Swin Transformer block çš„æ•°å­—æ€»æ˜¯å¶æ•°ï¼Œå› ä¸ºå®ƒå§‹ç»ˆéƒ½éœ€è¦ä¸¤å±‚ block è¿åœ¨ä¸€èµ·ä½œä¸ºä¸€ä¸ªåŸºæœ¬å•å…ƒï¼Œæ‰€ä»¥ä¸€å®šæ˜¯ 2 çš„å€æ•°

åˆ°æ­¤ï¼ŒSwin Transformer æ•´ä½“çš„æ•…äº‹å’Œç»“æ„å°±å·²ç»è®²å®Œäº†ï¼Œä¸»è¦çš„ç ”ç©¶åŠ¨æœºå°±æ˜¯æƒ³è¦æœ‰ä¸€ä¸ªå±‚çº§å¼çš„ Transformerï¼Œä¸ºäº†è¿™ä¸ªå±‚çº§å¼ï¼Œæ‰€ä»¥ä»‹ç»äº† Patch Merging çš„æ“ä½œï¼Œä»è€Œèƒ½åƒå·ç§¯ç¥ç»ç½‘ç»œä¸€æ ·æŠŠ Transformer åˆ†æˆå‡ ä¸ªé˜¶æ®µï¼Œä¸ºäº†å‡å°‘è®¡ç®—å¤æ‚åº¦ï¼Œäº‰å–èƒ½åšè§†è§‰é‡Œå¯†é›†é¢„æµ‹çš„ä»»åŠ¡ï¼Œæ‰€ä»¥åˆæå‡ºäº†åŸºäºçª—å£å’Œç§»åŠ¨çª—å£çš„è‡ªæ³¨æ„åŠ›æ–¹å¼ï¼Œä¹Ÿå°±æ˜¯è¿åœ¨ä¸€èµ·çš„ä¸¤ä¸ª Transformer blockï¼Œæœ€åæŠŠè¿™äº›éƒ¨åˆ†åŠ åœ¨ä¸€èµ·ï¼Œå°±æ˜¯ Swin Transformer çš„ç»“æ„

å…¶å®ä½œè€…åé¢è¿˜è®²äº†ä¸¤ä¸ªç‚¹
- ä¸€ä¸ªæ˜¯æ€æ ·æé«˜ç§»åŠ¨çª—å£çš„è®¡ç®—æ•ˆç‡ï¼Œä»–ä»¬é‡‡å–äº†ä¸€ç§éå¸¸å·§å¦™çš„ maskingï¼ˆæ©ç ï¼‰çš„æ–¹å¼
- å¦å¤–ä¸€ä¸ªç‚¹å°±æ˜¯è¿™ç¯‡è®ºæ–‡é‡Œæ²¡æœ‰ç”¨ç»å¯¹çš„ä½ç½®ç¼–ç ï¼Œè€Œæ˜¯ç”¨ç›¸å¯¹çš„ä½ç½®ç¼–ç 

ä½†è¿™ä¸¤ä¸ªç‚¹å…¶å®éƒ½æ˜¯ä¸ºäº†æé«˜æ€§èƒ½çš„ä¸€äº›æŠ€æœ¯ç»†èŠ‚ï¼Œè·Ÿæ–‡ç« æ•´ä½“çš„æ•…äº‹å·²ç»æ²¡æœ‰å¤šå¤§å…³ç³»äº†

{% asset_img 22.png %}

- ä¸Šå›¾æ˜¯ä¸€ä¸ªåŸºç¡€ç‰ˆæœ¬çš„ç§»åŠ¨çª—å£ï¼Œå°±æ˜¯æŠŠå·¦è¾¹çš„çª—å£æ¨¡å¼å˜æˆäº†å³è¾¹çš„çª—å£æ–¹å¼
- è™½ç„¶è¿™ç§æ–¹å¼å·²ç»èƒ½å¤Ÿè¾¾åˆ°çª—å£å’Œçª—å£ä¹‹é—´çš„äº’ç›¸é€šä¿¡äº†ï¼Œä½†æ˜¯ä¼šå‘ç°ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯åŸæ¥è®¡ç®—çš„æ—¶å€™ï¼Œç‰¹å¾å›¾ä¸Šåªæœ‰ 4 ä¸ªçª—å£ï¼Œä½†æ˜¯åšå®Œç§»åŠ¨çª—å£æ“ä½œä¹‹åå¾—åˆ°äº† 9 ä¸ªçª—å£ï¼Œçª—å£çš„æ•°é‡å¢åŠ äº†ï¼Œè€Œä¸”æ¯ä¸ªçª—å£é‡Œçš„å…ƒç´ å¤§å°ä¸ä¸€ï¼Œæ¯”å¦‚è¯´ä¸­é—´çš„çª—å£è¿˜æ˜¯ 4 * 4ï¼Œæœ‰ 16 ä¸ª patchï¼Œä½†æ˜¯åˆ«çš„çª—å£æœ‰çš„æœ‰ 4 ä¸ª patchï¼Œæœ‰çš„æœ‰ 8 ä¸ª patchï¼Œéƒ½ä¸ä¸€æ ·äº†ï¼Œå¦‚æœæƒ³åšå¿«é€Ÿè¿ç®—ï¼Œå°±æ˜¯æŠŠè¿™äº›çª—å£å…¨éƒ½å‹æˆä¸€ä¸ª patch ç›´æ¥å»ç®—è‡ªæ³¨æ„åŠ›ï¼Œå°±åšä¸åˆ°äº†ï¼Œå› ä¸ºçª—å£çš„å¤§å°ä¸ä¸€æ ·
- æœ‰ä¸€ä¸ªç®€å•ç²—æš´çš„è§£å†³æ–¹å¼å°±æ˜¯æŠŠè¿™äº›å°çª—å£å‘¨å›´å† pad ä¸Š 0Â ï¼ŒæŠŠå®ƒç…§æ · pad æˆå’Œä¸­é—´çª—å£ä¸€æ ·å¤§çš„çª—å£ï¼Œè¿™æ ·å°±æœ‰ 9 ä¸ªå®Œå…¨ä¸€æ ·å¤§çš„çª—å£ï¼Œè¿™æ ·å°±è¿˜èƒ½æŠŠå®ƒä»¬å‹æˆä¸€ä¸ª batchï¼Œå°±ä¼šå¿«å¾ˆå¤š
- ä½†æ˜¯è¿™æ ·çš„è¯ï¼Œæ— å½¢ä¹‹ä¸­è®¡ç®—å¤æ‚åº¦å°±æå‡äº†ï¼Œå› ä¸ºåŸæ¥å¦‚æœç®—åŸºäºçª—å£çš„è‡ªæ³¨æ„åŠ›åªç”¨ç®— 4 ä¸ªçª—å£ï¼Œä½†æ˜¯ç°åœ¨éœ€è¦å»ç®— 9 ä¸ªçª—å£ï¼Œå¤æ‚åº¦ä¸€ä¸‹æå‡äº†ä¸¤å€å¤šï¼Œæ‰€ä»¥è¿˜æ˜¯ç›¸å½“å¯è§‚çš„
- é‚£æ€ä¹ˆèƒ½è®©ç¬¬äºŒæ¬¡ç§»ä½å®Œçš„çª—å£æ•°é‡è¿˜æ˜¯ä¿æŒ 4 ä¸ªï¼Œè€Œä¸”æ¯ä¸ªçª—å£é‡Œçš„ patch æ•°é‡ä¹Ÿè¿˜ä¿æŒä¸€è‡´å‘¢ï¼Ÿä½œè€…æå‡ºäº†ä¸€ä¸ªéå¸¸å·§å¦™çš„æ©ç æ–¹å¼ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º

{% asset_img 23.png %}

- ä¸Šå›¾æ˜¯è¯´ï¼Œå½“é€šè¿‡æ™®é€šçš„ç§»åŠ¨çª—å£æ–¹å¼ï¼Œå¾—åˆ° 9 ä¸ªçª—å£ä¹‹åï¼Œç°åœ¨ä¸åœ¨è¿™ 9 ä¸ªçª—å£ä¸Šç®—è‡ªæ³¨æ„åŠ›ï¼Œå…ˆå†åšä¸€æ¬¡å¾ªç¯ç§»ä½ï¼ˆcyclic shiftï¼‰
- ç»è¿‡è¿™æ¬¡å¾ªç¯ç§»ä½ä¹‹åï¼ŒåŸæ¥çš„çª—å£ï¼ˆè™šçº¿ï¼‰å°±å˜æˆäº†ç°åœ¨çª—å£ï¼ˆå®çº¿ï¼‰çš„æ ·å­ï¼Œé‚£å¦‚æœåœ¨å¤§çš„ç‰¹å¾å›¾ä¸Šå†æŠŠå®ƒåˆ†æˆå››å®«æ ¼çš„è¯ï¼Œå°±åˆå¾—åˆ°äº† 4 ä¸ªçª—å£ï¼Œæ„æ€å°±æ˜¯è¯´ç§»ä½ä¹‹å‰çš„çª—å£æ•°ä¹Ÿæ˜¯ 4 ä¸ªï¼Œç§»å®Œä½ä¹‹åå†åšä¸€æ¬¡å¾ªç¯ç§»ä½å¾—åˆ°çª—å£æ•°è¿˜æ˜¯ 4 ä¸ªï¼Œè¿™æ ·çª—å£çš„æ•°é‡å°±å›ºå®šäº†ï¼Œä¹Ÿå°±è¯´è®¡ç®—å¤æ‚åº¦å°±å›ºå®šäº†
- ä½†æ˜¯æ–°çš„é—®é¢˜å°±æ¥äº†ï¼Œè™½ç„¶å¯¹äºç§»ä½åå·¦ä¸Šè§’çš„çª—å£ï¼ˆä¹Ÿå°±æ˜¯ç§»ä½å‰æœ€ä¸­é—´çš„çª—å£ï¼‰æ¥è¯´ï¼Œé‡Œé¢çš„å…ƒç´ éƒ½æ˜¯äº’ç›¸ç´§æŒ¨ç€çš„ï¼Œä»–ä»¬ä¹‹é—´å¯ä»¥äº’ç›¸ä¸¤ä¸¤åšè‡ªæ³¨æ„åŠ›ï¼Œä½†æ˜¯å¯¹äºå‰©ä¸‹å‡ ä¸ªçª—å£æ¥è¯´ï¼Œå®ƒä»¬é‡Œé¢çš„å…ƒç´ æ˜¯ä»åˆ«çš„å¾ˆè¿œçš„åœ°æ–¹æ¬è¿‡æ¥çš„ï¼Œæ‰€ä»¥ä»–ä»¬ä¹‹é—´ï¼ŒæŒ‰é“ç†æ¥è¯´æ˜¯ä¸åº”è¯¥å»åšè‡ªæ³¨æ„åŠ›ï¼Œä¹Ÿå°±æ˜¯è¯´ä»–ä»¬ä¹‹é—´ä¸åº”è¯¥æœ‰ä»€ä¹ˆå¤ªå¤§çš„è”ç³»
- è§£å†³è¿™ä¸ªé—®é¢˜å°±éœ€è¦ä¸€ä¸ªå¾ˆå¸¸è§„çš„æ“ä½œï¼Œä¹Ÿå°±æ˜¯æ©ç æ“ä½œï¼Œè¿™åœ¨ Transformer è¿‡å»çš„å·¥ä½œé‡Œæ˜¯å±‚å‡ºä¸ç©·ï¼Œå¾ˆå¤šå·¥ä½œé‡Œéƒ½æœ‰å„å¼å„æ ·çš„æ©ç æ“ä½œ
- åœ¨ Swin Transformer è¿™ç¯‡è®ºæ–‡é‡Œï¼Œä½œè€…ä¹Ÿå·§å¦™çš„è®¾è®¡äº†å‡ ç§æ©ç çš„æ–¹å¼ï¼Œä»è€Œèƒ½è®©ä¸€ä¸ªçª—å£ä¹‹ä¸­ä¸åŒçš„åŒºåŸŸä¹‹é—´ä¹Ÿèƒ½ç”¨ä¸€æ¬¡å‰å‘è¿‡ç¨‹ï¼Œå°±èƒ½æŠŠè‡ªæ³¨æ„åŠ›ç®—å‡ºæ¥ï¼Œä½†æ˜¯äº’ç›¸ä¹‹é—´éƒ½ä¸å¹²æ‰°ï¼Œä¹Ÿå°±æ˜¯åé¢çš„ masked  Multi-head Self Attentionï¼ˆMSAï¼‰
- ç®—å®Œäº†å¤šå¤´è‡ªæ³¨æ„åŠ›ä¹‹åï¼Œè¿˜æœ‰æœ€åä¸€æ­¥å°±æ˜¯éœ€è¦æŠŠå¾ªç¯ä½ç§»å†è¿˜åŸå›å»ï¼Œä¹Ÿå°±æ˜¯è¯´éœ€è¦æŠŠ Aã€Bã€C å†è¿˜åŸåˆ°åŸæ¥çš„ä½ç½®ä¸Šå»ï¼ŒåŸå› æ˜¯è¿˜éœ€è¦ä¿æŒåŸæ¥å›¾ç‰‡çš„ç›¸å¯¹ä½ç½®å¤§æ¦‚æ˜¯ä¸å˜çš„ï¼Œæ•´ä½“å›¾ç‰‡çš„è¯­ä¹‰ä¿¡æ¯ä¹Ÿæ˜¯ä¸å˜çš„ï¼Œå¦‚æœä¸æŠŠå¾ªç¯ä½ç§»è¿˜åŸçš„è¯ï¼Œé‚£ç›¸å½“äºåœ¨åš Transformer çš„æ“ä½œä¹‹ä¸­ï¼Œä¸€ç›´åœ¨æŠŠå›¾ç‰‡å¾€å³ä¸‹è§’ç§»ï¼Œä¸åœçš„å¾€å³ä¸‹è§’ç§»ï¼Œè¿™æ ·å›¾ç‰‡çš„è¯­ä¹‰ä¿¡æ¯å¾ˆæœ‰å¯èƒ½å°±è¢«ç ´åæ‰äº†
- æ‰€ä»¥è¯´æ•´ä½“è€Œè¨€ï¼Œä¸Šå›¾ä»‹ç»äº†ä¸€ç§é«˜æ•ˆçš„ã€æ‰¹æ¬¡çš„è®¡ç®—æ–¹å¼ï¼Œæ¯”å¦‚è¯´æœ¬æ¥ç§»åŠ¨çª—å£ä¹‹åå¾—åˆ°äº† 9 ä¸ªçª—å£ï¼Œè€Œä¸”çª—å£ä¹‹é—´çš„ patch æ•°é‡æ¯ä¸ªéƒ½ä¸ä¸€æ ·ï¼Œä¸ºäº†è¾¾åˆ°é«˜æ•ˆæ€§ï¼Œä¸ºäº†èƒ½å¤Ÿè¿›è¡Œæ‰¹æ¬¡å¤„ç†ï¼Œå…ˆè¿›è¡Œä¸€æ¬¡å¾ªç¯ä½ç§»ï¼ŒæŠŠ 9 ä¸ªçª—å£å˜æˆ 4 ä¸ªçª—å£ï¼Œç„¶åç”¨å·§å¦™çš„æ©ç æ–¹å¼è®©æ¯ä¸ªçª—å£ä¹‹é—´èƒ½å¤Ÿåˆç†åœ°è®¡ç®—è‡ªæ³¨æ„åŠ›ï¼Œæœ€åå†æŠŠç®—å¥½çš„è‡ªæ³¨æ„åŠ›è¿˜åŸï¼Œå°±å®Œæˆäº†åŸºäºç§»åŠ¨çª—å£çš„è‡ªæ³¨æ„åŠ›è®¡ç®—

***

#### æ©ç æ“ä½œä¸¾ä¾‹

**æ©ç å¯è§†åŒ–**

{% asset_img 24.png %}

- ä½œè€…é€šè¿‡è¿™ç§å·§å¦™çš„å¾ªç¯ä½ç§»çš„æ–¹å¼å’Œå·§å¦™è®¾è®¡çš„æ©ç æ¨¡æ¿ï¼Œä»è€Œå®ç°äº†åªéœ€è¦ä¸€æ¬¡å‰å‘è¿‡ç¨‹ï¼Œå°±èƒ½æŠŠæ‰€æœ‰éœ€è¦çš„è‡ªæ³¨æ„åŠ›å€¼éƒ½ç®—å‡ºæ¥ï¼Œè€Œä¸”åªéœ€è¦è®¡ç®— 4 ä¸ªçª—å£ï¼Œä¹Ÿå°±æ˜¯è¯´çª—å£çš„æ•°é‡æ²¡æœ‰å¢åŠ ï¼Œè®¡ç®—å¤æ‚åº¦ä¹Ÿæ²¡æœ‰å¢åŠ ï¼Œéå¸¸é«˜æ•ˆçš„å®Œæˆäº†è¿™ä¸ªä»»åŠ¡

åœ¨æ–¹æ³•çš„æœ€åä¸€èŠ‚ä¹Ÿå°±æ˜¯ 3.3 èŠ‚ï¼Œä½œè€…å¤§æ¦‚ä»‹ç»äº†ä¸€ä¸‹ä»–ä»¬æå‡ºçš„ Swin Transformer çš„å‡ ä¸ªå˜ä½“
- Swin Tiny
- Swin Small
- Swin Base
- Swin Large

Swin Tiny çš„è®¡ç®—å¤æ‚åº¦è·Ÿ ResNet-50 å·®ä¸å¤šï¼ŒSwin Small çš„å¤æ‚åº¦è·Ÿ ResNet-101 æ˜¯å·®ä¸å¤šçš„ï¼Œè¿™æ ·ä¸»è¦æ˜¯æƒ³å»åšä¸€ä¸ªæ¯”è¾ƒå…¬å¹³çš„å¯¹æ¯”

è¿™äº›å˜ä½“ä¹‹é—´æœ‰å“ªäº›ä¸ä¸€æ ·å‘¢ï¼Ÿå…¶å®ä¸»è¦ä¸ä¸€æ ·çš„å°±æ˜¯ä¸¤ä¸ªè¶…å‚æ•°
- ä¸€ä¸ªæ˜¯å‘é‡ç»´åº¦çš„å¤§å° c
- å¦ä¸€ä¸ªæ˜¯æ¯ä¸ª stage é‡Œåˆ°åº•æœ‰å¤šå°‘ä¸ª transform block

è¿™é‡Œå…¶å®å°±è·Ÿæ®‹å·®ç½‘ç»œå°±éå¸¸åƒäº†ï¼Œæ®‹å·®ç½‘ç»œä¹Ÿæ˜¯åˆ†æˆäº†å››ä¸ª stageï¼Œæ¯ä¸ª stage æœ‰ä¸åŒæ•°é‡çš„æ®‹å·®å—

***

### å®éªŒ

é¦–å…ˆæ˜¯åˆ†ç±»ä¸Šçš„å®éªŒï¼Œè¿™é‡Œä¸€å…±è¯´äº†ä¸¤ç§é¢„è®­ç»ƒçš„æ–¹å¼
- ç¬¬ä¸€ç§å°±æ˜¯åœ¨æ­£è§„çš„ ImageNet-1Kï¼ˆ128ä¸‡å¼ å›¾ç‰‡ã€1000ä¸ªç±»ï¼‰ä¸Šåšé¢„è®­ç»ƒ
- ç¬¬äºŒç§æ–¹å¼æ˜¯åœ¨æ›´å¤§çš„ ImageNet-22Kï¼ˆ1400ä¸‡å¼ å›¾ç‰‡ã€2ä¸‡å¤šä¸ªç±»åˆ«ï¼‰ä¸Šåšé¢„è®­ç»ƒ

å½“ç„¶ä¸è®ºæ˜¯ç”¨ ImageNet-1K å»åšé¢„è®­ç»ƒï¼Œè¿˜æ˜¯ç”¨ ImageNet-22K å»åšé¢„è®­ç»ƒï¼Œæœ€åæµ‹è¯•çš„ç»“æœéƒ½æ˜¯åœ¨ ImageNet-1K çš„æµ‹è¯•é›†ä¸Šå»åšçš„ï¼Œç»“æœå¦‚ä¸‹è¡¨æ‰€ç¤º

{% asset_img 25.png %}

- ä¸ŠåŠéƒ¨åˆ†æ˜¯ ImageNet-1K é¢„è®­ç»ƒçš„æ¨¡å‹ç»“æœ
- ä¸‹åŠéƒ¨åˆ†æ˜¯å…ˆç”¨ ImageNet-22K å»é¢„è®­ç»ƒï¼Œç„¶ååˆåœ¨ ImageNet-1K ä¸Šåšå¾®è°ƒï¼Œæœ€åå¾—åˆ°çš„ç»“æœ
- åœ¨è¡¨æ ¼çš„ä¸ŠåŠéƒ¨åˆ†ï¼Œä½œè€…å…ˆæ˜¯è·Ÿä¹‹å‰æœ€å¥½çš„å·ç§¯ç¥ç»ç½‘ç»œåšäº†ä¸€ä¸‹å¯¹æ¯”ï¼ŒRegNet æ˜¯ä¹‹å‰ facebook ç”¨ NASA æœå‡ºæ¥çš„æ¨¡å‹ï¼ŒEfficientNet æ˜¯ google ç”¨ NASA æœå‡ºæ¥çš„æ¨¡å‹ï¼Œè¿™ä¸¤ä¸ªéƒ½ç®—ä¹‹å‰è¡¨ç°éå¸¸å¥½çš„æ¨¡å‹äº†ï¼Œä»–ä»¬çš„æ€§èƒ½æœ€é«˜ä¼šåˆ° 84.3
- æ¥ä¸‹æ¥ä½œè€…å°±å†™äº†ä¸€ä¸‹ä¹‹å‰çš„ Vision Transformer ä¼šè¾¾åˆ°ä»€ä¹ˆæ•ˆæœï¼Œå¯¹äº ViT æ¥è¯´ï¼Œå› ä¸ºå®ƒæ²¡æœ‰ç”¨å¾ˆå¥½çš„æ•°æ®å¢å¼ºï¼Œè€Œä¸”ç¼ºå°‘åç½®å½’çº³ï¼Œæ‰€ä»¥è¯´å®ƒçš„ç»“æœæ˜¯æ¯”è¾ƒå·®çš„ï¼Œåªæœ‰ 70 å¤š
- æ¢ä¸Š DeiT ä¹‹åï¼Œå› ä¸ºç”¨äº†æ›´å¥½çš„æ•°æ®å¢å¼ºå’Œæ¨¡å‹è’¸é¦ï¼Œæ‰€ä»¥è¯´ DeiT Base æ¨¡å‹ä¹Ÿèƒ½å–å¾—ç›¸å½“ä¸é”™çš„ç»“æœï¼Œèƒ½åˆ° 83.1
- å½“ç„¶ Swin Transformer èƒ½æ›´é«˜ä¸€äº›ï¼ŒSwin Base æœ€é«˜èƒ½åˆ° 84.5ï¼Œç¨å¾®æ¯”ä¹‹å‰æœ€å¥½çš„å·ç§¯ç¥ç»ç½‘ç»œé«˜é‚£ä¹ˆä¸€ç‚¹ç‚¹ï¼Œå°±æ¯” 84.3 é«˜äº† 0.2
- è™½ç„¶ä¹‹å‰è¡¨ç°æœ€å¥½çš„ EfficientNet çš„æ¨¡å‹æ˜¯åœ¨ 600 * 600 çš„å›¾ç‰‡ä¸Šåšçš„ï¼Œè€Œ Swin Base æ˜¯åœ¨ 384 * 384 çš„å›¾ç‰‡ä¸Šåšçš„ï¼Œæ‰€ä»¥è¯´ EfficientNet æœ‰ä¸€äº›ä¼˜åŠ¿ï¼Œä½†æ˜¯ä»æ¨¡å‹çš„å‚æ•°å’Œè®¡ç®—çš„ FLOPs ä¸Šæ¥è¯´ EfficientNet åªæœ‰ 66Mï¼Œè€Œä¸”åªç”¨äº† 37G çš„ FLOPsï¼Œä½†æ˜¯ Swin Transformer ç”¨äº† 88M çš„æ¨¡å‹å‚æ•°ï¼Œè€Œä¸”ç”¨äº† 47G çš„ FLOPsï¼Œæ‰€ä»¥æ€»ä½“è€Œè¨€æ˜¯ä¼¯ä»²ä¹‹é—´
- è¡¨æ ¼çš„ä¸‹åŠéƒ¨åˆ†æ˜¯ç”¨ ImageNet-22k å»åšé¢„è®­ç»ƒï¼Œç„¶åå†åœ¨ ImageNet-1k ä¸Šå¾®è°ƒæœ€åå¾—åˆ°çš„ç»“æœ
- è¿™é‡Œå¯ä»¥çœ‹åˆ°ï¼Œä¸€æ—¦ä½¿ç”¨äº†æ›´å¤§è§„æ¨¡çš„æ•°æ®é›†ï¼ŒåŸå§‹æ ‡å‡†çš„ ViT çš„æ€§èƒ½ä¹Ÿå°±å·²ç»ä¸Šæ¥äº†ï¼Œå¯¹äº ViT large æ¥è¯´å®ƒå·²ç»èƒ½å¾—åˆ° 85.2 çš„å‡†ç¡®åº¦äº†ï¼Œå·²ç»ç›¸å½“é«˜äº†
- ä½†æ˜¯ Swin Large æ›´é«˜ï¼ŒSwin Large æœ€åèƒ½åˆ°87.3ï¼Œè¿™ä¸ªæ˜¯åœ¨ä¸ä½¿ç”¨ JFT-300Mï¼Œå°±æ˜¯ç‰¹åˆ«å¤§è§„æ¨¡æ•°æ®é›†ä¸Šå¾—åˆ°çš„ç»“æœï¼Œæ‰€ä»¥è¿˜æ˜¯ç›¸å½“é«˜çš„

æ¥ä¸‹æ¥æ˜¯ç›®æ ‡æ£€æµ‹çš„ç»“æœï¼Œä½œè€…æ˜¯åœ¨ COCO æ•°æ®é›†ä¸Šè®­ç»ƒå¹¶ä¸”è¿›è¡Œæµ‹è¯•çš„ï¼Œç»“æœå¦‚ä¸‹å›¾æ‰€ç¤º

{% asset_img 26.png %}

- è¡¨2ï¼ˆaï¼‰ä¸­æµ‹è¯•äº†åœ¨ä¸åŒçš„ç®—æ³•æ¡†æ¶ä¸‹ï¼ŒSwin Transformer åˆ°åº•æ¯”å·ç§¯ç¥ç»ç½‘ç»œè¦å¥½å¤šå°‘ï¼Œä¸»è¦æ˜¯æƒ³è¯æ˜ Swin Transformer æ˜¯å¯ä»¥å½“åšä¸€ä¸ªé€šç”¨çš„éª¨å¹²ç½‘ç»œæ¥ä½¿ç”¨çš„ï¼Œæ‰€ä»¥ç”¨äº† Mask R-CNNã€ATSSã€RepPointsV2 å’ŒSparseR-CNNï¼Œè¿™äº›éƒ½æ˜¯è¡¨ç°éå¸¸å¥½çš„ä¸€äº›ç®—æ³•ï¼Œåœ¨è¿™äº›ç®—æ³•é‡Œï¼Œè¿‡å»çš„éª¨å¹²ç½‘ç»œé€‰ç”¨çš„éƒ½æ˜¯ ResNet-50ï¼Œç°åœ¨æ›¿æ¢æˆäº† Swin Tiny
- Swin Tiny çš„å‚æ•°é‡å’Œ FLOPs è·Ÿ ResNet-50 æ˜¯æ¯”è¾ƒä¸€è‡´çš„ï¼Œä»åé¢çš„å¯¹æ¯”é‡Œä¹Ÿå¯ä»¥çœ‹å‡ºæ¥ï¼Œæ‰€ä»¥ä»–ä»¬ä¹‹é—´çš„æ¯”è¾ƒæ˜¯ç›¸å¯¹æ¯”è¾ƒå…¬å¹³çš„
- å¯ä»¥çœ‹åˆ°ï¼ŒSwin Tiny å¯¹ ResNet-50 æ˜¯å…¨æ–¹ä½çš„ç¢¾å‹ï¼Œåœ¨å››ä¸ªç®—æ³•ä¸Šéƒ½è¶…è¿‡äº†å®ƒï¼Œè€Œä¸”è¶…è¿‡çš„å¹…åº¦ä¹Ÿæ˜¯æ¯”è¾ƒå¤§çš„
- æ¥ä¸‹æ¥ä½œè€…åˆæ¢äº†ä¸€ä¸ªæ–¹å¼åšæµ‹è¯•ï¼Œç°åœ¨æ˜¯é€‰å®šä¸€ä¸ªç®—æ³•ï¼Œé€‰å®šäº† Cascade Mask R-CNN è¿™ä¸ªç®—æ³•ï¼Œç„¶åæ¢æ›´å¤šçš„ä¸åŒçš„éª¨å¹²ç½‘ç»œï¼Œæ¯”å¦‚ DeiT-Sã€ResNet-50 å’Œ ResNet-101ï¼Œä¹Ÿåˆ†äº†å‡ ç»„ï¼Œç»“æœå¦‚ä¸Šå›¾ä¸­è¡¨2ï¼ˆbï¼‰æ‰€ç¤º
- å¯ä»¥çœ‹å‡ºï¼Œåœ¨ç›¸ä¼¼çš„æ¨¡å‹å‚æ•°å’Œç›¸ä¼¼çš„ Flops ä¹‹ä¸‹ï¼ŒSwin Transformer éƒ½æ˜¯æ¯”ä¹‹å‰çš„éª¨å¹²ç½‘ç»œè¦è¡¨ç°å¥½çš„
- æ¥ä¸‹æ¥ä½œè€…åˆåšäº†ç¬¬ä¸‰ç§æµ‹è¯•çš„æ–¹å¼ï¼Œå¦‚ä¸Šå›¾ä¸­çš„è¡¨2ï¼ˆcï¼‰æ‰€ç¤ºï¼Œå°±æ˜¯ç³»ç»Ÿå±‚é¢çš„æ¯”è¾ƒï¼Œè¿™ä¸ªå±‚é¢çš„æ¯”è¾ƒå°±æ¯”è¾ƒç‹‚é‡äº†ï¼Œå°±æ˜¯ç°åœ¨è¿½æ±‚çš„ä¸æ˜¯å…¬å¹³æ¯”è¾ƒï¼Œä»€ä¹ˆæ–¹æ³•éƒ½å¯ä»¥ä¸Šï¼Œå¯ä»¥ä½¿ç”¨æ›´å¤šçš„æ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨æ›´å¤šçš„æ•°æ®å¢å¼ºï¼Œç”šè‡³å¯ä»¥åœ¨æµ‹è¯•çš„ä½¿ç”¨ test time augmentationï¼ˆTTAï¼‰çš„æ–¹å¼
- å¯ä»¥çœ‹åˆ°ï¼Œä¹‹å‰æœ€å¥½çš„æ–¹æ³• Copy-paste åœ¨ COCO Validation Setä¸Šçš„ç»“æœæ˜¯55.9ï¼Œåœ¨ Test Set ä¸Šçš„ç»“æœæ˜¯ 56ï¼Œè€Œè¿™é‡Œå¦‚æœè·Ÿæœ€å¤§çš„ Swin Transformer--Swin Large æ¯”ï¼Œå®ƒçš„ç»“æœåˆ†åˆ«èƒ½è¾¾åˆ° 58 å’Œ 58.7ï¼Œè¿™éƒ½æ¯”ä¹‹å‰é«˜äº†ä¸¤åˆ°ä¸‰ä¸ªç‚¹

ç¬¬ä¸‰ä¸ªå®éªŒä½œè€…é€‰æ‹©äº†è¯­ä¹‰åˆ†å‰²é‡Œçš„ADE20Kæ•°æ®é›†ï¼Œç»“æœå¦‚ä¸‹å›¾æ‰€ç¤º

{% asset_img 27.png %}

- ä¸Šå›¾è¡¨ 3 é‡Œå¯ä»¥çœ‹åˆ°ä¹‹å‰çš„æ–¹æ³•ï¼Œä¸€ç›´åˆ° DeepLab V3ã€ResNet å…¶å®éƒ½ç”¨çš„æ˜¯å·ç§¯ç¥ç»ç½‘ç»œï¼Œä¹‹å‰çš„è¿™äº›æ–¹æ³•å…¶å®éƒ½åœ¨ 44ã€45 å·¦å³å¾˜å¾Š
- ä½†æ˜¯ç´§æ¥ç€ Vision Transformer å°±æ¥äº†ï¼Œé‚£é¦–å…ˆå°±æ˜¯ SETR è¿™ç¯‡è®ºæ–‡ï¼Œä»–ä»¬ç”¨äº† ViT Largeï¼Œæ‰€ä»¥å°±å–å¾—äº† 50.3 çš„è¿™ä¸ªç»“æœ
- Swin Transformer Large ä¹Ÿå–å¾—äº† 53.5 çš„ç»“æœï¼Œå°±åˆ·çš„æ›´é«˜äº†
- å…¶å®ä½œè€…è¿™é‡Œä¹Ÿæœ‰æ ‡æ³¨ï¼Œå°±æ˜¯æœ‰ä¸¤ä¸ªâ€œ+â€å·çš„ï¼Œæ„æ€æ˜¯è¯´è¿™äº›æ¨¡å‹æ˜¯åœ¨ ImageNet-22K æ•°æ®é›†ä¸Šåšé¢„è®­ç»ƒï¼Œæ‰€ä»¥ç»“æœæ‰è¿™ä¹ˆå¥½

æ¶ˆèå®éªŒçš„å®éªŒç»“æœå¦‚ä¸‹å›¾æ‰€ç¤º

{% asset_img 28.png %}

- ä¸Šå›¾ä¸­è¡¨ 4 ä¸»è¦å°±æ˜¯æƒ³è¯´ä¸€ä¸‹ç§»åŠ¨çª—å£ä»¥åŠç›¸å¯¹ä½ç½®ç¼–ç åˆ°åº•å¯¹ Swin Transformer æœ‰å¤šæœ‰ç”¨
- å¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœå…‰åˆ†ç±»ä»»åŠ¡çš„è¯ï¼Œå…¶å®ä¸è®ºæ˜¯ç§»åŠ¨çª—å£ï¼Œè¿˜æ˜¯ç›¸å¯¹ä½ç½®ç¼–ç ï¼Œå®ƒçš„æå‡ç›¸å¯¹äºåŸºçº¿æ¥è¯´ï¼Œä¹Ÿæ²¡æœ‰ç‰¹åˆ«æ˜æ˜¾ï¼Œå½“ç„¶åœ¨ ImageNet çš„è¿™ä¸ªæ•°æ®é›†ä¸Šæå‡ä¸€ä¸ªç‚¹ä¹Ÿç®—æ˜¯å¾ˆæ˜¾è‘—äº†
- ä½†æ˜¯ä»–ä»¬æ›´å¤§çš„å¸®åŠ©ï¼Œä¸»è¦æ˜¯å‡ºç°åœ¨ä¸‹æ¸¸ä»»åŠ¡é‡Œï¼Œå°±æ˜¯ COCO å’Œ ADE20K è¿™ä¸¤ä¸ªæ•°æ®é›†ä¸Šï¼Œä¹Ÿå°±æ˜¯ç›®æ ‡æ£€æµ‹å’Œè¯­ä¹‰åˆ†å‰²è¿™ä¸¤ä¸ªä»»åŠ¡ä¸Š
- å¯ä»¥çœ‹åˆ°ï¼Œç”¨äº†ç§»åŠ¨çª—å£å’Œç›¸å¯¹ä½ç½®ç¼–ç ä»¥åï¼Œéƒ½ä¼šæ¯”ä¹‹å‰å¤§æ¦‚é«˜äº† 3 ä¸ªç‚¹å·¦å³ï¼Œæå‡æ˜¯éå¸¸æ˜¾è‘—çš„ï¼Œè¿™ä¹Ÿæ˜¯åˆç†çš„ï¼Œå› ä¸ºå¦‚æœç°åœ¨å»åšè¿™ç§å¯†é›†å‹é¢„æµ‹ä»»åŠ¡çš„è¯ï¼Œå°±éœ€è¦ç‰¹å¾å¯¹ä½ç½®ä¿¡æ¯æ›´æ•æ„Ÿï¼Œè€Œä¸”æ›´éœ€è¦å‘¨å›´çš„ä¸Šä¸‹æ–‡å…³ç³»ï¼Œæ‰€ä»¥è¯´é€šè¿‡ç§»åŠ¨çª—å£æä¾›çš„çª—å£å’Œçª—å£ä¹‹é—´çš„äº’ç›¸é€šä¿¡ï¼Œä»¥åŠåœ¨æ¯ä¸ª Transformer block éƒ½åšæ›´å‡†ç¡®çš„ç›¸å¯¹ä½ç½®ç¼–ç ï¼Œè‚¯å®šæ˜¯ä¼šå¯¹è¿™ç±»å‹çš„ä¸‹æ¸¸ä»»åŠ¡å¤§æœ‰å¸®åŠ©çš„

***

### ç‚¹è¯„

é™¤äº†ä½œè€…å›¢é˜Ÿè‡ªå·±åœ¨è¿‡å»åŠå¹´ä¸­åˆ·äº†é‚£ä¹ˆå¤šçš„ä»»åŠ¡ï¼Œæ¯”å¦‚è¯´æœ€å¼€å§‹è®²çš„è‡ªç›‘ç£çš„Swin Transformerï¼Œè¿˜æœ‰ Video Swin Transformer ä»¥åŠ Swin MLPï¼ŒåŒæ—¶ Swin Transformer è¿˜è¢«åˆ«çš„ç ”ç©¶è€…ç”¨åˆ°äº†ä¸åŒçš„é¢†åŸŸ

{% asset_img 29.png %}

æ‰€ä»¥è¯´ï¼ŒSwin Transformer çœŸçš„æ˜¯å¤ªç«ï¼ŒçœŸçš„æ˜¯åœ¨è§†è§‰é¢†åŸŸå¤§æ€å››æ–¹ï¼Œæ„Ÿè§‰ä»¥åæ¯ä¸ªä»»åŠ¡éƒ½é€ƒä¸äº†è·Ÿ Swin æ¯”ä¸€æ¯”ï¼Œè€Œä¸”å› ä¸º Swin è¿™ä¹ˆç«ï¼Œæ‰€ä»¥è¯´å…¶å®å¾ˆå¤šå¼€æºåŒ…é‡Œéƒ½æœ‰ Swin çš„å®ç°
- ç™¾åº¦çš„ PaddlePaddle
- è§†è§‰é‡Œç°åœ¨æ¯”è¾ƒç«çš„ pytorch-image-modelsï¼Œå°±æ˜¯ Timm è¿™ä¸ªä»£ç åº“é‡Œé¢ä¹Ÿæ˜¯æœ‰ Swin çš„å®ç°çš„
- åŒæ—¶ Hugging Face ä¼°è®¡ä¹Ÿæ˜¯æœ‰çš„

è™½ç„¶å‰é¢å·²ç»è¯´äº†å¾ˆå¤š Swin Transformer çš„å½±å“åŠ›å•Šå·²ç»è¿™ä¹ˆå·¨å¤§äº†ï¼Œä½†å…¶å®ä»–çš„å½±å“åŠ›è¿œè¿œä¸æ­¢äºæ­¤ï¼Œè®ºæ–‡é‡Œè¿™ç§å¯¹å·ç§¯ç¥ç»ç½‘ç»œï¼Œå¯¹ Transformerï¼Œè¿˜æœ‰å¯¹ MLP è¿™å‡ ç§æ¶æ„æ·±å…¥çš„ç†è§£å’Œåˆ†ææ˜¯å¯ä»¥ç»™æ›´å¤šçš„ç ”ç©¶è€…å¸¦æ¥æ€è€ƒçš„ï¼Œä»è€Œä¸ä»…å¯ä»¥åœ¨è§†è§‰é¢†åŸŸé‡Œæ¿€å‘å‡ºæ›´å¥½çš„å·¥ä½œï¼Œè€Œä¸”åœ¨å¤šæ¨¡æ€é¢†åŸŸé‡Œï¼Œç›¸ä¿¡å®ƒä¹Ÿèƒ½æ¿€å‘å‡ºæ›´å¤šæ›´å¥½çš„å·¥ä½œ

***

### åŸæ–‡é“¾æ¥

> <https://www.bilibili.com/read/cv14877004>
