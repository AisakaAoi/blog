---
title: 深度学习-马尔可夫判别器(PatchGAN)
categories:
  - 🌙进阶学习
  - ⭐人工智能
  - 💫深度学习 Deep Learning
abbrlink: 12a55a8
date: 2022-09-29 14:05:16
tags:
---

### 概念

马尔可夫判别器是判别模型的一种。

基于CNN的分类模型有很多种，很多网络都是在最后引入了一个全连接层，然后将判别的结果输出（输出结点）。

马尔可夫判别器则是不一样，**直观来看，它完全由卷积层构成，最后输出的是一个 n * n 的矩阵，最后取输出矩阵的均值作为True/False的输出。**

事实上，输出矩阵中的每一个输出，代表着原图中一个感受野，对应了原图的一片（patch），而具有这样结构的GAN被称为PatchGAN。

<!--more-->

***

### 优点和应用

目前来看，**在图像风格迁移领域中**，我们这里沿用Gatys论文中关于风格迁移的想法，**即风格迁移分为两部分：内容部分和纹理部分。**

- 内容部分是指生成图像和原图像在内容（语义）上的相似性
- 纹理部分是指生成图像和目标图像在纹理上的相似性

马尔可夫判别器对于风格迁移中的超高分辨率、图片清晰化有一定的高分辨率、高细节的保持。

目前，马尔可夫判别器用于Pix2Pix和CycleGAN等GAN网络中。

***

### 感受域计算

**每一层感受域的计算公式为：**input_size = (output_size-1)*k_stride+k_size

- 感受域：输出结点（输出网络中的每个结点）对输入网络的感受野的范围（可以从输出网络大小反推感受野的大小）
- input_size：为输出结点感受域的大小
- k_stride：卷积核的移动步长
- k_size：输入输出之间卷积核的大小

以之前分析的CycleGAN代码中的马尔可夫判别器为例：

{% asset_img 1.webp %}

last_conv输出（k_stride=1），假设其中一个节点，即output_size=1，计算得到CK4的大小（input_size）为4。同理，假设CK4_size = 4，则CK3_size = (4 - 1) * 2 + 4 = 10，CK2_size = (10 - 1) * 2 + 4 = 22，CK1_size = (22 - 1) * 2 + 4 = 46，input的感受域大小为94

***

### 参考资料

> <https://www.likecs.com/show-204955112.html>
