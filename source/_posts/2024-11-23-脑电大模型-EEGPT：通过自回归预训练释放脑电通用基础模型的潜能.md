---
title: 脑电大模型 | EEGPT：通过自回归预训练释放脑电通用基础模型的潜能
categories:
  - 🌙进阶学习
  - ⭐脑机接口与混合智能研究团队（BCI团队）
  - 💫学习报告
abbrlink: 29d8fe92
date: 2024-11-23 05:39:29
tags:
---

{% asset_img 1.webp %}

该论文的标题为《EEGPT: Unleashing the Potential of EEG Generalist Foundation Model by Autoregressive Pre-training》，虽然作者信息未提及，但它被提交至ICLR 2025 Conference（2025年国际学习表征会议）。尽管在双盲评审过程中没有获得认可，这篇论文仍然展示了预训练大型模型在脑电图（EEG）处理领域的应用潜力。

论文链接：https://openreview.net/forum?id=wJ6Bx1IYrQ

<!--more-->

***

### 论文概要

脑电图（EEG）信号在揭示自发性大脑活动方面至关重要，对神经科学研究具有显著的重要性。然而，由于数据格式的多样性、预训练范式的过时以及迁移学习方法的局限性，通用EEG模型的发展受到了限制，目前仅存在针对单一数据集的专用模型。本研究提出了首个通用EEG基础模型EEGPT，旨在解决这些挑战。

首先，本研究提出了一种电极式建模策略，将每个电极作为基本处理单元，从而成功整合源自多达 138 个电极的不同 EEG 数据集，为模型预训练积累了 3750 万样本。其次，本研究开创性地引入首个自回归EEG 预训练模型，能够更有效地捕捉数据中的时序依赖关系。此外，本研究提出一种多任务迁移学习范式，构建跨任务共享的可学习电极图网络，且证实了多任务间的兼容性和协同增效作用。

EEGPT 具备广泛的兼容性，可适配各种信号采集设备、不同受试者及多种任务，支持多达 138 个电极及其任意组合作为输入。在性能表现上，如图1所示，通过在 12 个基准的数据集上的 5 个下游任务中进行同步评估，EEGPT 在所有任务中的准确率均超越现有专用模型。

{% asset_img 2.webp %}
<div align='center'>图1</div>

***

### 研究背景

EEG被视为大脑的 “语言”，被广泛应用于情绪识别、运动想象分类等多个神经科学研究领域。然而，当前 EEG 研究存在诸多局限。

在数据层面，不同的研究和数据采集使用了不同的系统和设备进行数据采集，使用的电极数量和组合也不尽相同，导致数据格式多样。当前研究中常采用针对特定任务或数据集设计的数据格式和手工特征提取技术，通用性差，难以推广到其他任务或数据集。

在模型层面，目前大多数 EEG 研究在模型设计和训练上高度专业化，现有模型多针对特定任务、数据集或个体设计，缺乏通用性和跨任务能力。

在预训练与迁移学习层面，当前的研究中，自监督预训练主要采用掩码自编码器（MAE）技术，难以捕捉 EEG 数据的时序依赖。且 EEG 领域的迁移学习方法发展不足，当前预训练模型多只能在特定数据集微调，难以实现跨任务的通用与协同。

***

### 研究方法

#### 自回归时间序列建模（Autoregressive Time Series Modeling）

这一阶段的目的是开发一个全面而详细的自监督学习范式，能够准确、高效地捕获EEG信号中的内在时间变化。

在数据处理方面，本研究采用了电极建模策略（Electrode - wise Modeling Strategy）。S首先，研究人员从多个来源收集 EEG 数据，每个样本xi∈ℝEi×T×C对应一个包含Ei个电极的集合ℰi，具有在电极Ei、T个时间间隔和C个采样点三个维度上的信息。然后，为了深入挖掘 每个电极所特有的信息，引入了结构化重组函数ℛ(·)按电极分割每个样本xi为xℯi∈ℝT×C，使来自不同数据源但具有相同电极的数据记录分组在一起，具体而言：

{% asset_img 3.webp %}

其中De={xℯi |e∈ℰi , i=1,2,··· ,N}。 最后为了在模型中区分不同的电极，进一步引入了可训练的电极词汇表vE，在每个分组De中的所有元素都共享一个电极嵌入veE，这个电极嵌入作为一种条件信息，通过连接操作（用||表示）与分组De中的所有数据在序列维度上进行合并，得到新的序列，具体而言：

{% asset_img 4.webp %}

这使得来自各种不同源和电极的信号被转换为高度统一且可扩展的标准化格式，包含T+1 个EEG “标记”的数据xℯi（连接前是T个标记）成为后续自回归重构的基本处理单元。

数据被输入到共享的电极时间编码器( Electrode Temporal Encoder，ETE )中进行自回归重建。ETE 由多个相同结构的层组成，每层有两个子层：一是多头因果注意力机制子层，该子层的输出经过归一化处理后，再通过残差连接与输入相加，有助于信息有效传递和稳定训练。二是位置全连接前馈网络子层，采用 SwiGLU 激活函数，为网络引入非线性，增强模型表达能力，进一步处理数据以提取更复杂的特征。ETE 的输出通过一个简单多层感知机（MLP）转换为下一个标记的预测。这个预测过程是自回归模型的核心，它基于之前的输入信号来预测下一个时刻的信号值，从而逐步构建出整个时间序列的预测结果。

***

#### 任务共享电极图（Task-shared Electrode Graph）

这一阶段，提出了一个任务共享的电极图(TEG)网络。该网络自适应地激活各个电极之间的相互作用，以同时支持多个任务。

首先进行电极表征提取，对于多任务数据集中的每个样本yj，引入一个可学习的特殊标记，这个特殊标记被广播到所有电极并添加到时间序列末尾。这样的操作使得特殊标记能够在自回归模型的单向注意力机制的帮助下，整合来自各个电极的局部信息，合成更具全局代表性的表示。经过特殊标记处理后的数据被输入到先前训练好的电极时间编码器（ETE）中，此时 ETE 的参数不再更新，仅作为特征提取的骨干网络。每个样本yj生成了捕获了全面时间信息的电极表征zj。

然后构建以预训练阶段使用的电极为节点的全连通图网络G，结点总数为|ℛ(X)|, 涵盖多任务数据集中几乎所有可能使用到的电极。当zj被引入到网络中时，它所包含电极对应G中的节点才会被激活。激活更新后的图G通过图注意力机制促进电极间空间信息的流动和交互：

{% asset_img 5.webp %}

其中αmn为节点m和n间的注意力系数，W和α是可学习的映射权重，hm是节点m在图中的表示，N(m)表示节点m的邻居。对于每个电极表征zj，引入一个掩蔽系数β，如果m和n都在其中，则βmn等于1，否则为0。基于得到的注意力系数，节点之间的交互关系如下：

{% asset_img 6.webp %}

最终，EEGPT的整体架构如图2所示：

{% asset_img 7.webp %}
<div align='center'>图2</div>

左侧：预训练目标的目标是进行自回归重建，每个信号标记通过电极时序编码器(ETE )逐一预测下一个标记。右侧：多任务中数据集的电极通过预训练的ETE进行处理，提取最终的电极表示，然后将其输入到任务共享电极图(TEG )网络中，以整合多个电极之间的空间信息。ETE和TEG共同构成了渐进的时空解耦。

***

### 实验设计

本研究开发了EEGPT的4种架构配置：EEGPT - Base、EEGPT - Large、EEGPT - Huge和EEGPT - Giant。为了更详细地分析标度律，请参见表1：

{% asset_img 8.webp %}
<div align='center'>表1 EEGPT模型的配置</div>

本研究选取的比较基准模型分为两类：第一类模型在各自的数据集上从头开始训练，不需要任何预训练；第二类在各自的数据集上使用继承的预训练参数进行微调。如表2所示，作者在5个不同的任务（情感识别ER、运动想象分类MI、脑力负荷检测MW、睡眠分期SS，跨模态任务CM）中使用12个数据集来评估EEGPT。

{% asset_img 9.webp %}
<div align='center'>表2 不同任务中使用到的数据集</div>

实验采用了跨被试范式，将每个数据集按照8：1：1的比例划分为训练集、验证集和测试集，并且确保这些划分间没有受试者的重叠。

***

### 结果分析

实验数据显示，EEGPT - Giant在ER、MI、MW、SS、CM任务上分别取得了5.07 %、 6.05 %、 8.50 %、 11.20 %、 5.10 %的平均准确率提升，表明EEGPT虽然是一个通用模型，但始终优于针对特定任务进行微调的专用模型。表3给出了12个数据集的性能比较：

{% asset_img 10.webp %}
<div align='center'>表3 12个数据集的性能比较</div>

列" One Model ? "表示这些基准的结果是否来自同一模型。实验结果表明，随着模型规模的扩大，性能存在明显且一致的上升趋势。有趣的是，经过预训练的专用模型似乎比从零开始训练的专业模型表现略差，可能是由于预训练采用的数据和下游任务采用的数据存在较大领域差异，妨碍了迁移学习的效果。

在消融实验部分，得到结论：随着模型参数增加，对预训练数据的拟合更好，性能提升；增加预训练数据量可提升性能，但提升幅度逐渐减小；联合多任务训练优于单独训练，共享节点（电极）提供了数据增强；在未见过的 DREAMER 数据集上，EEGPT 的表现出强可转移性，能有效聚类不同模式的信号，具有较强的泛化能力。

***

### 结论

本文提出了首个通用EEG基础模型EEGPT。通过引入电极建模策略、开发自回归预训练方法以及实施带有可学习电极图网络的多任务迁移学习范式，EEGPT统一了多样的EEG数据集，并捕捉了EEG信号中固有的顺序和时间依赖关系。模型在基准测试中表现出色，展示了其多功能性和可扩展性。EEGPT将激发通用型EEG模型的进一步研究和开发。

***

### 附录：近2年脑电信号大模型的相关论文对比

《Large Brain Model for Learning Generic Representations with Tremendous EEG Data in BCI》：受大语言模型的启发，提出了一个名为大脑大模型（LaBraM）的统一 EEG 基础模型 。模型通过分割 EEG 信号为通道补丁和向量量化神经频谱预测，在来自约 20 个数据集的大约 2500 小时的各种类型的 EEG 信号上进行预训练，能处理不同电极配置和长度的 EEG 数据。

《NEUROLM: A UNIVERSAL MULTI-TASK FOUNDATION MODEL FOR BRIDGING THE GAP BETWEEN LANGUAGE AND EEG SIGNALS》：提出多任务基础模型NeuroLM ，将 EEG 信号视为外语，融入大语言模型框架。通过文本对齐的神经标记器编码EEG信号、多通道自回归预训练和多任务指令调整，实现多任务学习和推理。

《FoME: A Foundation Model for EEG using Adaptive Temporal-Lateral Attention Scaling》：提出 FoME （脑电图基础模型），开创性地采用时间 - 频率融合嵌入技术和自适应时间 - 横向注意力缩放（ATLAS）机制处理EEG信号，捕捉其复杂的时空动态，适应不同数据集，促进稳健的多通道建模。

《Brant - X: A Unified Physiological Signal Alignment Framework》：提出 Brant - X 模型，用于对 EEG 与其他生理信号之间的相关性进行建模。利用 EEG 基础模型，通过两级对齐策略（补丁级和序列级），有效对齐 EEG 与其他信号（EOG、ECG、EMG）的语义。

《EEGPT: Pretrained Transformer for Universal and Reliable Representation of EEG Signals》：提出用于通用 EEG 特征提取的EEGPT 模型，设计了双自监督学习方法，结合时空表示对齐和掩码重建，提高特征质量和模型收敛性，为 EEG 信号处理提供有效的创新解决方案。

***

### 原文链接

> <https://www.scholat.com/teamwork/showPostMessage.html?id=16452>
