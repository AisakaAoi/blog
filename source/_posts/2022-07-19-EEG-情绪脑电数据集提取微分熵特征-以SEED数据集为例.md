---
title: EEG-æƒ…ç»ªè„‘ç”µæ•°æ®é›†æå–å¾®åˆ†ç†µç‰¹å¾(ä»¥SEEDæ•°æ®é›†ä¸ºä¾‹)
categories:
  - ğŸŒ™è¿›é˜¶å­¦ä¹ 
  - â­äººå·¥æ™ºèƒ½ Artificial Intelligence
  - ğŸ’«ç ”ç©¶é¢†åŸŸ Research Area
  - ğŸ›°ï¸è„‘æœºæ¥å£ Brain-computer Interface
  - â˜„ï¸æƒ…ç»ªè¯†åˆ« Emotion Recognition
abbrlink: '5529753'
date: 2022-07-19 19:53:06
tags:
---

### å‰è¨€

SEEDæ•°æ®é›†æ˜¯å¸¸ç”¨çš„è„‘ç”µä¿¡å·æƒ…ç»ªè¯†åˆ«æ•°æ®é›†ï¼Œåœ¨è¯¥æ•°æ®é›†çš„Preprocessed_EEGæ–‡ä»¶å¤¹ä¸­æ˜¯åŸå§‹çš„è„‘ç”µæ•°æ®ï¼Œåœ¨ExtractedFeaturesæ–‡ä»¶å¤¹ä¸­æ˜¯å®˜æ–¹æå–ç‰¹å¾åçš„æ•°æ®(æå–äº†å¤šç§ç‰¹å¾å¯ç›´æ¥ä½¿ç”¨)ã€‚

æ—¢ç„¶å®˜æ–¹å·²ç»æŠŠç‰¹å¾æå–å¥½äº†ä¸ºä»€ä¹ˆè¿˜è¦è‡ªå·±åšç‰¹å¾æå–ï¼Ÿ
1. å®˜æ–¹å¹¶æ²¡æœ‰å¼€æºæå–ç‰¹å¾çš„ä»£ç ã€‚
2. ä¸ºäº†å¤„ç†å…¶ä»–æ•°æ®é›†æˆ–è€…è‡ªå·±çš„æ•°æ®ã€‚
3. å¾®åˆ†ç†µ(de)ä½œä¸ºè„‘ç”µä¸­éå¸¸å¥½çš„è„‘ç”µç‰¹å¾ç›®å‰åœ¨ç½‘ä¸Šå´å¾ˆéš¾æ‰¾åˆ°å®ç°çš„æ–¹æ³•ï¼Œæ”¶è´¹çš„ä»£ç å¤§å¤šä¹Ÿæ˜¯é”™çš„æˆ–è€…æ˜¯ä¸å®Œæ•´çš„ã€‚

<!--more-->

***

### å¸¦é€šæ»¤æ³¢å™¨

äººç±»çš„è„‘ç”µå›¾ä¸­è„‘æ³¢é¢‘ç‡å¯ä»¥åœ¨0.5åˆ°å‡ åèµ«å…¹ï¼Œé€šå¸¸æŒ‰ç…§é¢‘ç‡è¿›è¡Œåˆ†ç±»ä»¥è¡¨ç¤ºå„ç§æˆåˆ†ï¼š
Î´æ³¢(0.5-4Hz) ï¼ŒÎ¸æ³¢(4-8Hz)ï¼ŒÎ±æ³¢(8-13Hz)ï¼ŒÎ²æ³¢(13-32Hz)ï¼ŒÎ³æ³¢(32-50Hz)ï¼Œè¿™ä¸ªåœ°æ–¹å¾ˆå¤šäººå†™çš„é¢‘ç‡èŒƒå›´éƒ½ä¸å¤§ä¸€æ ·ä½†ä¹Ÿæ²¡æœ‰å¾ˆå¤§çš„å·®åˆ«ã€‚æˆ‘ä»¬è¿™é‡Œä½¿ç”¨å¸¦é€šæ»¤æ³¢å™¨æ¥å®ç°é¢‘æ®µçš„æå–ã€‚

#### å¸¦é€šæ»¤æ³¢å™¨ä»£ç å®ç°

``` python
from scipy import signal

fStart = [0.5, 4, 8, 13, 32]	# è¿™é‡Œæ˜¯èµ·å§‹é¢‘ç‡
fEnd = [4, 8, 13, 32, 50]	# è¿™é‡Œæ˜¯ç»ˆæ­¢é¢‘ç‡

results = []
for band_index, band in enumerate(fStart):
    b, a = signal.butter(4, [fStart[band_index]/fs, fEnd[band_index]/fs], 'bandpass')  # é…ç½®æ»¤æ³¢å™¨ 4 è¡¨ç¤ºæ»¤æ³¢å™¨çš„é˜¶æ•°
    result = signal.filtfilt(b, a, data)  # dataä¸ºè¦è¿‡æ»¤çš„ä¿¡å·
    results.append(result)
```

æœ€ç»ˆæå–åˆ°çš„äº”ä¸ªé¢‘æ®µéƒ½ä¼šå­˜å…¥ results ä¸­ã€‚

***

### å¾®åˆ†ç†µ

å¾®åˆ†ç†µå®é™…ä¸Šæ˜¯é¦™å†œç†µåœ¨è¿ç»­ä¿¡å·ä¸Šçš„æ¨å¹¿

é¦™å†œç†µï¼šå¯¹æ¦‚ç‡åˆ†å¸ƒä¸­çš„ä¸ç¡®å®šæ€§æ€»é‡è¿›è¡Œé‡åŒ–ï¼Œå…¬å¼å¦‚ä¸‹ï¼š
{% asset_img 1.webp %}

å¾®åˆ†ç†µï¼šå¯¹è¿ç»­æ€§éšæœºå˜é‡çš„æ¦‚ç‡åˆ†å¸ƒä¸­çš„ä¸ç¡®å®šæ€§æ€»é‡è¿›è¡Œé‡åŒ–ï¼Œå…¬å¼å¦‚ä¸‹ï¼š
{% asset_img 2.webp %}

#### å¾®åˆ†ç†µä»£ç å®ç°

``` python
def compute_DE(signal):
    variance = np.var(signal, ddof=1)  # æ±‚å¾—æ–¹å·®
    return math.log(2 * math.pi * math.e * variance) / 2  # å¾®åˆ†ç†µæ±‚å–å…¬å¼
```

è¿™ä¸ªä»£ç çœ‹èµ·æ¥è²Œä¼¼å’Œä¸Šé¢çš„å…¬å¼ä¸ä¸€æ ·ï¼Œå®é™…ä¸Šè¿™ä¸ªæ˜¯å¾®åˆ†ç†µçš„åŒ–ç®€å¼ã€‚

***

### å®Œæ•´ä»£ç ï¼ˆSEEDæ•°æ®é›†ï¼‰

``` python
from scipy.io import loadmat
from sklearn.preprocessing import MinMaxScaler
from scipy import signal
import numpy as np
import math
import os


def compute_DE(signal):
    variance = np.var(signal, ddof=1)  # æ±‚å¾—æ–¹å·®
    return math.log(2 * math.pi * math.e * variance) / 2  # å¾®åˆ†ç†µæ±‚å–å…¬å¼


def load_data():
    data_dir = "../SEED/Preprocessed_EEG/"	# è¿™é‡Œè®¾ç½®ä¸ºæ•°æ®é›†ç›¸åº”çš„è·¯å¾„
    fs = 200
    fStart = [0.5, 4, 8, 13, 32]
    fEnd = [4, 8, 13, 32, 50]
    channel = [3, 7, 13, 23]	# è¿™é‡Œæˆ‘é€‰å–äº†å››ä¸ªå¯¼è”è¿›è¡Œè®­ç»ƒï¼ˆAF3ï¼ŒF3ï¼ŒF8ï¼ŒT7ï¼‰

    filename_label = "label"
    label = loadmat(data_dir + filename_label)
    label = label["label"][0]

    datasets_X, datasets_y = [], []
    for filename_data in os.listdir(data_dir):
        if filename_data in ["label.mat", "readme.txt"]:
            continue
        data_all = loadmat(data_dir + filename_data)
        scenes = list(data_all.keys())[3:]
        for index, scene in enumerate(scenes):
            dataset_X = []
            data = data_all[scene][channel]	# å¦‚æœæƒ³ç”¨ä¸Šå…¨éƒ¨å¯¼è”è¿›è¡Œè®­ç»ƒåˆ™å°†è¯¥è¡Œæ”¹ä¸ºdata = data_all[scene]
            scaler = MinMaxScaler()
            data = scaler.fit_transform(data)  # å½’ä¸€åŒ–

            for band_index, band in enumerate(fStart):
                b, a = signal.butter(4, [fStart[band_index]/fs, fEnd[band_index]/fs], 'bandpass')  # é…ç½®æ»¤æ³¢å™¨ 4 è¡¨ç¤ºæ»¤æ³¢å™¨çš„é˜¶æ•°
                filtedData = signal.filtfilt(b, a, data)  # dataä¸ºè¦è¿‡æ»¤çš„ä¿¡å·
                filtedData_de = []

                for lead in range(len(channel)):
                    filtedData_split = []
                    # è®¡ç®—å¾®åˆ†ç†µ
                    for de_index in range(0, filtedData.shape[1] - fs, fs):
                        filtedData_split.append(compute_DE(filtedData[lead, de_index: de_index + fs]))
                    # è¿™é‡Œå°†æ¯ä¸ªæ ·æœ¬å¤§å°è¿›è¡Œç»Ÿä¸€ï¼Œå¦‚æœæƒ³é€šè¿‡æ»‘åŠ¨çª—å£æˆªå–æ ·æœ¬å¯åœ¨è¿™ä¸€è¡Œä¸‹é¢è‡ªè¡Œä¿®æ”¹
                    if len(filtedData_split) < 265:
                        filtedData_split += [0.5] * (265-len(filtedData_split))
                    filtedData_de.append(filtedData_split)
                filtedData_de = np.array(filtedData_de)
                dataset_X.append(filtedData_de)


            datasets_X.append(dataset_X)
            datasets_y.append(label[index])

    datasets_X, datasets_y = np.array(datasets_X), np.array(datasets_y)


if __name__ == "__main__":
    datasets_X, datasets_y = load_data()
    print(datasets_X.shape)
    print(datasets_y.shape)
```

***

### å‚è€ƒèµ„æ–™

> ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºCSDNåšä¸»ã€Œä½™ç£¬ã€çš„åŸåˆ›æ–‡ç« ï¼Œéµå¾ªCC 4.0 BY-SAç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥åŠæœ¬å£°æ˜ã€‚
> åŸæ–‡é“¾æ¥ï¼šhttps://blog.csdn.net/YuqingF/article/details/125873032
