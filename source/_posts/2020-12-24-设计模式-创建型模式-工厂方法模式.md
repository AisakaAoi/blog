---
title: è®¾è®¡æ¨¡å¼-åˆ›å»ºå‹æ¨¡å¼-å·¥å‚æ–¹æ³•æ¨¡å¼
categories:
  - ğŸŒ™å¤§å­¦è¯¾ç¨‹
abbrlink: b321b3ea
date: 2020-12-24 16:28:09
tags:
---

### å·¥å‚æ–¹æ³•æ¨¡å¼

åœ¨ç°å®ç”Ÿæ´»ä¸­ç¤¾ä¼šåˆ†å·¥è¶Šæ¥è¶Šç»†ï¼Œè¶Šæ¥è¶Šä¸“ä¸šåŒ–ã€‚å„ç§äº§å“æœ‰ä¸“é—¨çš„å·¥å‚ç”Ÿäº§ï¼Œå½»åº•å‘Šåˆ«äº†è‡ªç»™è‡ªè¶³çš„å°å†œç»æµæ—¶ä»£ï¼Œè¿™å¤§å¤§ç¼©çŸ­äº†äº§å“çš„ç”Ÿäº§å‘¨æœŸï¼Œæé«˜äº†ç”Ÿäº§æ•ˆç‡ã€‚åŒæ ·ï¼Œåœ¨è½¯ä»¶å¼€å‘ä¸­èƒ½å¦åšåˆ°è½¯ä»¶å¯¹è±¡çš„ç”Ÿäº§å’Œä½¿ç”¨ç›¸åˆ†ç¦»å‘¢ï¼Ÿèƒ½å¦åœ¨æ»¡è¶³â€œå¼€é—­åŸåˆ™â€çš„å‰æä¸‹ï¼Œå®¢æˆ·éšæ„å¢åˆ æˆ–æ”¹å˜å¯¹è½¯ä»¶ç›¸å…³å¯¹è±¡çš„ä½¿ç”¨å‘¢ï¼Ÿ

åœ¨ã€Šç®€å•å·¥å‚æ¨¡å¼ã€‹ä¸€èŠ‚æˆ‘ä»¬ä»‹ç»äº†ç®€å•å·¥å‚æ¨¡å¼ï¼Œæåˆ°äº†ç®€å•å·¥å‚æ¨¡å¼è¿èƒŒäº†å¼€é—­åŸåˆ™ï¼Œè€Œâ€œå·¥å‚æ–¹æ³•æ¨¡å¼â€æ˜¯å¯¹ç®€å•å·¥å‚æ¨¡å¼çš„è¿›ä¸€æ­¥æŠ½è±¡åŒ–ï¼Œå…¶å¥½å¤„æ˜¯å¯ä»¥ä½¿ç³»ç»Ÿåœ¨ä¸ä¿®æ”¹åŸæ¥ä»£ç çš„æƒ…å†µä¸‹å¼•è¿›æ–°çš„äº§å“ï¼Œå³æ»¡è¶³å¼€é—­åŸåˆ™ã€‚

<!--more-->

**ä¼˜ç‚¹ï¼š**
- ç”¨æˆ·åªéœ€è¦çŸ¥é“å…·ä½“å·¥å‚çš„åç§°å°±å¯å¾—åˆ°æ‰€è¦çš„äº§å“ï¼Œæ— é¡»çŸ¥é“äº§å“çš„å…·ä½“åˆ›å»ºè¿‡ç¨‹ã€‚
- çµæ´»æ€§å¢å¼ºï¼Œå¯¹äºæ–°äº§å“çš„åˆ›å»ºï¼Œåªéœ€å¤šå†™ä¸€ä¸ªç›¸åº”çš„å·¥å‚ç±»ã€‚
- å…¸å‹çš„è§£è€¦æ¡†æ¶ã€‚é«˜å±‚æ¨¡å—åªéœ€è¦çŸ¥é“äº§å“çš„æŠ½è±¡ç±»ï¼Œæ— é¡»å…³å¿ƒå…¶ä»–å®ç°ç±»ï¼Œæ»¡è¶³è¿ªç±³ç‰¹æ³•åˆ™ã€ä¾èµ–å€’ç½®åŸåˆ™å’Œé‡Œæ°æ›¿æ¢åŸåˆ™ã€‚

**ç¼ºç‚¹ï¼š**
- ç±»çš„ä¸ªæ•°å®¹æ˜“è¿‡å¤šï¼Œå¢åŠ å¤æ‚åº¦
- å¢åŠ äº†ç³»ç»Ÿçš„æŠ½è±¡æ€§å’Œç†è§£éš¾åº¦
- æŠ½è±¡äº§å“åªèƒ½ç”Ÿäº§ä¸€ç§äº§å“ï¼Œæ­¤å¼Šç«¯å¯ä½¿ç”¨æŠ½è±¡å·¥å‚æ¨¡å¼è§£å†³ã€‚

**åº”ç”¨åœºæ™¯ï¼š**
- å®¢æˆ·åªçŸ¥é“åˆ›å»ºäº§å“çš„å·¥å‚åï¼Œè€Œä¸çŸ¥é“å…·ä½“çš„äº§å“åã€‚å¦‚ TCL ç”µè§†å·¥å‚ã€æµ·ä¿¡ç”µè§†å·¥å‚ç­‰ã€‚
- åˆ›å»ºå¯¹è±¡çš„ä»»åŠ¡ç”±å¤šä¸ªå…·ä½“å­å·¥å‚ä¸­çš„æŸä¸€ä¸ªå®Œæˆï¼Œè€ŒæŠ½è±¡å·¥å‚åªæä¾›åˆ›å»ºäº§å“çš„æ¥å£ã€‚
- å®¢æˆ·ä¸å…³å¿ƒåˆ›å»ºäº§å“çš„ç»†èŠ‚ï¼Œåªå…³å¿ƒäº§å“çš„å“ç‰Œ

***

### å·¥å‚æ¨¡å¼çš„ç»“æ„ä¸å®ç°

å·¥å‚æ–¹æ³•æ¨¡å¼ç”±æŠ½è±¡å·¥å‚ã€å…·ä½“å·¥å‚ã€æŠ½è±¡äº§å“å’Œå…·ä½“äº§å“ç­‰4ä¸ªè¦ç´ æ„æˆã€‚

#### æ¨¡å¼çš„ç»“æ„

å·¥å‚æ–¹æ³•æ¨¡å¼çš„ä¸»è¦è§’è‰²å¦‚ä¸‹ï¼š

1. æŠ½è±¡å·¥å‚ï¼ˆAbstract Factoryï¼‰ï¼šæä¾›äº†åˆ›å»ºäº§å“çš„æ¥å£ï¼Œè°ƒç”¨è€…é€šè¿‡å®ƒè®¿é—®å…·ä½“å·¥å‚çš„å·¥å‚æ–¹æ³• newProduct() æ¥åˆ›å»ºäº§å“ã€‚
2. å…·ä½“å·¥å‚ï¼ˆConcreteFactoryï¼‰ï¼šä¸»è¦æ˜¯å®ç°æŠ½è±¡å·¥å‚ä¸­çš„æŠ½è±¡æ–¹æ³•ï¼Œå®Œæˆå…·ä½“äº§å“çš„åˆ›å»ºã€‚
3. æŠ½è±¡äº§å“ï¼ˆProductï¼‰ï¼šå®šä¹‰äº†äº§å“çš„è§„èŒƒï¼Œæè¿°äº†äº§å“çš„ä¸»è¦ç‰¹æ€§å’ŒåŠŸèƒ½ã€‚
4. å…·ä½“äº§å“ï¼ˆConcreteProductï¼‰ï¼šå®ç°äº†æŠ½è±¡äº§å“è§’è‰²æ‰€å®šä¹‰çš„æ¥å£ï¼Œç”±å…·ä½“å·¥å‚æ¥åˆ›å»ºï¼Œå®ƒåŒå…·ä½“å·¥å‚ä¹‹é—´ä¸€ä¸€å¯¹åº”ã€‚

{% asset_img 1.gif %}

#### æ¨¡å¼çš„å®ç°

å¦‚å›¾å†™å‡ºçš„ä»£ç å¦‚ä¸‹ï¼š

``` java
package FactoryMethod;
public class AbstractFactoryTest {
    public static void main(String[] args) {
        try {
            Product a;
            AbstractFactory af;
            af = (AbstractFactory) ReadXML1.getObject();
            a = af.newProduct();
            a.show();
        } catch (Exception e) {
            System.out.println(e.getMessage());
        }
    }
}
// æŠ½è±¡äº§å“ï¼šæä¾›äº†äº§å“çš„æ¥å£
interface Product {
    public void show();
}
// å…·ä½“äº§å“1ï¼šå®ç°æŠ½è±¡äº§å“ä¸­çš„æŠ½è±¡æ–¹æ³•
class ConcreteProduct1 implements Product {
    public void show() {
        System.out.println("å…·ä½“äº§å“1æ˜¾ç¤º...");
    }
}
// å…·ä½“äº§å“2ï¼šå®ç°æŠ½è±¡äº§å“ä¸­çš„æŠ½è±¡æ–¹æ³•
class ConcreteProduct2 implements Product {
    public void show() {
        System.out.println("å…·ä½“äº§å“2æ˜¾ç¤º...");
    }
}
// æŠ½è±¡å·¥å‚ï¼šæä¾›äº†å‚å“çš„ç”Ÿæˆæ–¹æ³•
interface AbstractFactory {
    public Product newProduct();
}
// å…·ä½“å·¥å‚1ï¼šå®ç°äº†å‚å“çš„ç”Ÿæˆæ–¹æ³•
class ConcreteFactory1 implements AbstractFactory {
    public Product newProduct() {
        System.out.println("å…·ä½“å·¥å‚1ç”Ÿæˆ-->å…·ä½“äº§å“1...");
        return new ConcreteProduct1();
    }
}
// å…·ä½“å·¥å‚2ï¼šå®ç°äº†å‚å“çš„ç”Ÿæˆæ–¹æ³•
class ConcreteFactory2 implements AbstractFactory {
    public Product newProduct() {
        System.out.println("å…·ä½“å·¥å‚2ç”Ÿæˆ-->å…·ä½“äº§å“2...");
        return new ConcreteProduct2();
    }
}
```

``` java
package FactoryMethod;
import javax.xml.parsers.*;
import org.w3c.dom.*;
import java.io.*;
class ReadXML1 {
    //è¯¥æ–¹æ³•ç”¨äºä»XMLé…ç½®æ–‡ä»¶ä¸­æå–å…·ä½“ç±»ç±»åï¼Œå¹¶è¿”å›ä¸€ä¸ªå®ä¾‹å¯¹è±¡
    public static Object getObject() {
        try {
            //åˆ›å»ºæ–‡æ¡£å¯¹è±¡
            DocumentBuilderFactory dFactory = DocumentBuilderFactory.newInstance();
            DocumentBuilder builder = dFactory.newDocumentBuilder();
            Document doc;
            doc = builder.parse(new File("src/FactoryMethod/config1.xml"));
            //è·å–åŒ…å«ç±»åçš„æ–‡æœ¬èŠ‚ç‚¹
            NodeList nl = doc.getElementsByTagName("className");
            Node classNode = nl.item(0).getFirstChild();
            String cName = "FactoryMethod." + classNode.getNodeValue();
            //System.out.println("æ–°ç±»åï¼š"+cName);
            //é€šè¿‡ç±»åç”Ÿæˆå®ä¾‹å¯¹è±¡å¹¶å°†å…¶è¿”å›
            Class<?> c = Class.forName(cName);
            Object obj = c.newInstance();
            return obj;
        } catch (Exception e) {
            e.printStackTrace();
            return null;
        }
    }
}
```

``` xml
<?xml version="1.0" encoding="UTF-8"?>
<config>
    <className>ConcreteFactory1</className>
</config>
```

ç¨‹åºè¿è¡Œç»“æœå¦‚ä¸‹ï¼š
```
å…·ä½“å·¥å‚1ç”Ÿæˆ-->å…·ä½“äº§å“1...
å…·ä½“äº§å“1æ˜¾ç¤º...
```

å¦‚æœå°† XML é…ç½®æ–‡ä»¶ä¸­çš„ ConcreteFactory1 æ”¹ä¸º ConcreteFactory2ï¼Œåˆ™ç¨‹åºè¿è¡Œç»“æœå¦‚ä¸‹ï¼š

```
å…·ä½“å·¥å‚2ç”Ÿæˆ-->å…·ä½“äº§å“2...
å…·ä½“äº§å“2æ˜¾ç¤º...
```

***

### å·¥å‚æ¨¡å¼çš„åº”ç”¨å®ä¾‹

#### ã€ä¾‹1ã€‘ç”¨å·¥å‚æ–¹æ³•æ¨¡å¼è®¾è®¡ç•œç‰§åœº

åˆ†æï¼šæœ‰å¾ˆå¤šç§ç±»çš„ç•œç‰§åœºï¼Œå¦‚å…»é©¬åœºç”¨äºå…»é©¬ï¼Œå…»ç‰›åœºç”¨äºå…»ç‰›ï¼Œæ‰€ä»¥è¯¥å®ä¾‹ç”¨å·¥å‚æ–¹æ³•æ¨¡å¼æ¯”è¾ƒé€‚åˆã€‚

å¯¹å…»é©¬åœºå’Œå…»ç‰›åœºç­‰å…·ä½“å·¥å‚ç±»ï¼Œåªè¦å®šä¹‰ä¸€ä¸ªç”ŸæˆåŠ¨ç‰©çš„æ–¹æ³• newAnimal() å³å¯ã€‚ç”±äºè¦æ˜¾ç¤ºé©¬ç±»å’Œç‰›ç±»ç­‰å…·ä½“äº§å“ç±»çš„å›¾åƒï¼Œæ‰€ä»¥å®ƒä»¬çš„æ„é€ å‡½æ•°ä¸­ç”¨åˆ°äº† JPanelã€JLabd å’Œ ImageIcon ç­‰ç»„ä»¶ï¼Œå¹¶å®šä¹‰ä¸€ä¸ª show() æ–¹æ³•æ¥æ˜¾ç¤ºå®ƒä»¬ã€‚

å®¢æˆ·ç«¯ç¨‹åºé€šè¿‡å¯¹è±¡ç”Ÿæˆå™¨ç±» ReadXML2 è¯»å– XML é…ç½®æ–‡ä»¶ä¸­çš„æ•°æ®æ¥å†³å®šå…»é©¬è¿˜æ˜¯å…»ç‰›ã€‚å…¶ç»“æ„å›¾å¦‚å›¾æ‰€ç¤ºã€‚

{% asset_img 2.gif %}

``` java
package FactoryMethod;
import java.awt.*;
import javax.swing.*;
public class AnimalFarmTest {
    public static void main(String[] args) {
        try {
            Animal a;
            AnimalFarm af;
            af = (AnimalFarm) ReadXML2.getObject();
            a = af.newAnimal();
            a.show();
        } catch (Exception e) {
            System.out.println(e.getMessage());
        }
    }
}
// æŠ½è±¡äº§å“ï¼šåŠ¨ç‰©ç±»
interface Animal {
    public void show();
}
// å…·ä½“äº§å“ï¼šé©¬ç±»
class Horse implements Animal {
    JScrollPane sp;
    JFrame jf = new JFrame("å·¥å‚æ–¹æ³•æ¨¡å¼æµ‹è¯•");
    public Horse() {
        Container contentPane = jf.getContentPane();
        JPanel p1 = new JPanel();
        p1.setLayout(new GridLayout(1, 1));
        p1.setBorder(BorderFactory.createTitledBorder("åŠ¨ç‰©ï¼šé©¬"));
        sp = new JScrollPane(p1);
        contentPane.add(sp, BorderLayout.CENTER);
        JLabel l1 = new JLabel(new ImageIcon("src/A_Horse.jpg"));
        p1.add(l1);
        jf.pack();
        jf.setVisible(false);
        jf.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);    //ç”¨æˆ·ç‚¹å‡»çª—å£å…³é—­
    }
    public void show() {
        jf.setVisible(true);
    }
}
// å…·ä½“äº§å“ï¼šç‰›ç±»
class Cattle implements Animal {
    JScrollPane sp;
    JFrame jf = new JFrame("å·¥å‚æ–¹æ³•æ¨¡å¼æµ‹è¯•");
    public Cattle() {
        Container contentPane = jf.getContentPane();
        JPanel p1 = new JPanel();
        p1.setLayout(new GridLayout(1, 1));
        p1.setBorder(BorderFactory.createTitledBorder("åŠ¨ç‰©ï¼šç‰›"));
        sp = new JScrollPane(p1);
        contentPane.add(sp, BorderLayout.CENTER);
        JLabel l1 = new JLabel(new ImageIcon("src/A_Cattle.jpg"));
        p1.add(l1);
        jf.pack();
        jf.setVisible(false);
        jf.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);    //ç”¨æˆ·ç‚¹å‡»çª—å£å…³é—­
    }
    public void show() {
        jf.setVisible(true);
    }
}
// æŠ½è±¡å·¥å‚ï¼šç•œç‰§åœº
interface AnimalFarm {
    public Animal newAnimal();
}
// å…·ä½“å·¥å‚ï¼šå…»é©¬åœº
class HorseFarm implements AnimalFarm {
    public Animal newAnimal() {
        System.out.println("æ–°é©¬å‡ºç”Ÿï¼");
        return new Horse();
    }
}
// å…·ä½“å·¥å‚ï¼šå…»ç‰›åœº
class CattleFarm implements AnimalFarm {
    public Animal newAnimal() {
        System.out.println("æ–°ç‰›å‡ºç”Ÿï¼");
        return new Cattle();
    }
}
```

``` java
package FactoryMethod;
import javax.xml.parsers.*;
import org.w3c.dom.*;
import java.io.*;
class ReadXML2 {
    public static Object getObject() {
        try {
            DocumentBuilderFactory dFactory = DocumentBuilderFactory.newInstance();
            DocumentBuilder builder = dFactory.newDocumentBuilder();
            Document doc;
            doc = builder.parse(new File("src/FactoryMethod/config2.xml"));
            NodeList nl = doc.getElementsByTagName("className");
            Node classNode = nl.item(0).getFirstChild();
            String cName = "FactoryMethod." + classNode.getNodeValue();
            System.out.println("æ–°ç±»åï¼š" + cName);
            Class<?> c = Class.forName(cName);
            Object obj = c.newInstance();
            return obj;
        } catch (Exception e) {
            e.printStackTrace();
            return null;
        }
    }
}
```

``` xml
<?xml version="1.0" encoding="UTF-8"?>
<config>
    <className>HorseFarm</className>
</config>
```

ç¨‹åºçš„è¿è¡Œç»“æœå¦‚å›¾æ‰€ç¤ºï¼š

{% asset_img 3.gif %}

æ³¨æ„ï¼šå½“éœ€è¦ç”Ÿæˆçš„äº§å“ä¸å¤šä¸”ä¸ä¼šå¢åŠ ï¼Œä¸€ä¸ªå…·ä½“å·¥å‚ç±»å°±å¯ä»¥å®Œæˆä»»åŠ¡æ—¶ï¼Œå¯åˆ é™¤æŠ½è±¡å·¥å‚ç±»ã€‚è¿™æ—¶å·¥å‚æ–¹æ³•æ¨¡å¼å°†é€€åŒ–åˆ°ç®€å•å·¥å‚æ¨¡å¼ã€‚

***

### å‚è€ƒèµ„æ–™

> <http://c.biancheng.net/view/1348.html>
