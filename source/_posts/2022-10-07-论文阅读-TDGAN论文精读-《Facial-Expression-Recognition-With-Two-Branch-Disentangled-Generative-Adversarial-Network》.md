---
title: >-
  TDGANè®ºæ–‡ç²¾è¯»-ã€ŠFacial Expression Recognition With Two-Branch Disentangled
  Generative Adversarial Networkã€‹
categories:
  - ğŸŒ™è¿›é˜¶å­¦ä¹ 
  - â­è„‘æœºæ¥å£ä¸æ··åˆæ™ºèƒ½ç ”ç©¶å›¢é˜Ÿï¼ˆBCIå›¢é˜Ÿï¼‰
  - ğŸ’«å­¦ä¹ æŠ¥å‘Š
abbrlink: d035822
date: 2022-10-07 22:12:37
---

### åŸæ–‡

{% pdf ./file/paper/2021-Facial_Expression_Recognition_With_Two-Branch_Disentangled_Generative_Adversarial_Network.pdf %}

è®ºæ–‡ï¼š[Facial Expression Recognition with Two-branch Disentangled Generative Adversarial Network](https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&arnumber=9197663)
ä»£ç ï¼š[TDGAN](https://github.com/XsLangley/TDGAN)

<!--more-->

***

### æœ¬æ–‡è´¡çŒ®

1. æå‡ºä¸€ç§åˆ©ç”¨åŒåˆ†æ”¯çš„åˆ†ç¦»GAN(TDGAN)è¿›è¡Œè¡¨æƒ…è¯†åˆ«ã€‚

2. é¢éƒ¨è¡¨æƒ…è¯†åˆ«ä»»åŠ¡ä¸äººè„¸æ£€æµ‹ä»»åŠ¡ä¸åŒã€‚

  å½“å‰å·¥ä¸šä¸Šå¸¸ç”¨çš„äººè„¸æ£€æµ‹æ¨¡å‹ä¾‹å¦‚MTCNNï¼Œæå‡ºåˆ©ç”¨é¢éƒ¨é¢å¤–çš„å±æ€§ä¿¡æ¯ä¾‹å¦‚è¡¨æƒ…ã€å¹´é¾„ç­‰ä½œä¸ºè¾…åŠ©ä»»åŠ¡ï¼Œå¯ä»¥å¢å¼ºé¢éƒ¨äººè„¸è¯†åˆ«(äººè„¸ID)çš„è¡¨å¾èƒ½åŠ›ï¼Œå¹¶ä¸”é€šè¿‡è‡ªç›‘ç£çš„æ–¹å¼ç›‘ç£æ¨¡å‹çš„è®­ç»ƒè¿‡ç¨‹ï¼Œæé«˜æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›å’Œæ€§èƒ½ï¼Œä¹Ÿå–å¾—äº†å¾ˆå¥½çš„æ•ˆæœã€‚

  ç„¶è€Œï¼Œå¯¹äºè¡¨æƒ…è¯†åˆ«ä»»åŠ¡æ¥è¯´ï¼Œæ ¸å¿ƒæ˜¯ä¸ºäº†è¯†åˆ«é¢éƒ¨çš„è¡¨æƒ…ï¼Œæœ€ç†æƒ³çš„æƒ…å†µæ˜¯ç›¸åŒçš„è¡¨æƒ…åœ¨ä¸åŒçš„è„¸ä¸Šéƒ½èƒ½å®Œç¾è¯†åˆ«ã€‚ä¸ä¸ªäººä¿¡æ¯æœ‰å¼ºå…³è”çš„é¢éƒ¨ç‰¹å¾ä¼šå¯¹è¯†åˆ«æ¨¡å‹è¯¯å¯¼ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ¨¡å‹éœ€è¦èƒ½å¤Ÿå¿½ç•¥é¢éƒ¨ä¸ä¸ªäººèº«ä»½ä¿¡æ¯æœ‰å¼ºå…³è”çš„ç‰¹å¾ã€‚

3. 2ä¸­çš„å†…å®¹ä¹Ÿå°±æ˜¯æå‡ºæœ¬æ–‡æ–¹æ³•çš„åˆè¡·ï¼šé€šè¿‡å¯¹æŠ—å­¦ä¹ çš„æ–¹å¼ï¼ŒåŒæ—¶å­¦ä¹ é¢éƒ¨è¡¨æƒ…ç‰¹å¾å’Œé¢éƒ¨IDå±æ€§ç‰¹å¾ï¼Œé€šè¿‡è¡¨æƒ…è¿ç§»çš„æ–¹å¼æŠŠè¡¨æƒ…ä»ä¸€ä¸ªè„¸ä¸Šè¿ç§»åˆ°å¦ä¸€ä¸ªè„¸ä¸Š(å›¾ç‰‡ç”Ÿæˆ)ï¼Œè®©æ¨¡å‹èƒ½å¤Ÿæ›´å¥½çš„åˆ†ç¦»é¢éƒ¨IDä¿¡æ¯å’Œé¢éƒ¨è¡¨æƒ…ä¿¡æ¯ã€‚

4. æœ¬æ–‡æå‡ºäº†è‡ªç›‘ç£æ–¹å¼æå‡è¡¨å¾å­¦ä¹ èƒ½åŠ›ï¼Œå¢å¼ºç‰¹å¾åˆ†ç¦»èƒ½åŠ›ã€‚

5. æœ¬æ–‡æå‡ºçš„æ–¹æ³•çš„å®šæ€§å’Œå®šé‡åˆ†æåœ¨å®éªŒå®¤æ•°æ®é›†å’Œè‡ªç„¶åœºæ™¯æ•°æ®é›†ä¸Šéƒ½è·å¾—äº†SOTAçš„æ•ˆæœã€‚

***

### æœ¬æ–‡å†…å®¹

è¡¨æƒ…åªåœ¨é¢éƒ¨çš„ç‰¹å®šåŒºåŸŸå†…è¿åŠ¨ï¼Œä½†æ˜¯å…¨è„¸ä½œä¸ºè¾“å…¥çš„æ¨¡å‹ä¼šå­¦ä¹ ä¸è¡¨æƒ…å¯¼è‡´çš„é¢éƒ¨è¿åŠ¨åŒºåŸŸæ— å…³çš„ç‰¹å¾ï¼Œè¿™äº›å­¦ä¹ åˆ°çš„ç‰¹å¾ä¸ä»…æ˜¯å¤šä½™çš„ï¼Œå¯¹äºæ¨¡å‹çš„å…¨å±€è¯†åˆ«èƒ½åŠ›ä¹Ÿæ˜¯æœ‰å®³çš„ã€‚å¦ä¸€æ–¹é¢ï¼Œè§‚æµ‹å¯¹è±¡çš„å§¿æ€æˆ–è€…å¯¹è±¡çš„å¤–è§‚å˜åŒ–ä¹Ÿä¼šä¸åˆ©äºç‰¹å¾æå–çš„è´¨é‡ï¼Œæœ€ç»ˆå¯¼è‡´æ¨¡å‹å­¦ä¹ åˆ°çš„ä¸åŒé¢éƒ¨è¡¨æƒ…çš„ç‰¹å¾çš„è¾¨åˆ«èƒ½åŠ›ä¸è¶³ã€‚

æœ¬æ–‡æå‡ºçš„TDGANæ¨¡å‹ï¼Œå…·æœ‰ä¸¤ä¸ªç‹¬ç«‹çš„åˆ†æ”¯ï¼šè¡¨æƒ…åˆ†æ”¯ç”¨äºè¡¨æƒ…ä¿¡æ¯çš„å¤„ç†ï¼Œé¢éƒ¨åˆ†æ”¯è´Ÿè´£å…¶ä»–é¢éƒ¨å±æ€§ä¿¡æ¯çš„ç¼–ç ã€‚å¦‚Fig.1æ‰€ç¤ºã€‚æ¨¡å‹ä»¥ä¸€å¯¹å›¾ç‰‡ä½œä¸ºè¾“å…¥ï¼Œå›¾ç‰‡å¯¹åŒ…æ‹¬ä¸€ä¸ªè¡¨æƒ…å›¾ç‰‡å’Œä¸€ä¸ªé¢éƒ¨å›¾ç‰‡(åˆ†åˆ«æ¥è‡ªä¸åŒçš„æ•°æ®é›†)ã€‚TDGANçš„ç”Ÿæˆå™¨åˆ†åˆ«å­¦ä¹ ä¸¤å¼ å›¾ç‰‡çš„è¡¨æƒ…è¡¨å¾å’Œé¢éƒ¨è¡¨å¾åä½¿ç”¨ä¸€ä¸ªè§£ç å™¨èåˆï¼Œç„¶åé€šè¿‡è¿ç§»è¡¨æƒ…å›¾ç‰‡ä¸­è¡¨æƒ…åˆ°é¢éƒ¨é¢éƒ¨å›¾ç‰‡çš„æ–¹å¼ç”Ÿæˆä¸€å¼ å›¾ç‰‡ã€‚æœ€åï¼Œé€šè¿‡ä¸¤ä¸ªåˆ†æ”¯ï¼Œä¸€ä¸ªç”¨æ¥åˆ¤æ–­é¢éƒ¨ä¿¡æ¯ï¼Œä¸€ä¸ªåŒæ¥åˆ¤æ–­è¡¨æƒ…ä¿¡æ¯ã€‚

{% asset_img 1.webp %}

TDGANçš„æ¡†æ¶å¦‚ä¸‹ï¼š

{% asset_img 2.webp %}

TDGANé¦–å…ˆé€šè¿‡ä¸¤ä¸ªç¼–ç å™¨ç”Ÿæˆè¡¨æƒ…å’Œé¢éƒ¨ç‰¹å¾ï¼Œç„¶åå°†ä¸¤ä¸ªç‰¹å¾èåˆå¹¶å¼•å…¥å™ªå£°(ä¸‰å—å†…å®¹é€šè¿‡ä¿¡é“çº§æ‹¼æ¥åˆæˆ)ã€‚

é€šè¿‡ä¸€ä¸ªåµŒå…¥å±‚å¯¹èåˆçš„ç‰¹å¾è¿›è¡Œç¼–ç ï¼Œå¹¶é€šè¿‡ä¸Šé‡‡æ ·æ–¹å¼ç”ŸæˆIg(æ¨¡å‹ç”Ÿæˆçš„å›¾ç‰‡)ã€‚æœ€åé€šè¿‡ä¸¤ä¸ªåˆ†æ”¯ï¼Œå¯¹ç”Ÿæˆçš„å›¾ç‰‡è¿›è¡Œåˆ†è¾¨ï¼Œä¸¤ä¸ªè¾¨åˆ«å™¨åˆ†æ”¯åˆ†åˆ«ä¸ºé¢éƒ¨IDè¾¨åˆ«å™¨åˆ†æ”¯å’Œè¡¨æƒ…è¾¨åˆ«å™¨åˆ†æ”¯ã€‚ä¸¤ä¸ªè¾¨åˆ«å™¨ç”¨æ¥è¯„ä¼°åˆæˆçš„å›¾åƒçš„æ•ˆæœã€‚å¦‚æœåˆæˆçš„å›¾åƒèƒ½å¤Ÿæ¬ºéª—è¾¨åˆ«å™¨ï¼Œè¯´æ˜æ¨¡å‹å­¦ä¹ åˆ°çš„ç‰¹å¾å·²ç»å¾ˆå¥½ã€‚

å¦å¤–ï¼Œè¡¨æƒ…ç¼–ç å™¨åˆ†æ”¯è¿˜æœ‰ä¸€ä¸ªFCå±‚åˆ†æ”¯ç”¨äºåˆ¤åˆ«è¡¨æƒ…ç¼–ç å™¨åˆ†æ”¯å­¦ä¹ åˆ°çš„ç‰¹å¾ã€‚
é€šè¿‡å¯¹æŠ—å­¦ä¹ ï¼Œç”Ÿæˆå™¨ä¸­å­¦ä¹ åˆ°çš„è¡¨æƒ…ç‰¹å¾å¯ä»¥ä»å…¶ä»–é¢éƒ¨å±æ€§ä¸­åˆ†ç¦»å‡ºæ¥ï¼Œç”¨äºFERä»»åŠ¡ã€‚

***

### æ¨¡å‹å­¦ä¹ 

#### ä½¿ç”¨å¯¹æŠ—å­¦ä¹ è¿›è¡Œè¡¨æƒ…è¿ç§»

å­¦ä¹ è¿‡ç¨‹ä¸­ï¼ŒTDGANåªæ›´æ–°è¾“å…¥é¢éƒ¨å›¾ç‰‡çš„è¡¨æƒ…ï¼Œä¹Ÿå°±æ˜¯è¯´ç”Ÿæˆçš„å›¾ç‰‡åº”è¯¥åŸºäºè¾“å…¥çš„é¢éƒ¨å›¾ç‰‡è€Œä¸æ˜¯è¡¨æƒ…å›¾ç‰‡ã€‚é¢å¤–åŠ çš„fake classåªé…ç½®åˆ°é¢éƒ¨åˆ†è¾¨å™¨ã€‚ç”Ÿæˆçš„å›¾ç‰‡ä¼šä½œä¸ºé¢éƒ¨å›¾ç‰‡è¾“å…¥åˆ†æ”¯çš„è¾“å…¥(ä¼ªæ ·æœ¬)ï¼Œç”¨äºè®­ç»ƒè¾“å…¥é¢éƒ¨å›¾ç‰‡åˆ†è¾¨å™¨ï¼›ç”¨äºå­¦ä¹ é¢éƒ¨æ•°æ®é›†çš„åˆ†å¸ƒï¼›

è¡¨æƒ…è¿ç§»åˆ†ç±»çš„lossä¸ºLCï¼š

{% asset_img 3.webp %}

***

#### åŒå›¾ç‰‡ä¸€è‡´æ€§

ä½¿ç”¨å›¾ç‰‡çš„ground-truthè¿›è¡Œè®­ç»ƒã€‚ä¹Ÿå°±æ˜¯å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œè®­ç»ƒè¿‡ç¨‹ä¸­ï¼ŒIgä½œä¸ºæ¨¡å‹ç”Ÿæˆç»“æœï¼Œåˆ†åˆ«ä¸If(è¾“å…¥çš„é¢éƒ¨å›¾ç‰‡)å’ŒIe(è¾“å…¥çš„è¡¨æƒ…å›¾ç‰‡)ç¼–ç åèåˆé‡å»ºå›¾ç‰‡ï¼Œå…¶Lossä¸ºLDã€‚

{% asset_img 4.webp %}

{% asset_img 5.webp %}

***

#### è¯­ä¹‰å†…å®¹ä¸€è‡´æ€§

æœ¬æ–‡é‡‡ç”¨é¢å¤–æ„ŸçŸ¥loss(additionally perceptual loss)æ¥è¯„ä¼°ç”Ÿæˆé¢éƒ¨å›¾ç‰‡çš„å·®è·ã€‚dfæ˜¯ç”±é¢éƒ¨ç¼–ç å™¨å¯¹é¢éƒ¨å›¾ç‰‡ç¼–ç åç”Ÿæˆçš„é«˜çº§è¯­ä¹‰ç‰¹å¾ï¼Œd(g,f)æ˜¯ç”Ÿæˆçš„å›¾ç‰‡è¾“å…¥åˆ°é¢éƒ¨ç¼–ç å™¨ç”Ÿæˆçš„é«˜å±‚è¯­ä¹‰ç‰¹å¾ã€‚LPç”¨äºè®¡ç®—ä¸¤ä¸ªå›¾ç‰‡çš„å·®è·ã€‚

{% asset_img 6.webp %}

å› æ­¤ï¼Œæœ¬æ–‡æå‡ºæ–¹æ³•çš„ç”Ÿæˆå™¨çš„lossæœ€ç»ˆè®¡ç®—ä¸ºï¼š

{% asset_img 7.webp %}

è¡¨æƒ…è¯†åˆ«åˆ†æ”¯çš„lossï¼š

{% asset_img 8.webp %}

ä½¿ç”¨æ–¹æ³•ï¼šJ. Johnson, A. Alahi, and L. Fei-Fei, â€œPerceptual losses for realtime style transfer and super-resolution,â€ in European Conference on Computer Vision, ECCV, 2016, pp. 694â€“711.

***

### å®éªŒ

#### å®éªŒç»†èŠ‚

##### è¡¨æƒ…æ•°æ®é›†çš„å¤„ç†

æœ¬è®ºæ–‡ä½¿ç”¨æ•°æ®é›†åˆ†åˆ«ä¸ºCK+ã€TFEIDã€RaFDã€BAUM-2iï¼ŒRAF-DB

CK+ï¼šé€‰æ‹©åºåˆ—çš„æœ€åä¸‰å¸§æ¥æ„å»ºè®­ç»ƒé›†å’Œæµ‹è¯•é›†ï¼›åºåˆ—çš„ç¬¬ä¸€å¸§ä½œä¸ºå¹³é™è„¸ï¼›å› æ­¤ï¼Œå®éªŒä¸­ä¸€å…±æœ‰1236å¼ å›¾ç‰‡

TFEIDï¼šæ•°æ®é›†åŒ…æ‹¬8ä¸­è¡¨æƒ…(6ç§åŸºæœ¬è¡¨æƒ…+neutral+contempt)ï¼Œæœ¬æ–‡åªé€‰å–6ç§åŸºæœ¬è¡¨æƒ…+neutralï¼Œä¸€å…±é€‰å–580å¼ å›¾ç‰‡

RaFDï¼šæ•°æ®æ ‡ç­¾åŒ…æ‹¬è¡¨æƒ…æ ‡ç­¾å’Œèº«ä»½æ ‡ç­¾ã€‚æœ¬æ–‡åªé€‰å–7ç§è¡¨æƒ…(6ç§åŸºæœ¬è¡¨æƒ…+neutralï¼‰çš„æ•°æ®é›†ï¼Œå…±1407å¼ å›¾ç‰‡

BAUM-2iï¼šé€‰å–7ç§è¡¨æƒ…(6ç§åŸºæœ¬è¡¨æƒ…+neutralï¼‰ï¼Œå…±998å¼ å›¾ç‰‡

RAF-DB:æ•°æ®é›†æ˜¯å¤§å°ºåº¦é¢éƒ¨è¡¨æƒ…æ•°æ®é›†ã€‚åªé€‰å–7ç§è¡¨æƒ…(6ç§åŸºæœ¬è¡¨æƒ…+neutralï¼‰çš„æ•°æ®é›†ï¼›å…±è®¡12271ä¸ªè®­ç»ƒæ ·æœ¬å’Œ3608ä¸ªæµ‹è¯•æ ·æœ¬

***

##### è¯•éªŒè®¾ç½®

é¢éƒ¨æ•°æ®é›†ä½¿ç”¨CASIA-WebFaceã€‚CASIA-WebFaceåªé€‰å–20ä¸ªSubjectä½œä¸ºè®­ç»ƒæ•°æ®ï¼Œå…±è®¡2894å¼ é¢éƒ¨å›¾ç‰‡ã€‚å› ä¸ºæœ¬æ–¹æ³•æ˜¯ä¸ºäº†å­¦ä¹ è¡¨æƒ…ç‰¹å¾ï¼Œè€Œå¢åŠ ä¸åŒé¢éƒ¨IDçš„å›¾ç‰‡ï¼Œä¼šå¹²æ‰°æ¨¡å‹(è®©æ¨¡å‹å­¦ä¹ å¤ªå¤šä¸åŒé¢éƒ¨IDçš„ç‰¹å¾ä¿¡æ¯ï¼Œé€ æˆå¹²æ‰°)

ç½‘ç»œç»“æ„å¦‚è¡¨æ‰€ç¤º:

{% asset_img 9.webp %}

æœ¬å®éªŒéªŒè¯ï¼Œæ”¹å˜è¡¨æƒ…çš„ç‰¹å¾ä¼šå½±å“ç”Ÿæˆå›¾ç‰‡çš„è¡¨æƒ…ï¼Œè€Œä¸å½±å“é¢éƒ¨çš„å…¶ä»–å±æ€§ä¿¡æ¯ã€‚
1. å›ºå®šé¢éƒ¨å›¾ç‰‡ï¼Œä¸åŒè¡¨æƒ…æ’å¸§
2. å›ºå®šè¡¨æƒ…å›¾ç‰‡
å¹¶ä¸åŒé¢éƒ¨æ’å¸§é€šè¿‡æ’å¸§æ–¹æ³•æŸ¥çœ‹ç”Ÿæˆå›¾ç‰‡çš„è¿‡ç¨‹å›¾ç‰‡ã€‚

{% asset_img 10.webp %}

***

#### æ¨¡å‹åˆ†æ

æœ¬æ–‡æœ€åè®¨è®ºäº†æ¨¡å‹æ€§èƒ½çš„é—®é¢˜

##### è¯†åˆ«ä»»åŠ¡é—®é¢˜

1. åŒåˆ†æ”¯æ¨¡å‹ï¼ŒåŒåˆ†æ”¯çš„æ”¶æ•›é€Ÿåº¦ä¸ä¸€è‡´
2. åŒåˆ†æ”¯æ¨¡å‹ï¼Œè¡¨æƒ…åˆ†æ”¯å­¦ä¹ çš„æ•ˆæœæ¯”é¢éƒ¨ç‰¹å¾å­¦ä¹ æ•ˆæœå¥½

ä½œè€…ç»™å‡ºè§£å†³æ–¹æ¡ˆï¼šé¢éƒ¨åˆ†æ”¯ä½¿ç”¨æ›´æ·±/æ›´åŠ ç²¾ç»†çš„æ¨¡å‹è¿›è¡Œè®­ç»ƒï¼›æˆ–è€…ä½¿ç”¨ä¸è®­ç»ƒæ¨¡å‹

##### è¿ç§»æ€§èƒ½é—®é¢˜

æœ‰äº›å›¾ç‰‡çš„è¿ç§»æ•ˆæœè¾ƒå·®çš„åŸå› ï¼š
1. è¯†åˆ«å¯¹è±¡æç«¯å§¿åŠ¿
2. è¯†åˆ«å¯¹è±¡æœ‰å¤§é¢ç§¯çš„é®æŒ¡
3. æ•°æ®é›†åˆ†å¸ƒä¸å‡åŒ€ï¼Œä¾‹å¦‚æƒŠè®¶è¡¨æƒ…è¾ƒå°‘

***

### åŸæ–‡é“¾æ¥

> <https://blog.csdn.net/juan190755422/article/details/115430204>
