---
title: 使用最新版EEGLAB完成博睿康脑电数据预处理
categories:
  - 🌙进阶学习
  - ⭐脑机接口与混合智能研究团队（BCI团队）
  - 💫学习报告
abbrlink: 732f950a
date: 2022-12-29 09:38:42
tags:
---

### 用EEGLAB手动预处理

本实验所采数据参考电极为CPz，接地电极为AFz，若数据不好可尝试进行重参考。

<!--more-->

***

### 相关软件

在官网下载安装最新版本的MATLAB，用学校邮箱登录账号，完全安装大概约3小时。

在官网下载最新版本的eeglab，将eeglab安装到MATLAB中，然后将博瑞康插件复制到eeglab中的plugins文件夹里面。

***

### 导入数据

{% asset_img 1.webp %}

接下来弹出两个对话框，是否要对数据进行选择性导入和重命名，一般点击ok即可。导入数据后eeglab会显示数据信息。

***

### 电极定位

默认的文件就可以。

{% asset_img 2.webp %}
{% asset_img 3.webp %}

点击ok后下一步会查看通道情况，直接ok就可以。

***

### 移除无用电极

{% asset_img 4.webp %}

选择最后5个通道，然后去除。

{% asset_img 5.webp %}

***

### 滤波

此处，使用默认的滤波器进行1-75Hz的滤波，并滤除50Hz工频。

{% asset_img 6.webp %}

分三次完成滤波。

{% asset_img 7.webp %}
{% asset_img 8.webp %}
{% asset_img 9.webp %}

***

### 重采样

将采样率重采样到200。

{% asset_img 10.webp %}
{% asset_img 11.webp %}

***

### 分段

根据event进行分段。

{% asset_img 12.webp %}

把event全部选上

{% asset_img 13.webp %}

后面全部ok，当前数据情况如下：

{% asset_img 14.webp %}

***

### 插值坏导

使用eeglab的默认算法进行

{% asset_img 15.webp %}
{% asset_img 16.webp %}

***

### ICA去除伪迹

{% asset_img 17.webp %}

在上面的插值坏导步骤中我们删除了1个通道的数据，这1个坏通道的数据是用其他通道的数据生成的，相当于我们损失了1个有效通道数据，而ICA默认是在所有通道都是有效数据的情况下进行的，所以此处我们需要进行一些修改，在’extended’, 1后面加上’pca’, 58，中间用逗号和空格隔开，逗号要用英文输入法下的

{% asset_img 18.webp %}

在确定之后会弹出中断的对话框，结束后对话框消失

{% asset_img 19.webp %}

**在跑完ICA之后建议保存当前数据，在进行伪迹剔除操作。这样做可以保证在剔除不当的时候随时回到未剔除的状态下重新进行选择。**

在这之后就可以用ICA进行伪迹去除了，伪迹的具体判断请参考：
[CSDN：如何识别ICA成分](https://blog.csdn.net/zyb228/article/details/106262473)
[CSDN：ICA处理后，如何判断眼电、心电等成分？](https://blog.csdn.net/zyb228/article/details/105745877)
[CSDN：脑电实验注意事项及实验过程中伪迹识别](https://roses.blog.csdn.net/article/details/110298390)

选择要画出的成分数，此处我们选择默认状态

{% asset_img 20.webp %}
{% asset_img 21.webp %}

eeglab提示我们一张画布只能画下35个图，剩下的会在第二张画布中画出，点击OK即可

{% asset_img 22.webp %}
{% asset_img 23.webp %}

此时我们可以对所有的ICA成分进行查看和标记，点击成分数字，会出现该成分的详细情况。如果觉得该成分代表伪迹成分，想要剔除的话，可以先将它标记起来。标记的方式是单机下方绿色的ACCEPT,单击之后会变成红色的REJECT

{% asset_img 24.webp %}

这一步需要对每一个成分进行查看和判断，然后将想要剔除的成分先标记起来。ICA可以进行眼电伪迹，肌电伪迹，坏导伪迹以及心电伪迹等的辨识与剔除，但是此处我们只进行眼电伪迹的剔除，我们将第2个成分和第3个成分标记起来，标记了的成分数会变成红色。然后点OK。此时还没有进行剔除操作。

{% asset_img 25.webp %}

***

### 剔除ICA成分

根据选择的成分去除伪迹

{% asset_img 26.webp %}
{% asset_img 27.webp %}
{% asset_img 28.webp %}

***

### 重参考（可选）

若数据较差可以尝试进行重参考

{% asset_img 29.webp %}
{% asset_img 30.webp %}

***

### 剔除坏段

1. 绝对阈值法

使用此功能需要在设置（File->Preferences）里面打开过去版本的功能容易报错，可能用不了

{% asset_img 31.webp %}

此处我们选择剔除掉超出±100μV的trial

{% asset_img 32.webp %}
{% asset_img 33.webp %}

2. 目视检查法

{% asset_img 34.webp %}

逐个trial进行查看，如果发现有伪迹过大的trial想要剔除的话，单击该trial，它会变成黄色。选择完所有trials后，点击下方的reject即可。此处选中的两个trials仅仅作为演示用。

判别方法参考：
[CSDN：脑电实验注意事项及实验过程中伪迹识别](https://roses.blog.csdn.net/article/details/110298390)
[CSDN：脑电伪迹和去除方法](https://blog.csdn.net/xumeng900/article/details/119133937)

{% asset_img 35.webp %}

***

### 批处理

完成一个数据的预处理后，使用EEGLAB的history功能导出脚本，可以用脚本完成重复工作。

{% asset_img 36.webp %}

***

### 参考

[1] Li J, Li S, Pan J, et al. Cross-subject EEG emotion recognition with self-organized graph neural network[J]. Frontiers in Neuroscience, 2021: 689.

***

### 原文链接

> <https://www.scholat.com/teamwork/showPostMessage.html?id=12941>