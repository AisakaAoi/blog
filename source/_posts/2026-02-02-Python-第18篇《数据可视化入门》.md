---
title: Python-ç¬¬18ç¯‡ã€Šæ•°æ®å¯è§†åŒ–å…¥é—¨ã€‹
categories:
  - ğŸŒ™é€¢å‚æ‚è°ˆä¸æ¬è¿
  - â­æœæœè¯¾ç¨‹
abbrlink: c9256979
date: 2026-02-02 05:57:06
tags:
---

### å¯¼è¯­

è¾›è¾›è‹¦è‹¦åšå‡ºå®Œç¾æ•°æ®è¡¨ï¼Œç»“æœé¢†å¯¼åªçœ‹äº†ä¸€çœ¼è¯´â€œçœ‹ä¸æ‡‚â€ï¼Ÿä»Šå¤©å’±ä»¬ç»™æ•°å­—â€œåŒ–å¦†â€â€”â€”æŠŠæ¯ç‡¥çš„è¡¨æ ¼å˜æˆä¸€ç›®äº†ç„¶çš„å›¾è¡¨ã€‚æŸ±çŠ¶å›¾PKéƒ¨é—¨ä¸šç»©ï¼ŒæŠ˜çº¿å›¾çœ‹åˆ©æ¶¦èµ°åŠ¿ï¼Œé¥¼å›¾åˆ†ææˆæœ¬ç»“æ„ã€‚

<!--more-->

***

### æœ¬ç¯‡ç›®æ ‡

- æŒæ¡matplotlibä¸‰ç§æ ¸å¿ƒå›¾è¡¨
- ç”¨è´¢åŠ¡æ¡ˆä¾‹æ¼”ç»ƒæ•°æ®å¯è§†åŒ–
- å­¦ä¼šå›¾è¡¨ç¾åŒ–ï¼ˆé¢œè‰²ã€æ ‡ç­¾ã€å­—ä½“ï¼‰
- åˆ¶ä½œå¤šå›¾è¡¨ç»„åˆçš„æ•°æ®æŠ¥å‘Š
- ä¿å­˜é«˜è´¨é‡å›¾ç‰‡ç”¨äºæ±‡æŠ¥

***

### ä¸€ã€å‡†å¤‡å·¥ä½œï¼šå®‰è£…åº“

```python
# å‘½ä»¤è¡Œè¿è¡Œ
# pip install matplotlib pandas

import matplotlib.pyplot as plt
import pandas as pd
from datetime import datetime
import os
import numpy as np

# è®¾ç½®ä¸­æ–‡å­—ä½“ï¼ˆè§£å†³ä¸­æ–‡ä¹±ç ï¼‰
plt.rcParams['font.sans-serif'] = ['SimHei', 'Arial Unicode MS', 'DejaVu Sans']
plt.rcParams['axes.unicode_minus'] = False  # è§£å†³è´Ÿå·æ˜¾ç¤ºé—®é¢˜

print("âœ… ç¯å¢ƒé…ç½®å®Œæˆï¼")
```

***

### äºŒã€æŸ±çŠ¶å›¾ï¼šéƒ¨é—¨ä¸šç»©å¤§æ¯”æ‹¼

æœ€ç›´è§‚çš„â€œè°é«˜è°ä½â€ï¼Œé€‚åˆå¯¹æ¯”ä¸åŒç±»åˆ«çš„æ•°æ®ã€‚

```python
# ========== æ¡ˆä¾‹ï¼šå„éƒ¨é—¨æœˆåº¦æ”¶å…¥ ==========
def demo_bar_chart():
    """æŸ±çŠ¶å›¾æ¼”ç¤º"""
    
    # å‡†å¤‡æ•°æ®
    data = {
        'éƒ¨é—¨': ['é”€å”®éƒ¨', 'å¸‚åœºéƒ¨', 'æŠ€æœ¯éƒ¨', 'è´¢åŠ¡éƒ¨', 'äººåŠ›éƒ¨'],
        'æ”¶å…¥(ä¸‡å…ƒ)': [850, 620, 480, 320, 280],
        'æˆæœ¬(ä¸‡å…ƒ)': [420, 380, 350, 180, 160]
    }
    df = pd.DataFrame(data)
    
    # åˆ›å»ºå›¾è¡¨
    plt.figure(figsize=(10, 6))
    
    # è®¾ç½®xè½´ä½ç½®
    x = np.arange(len(df['éƒ¨é—¨']))
    width = 0.35  # æŸ±å­å®½åº¦
    
    # ç»˜åˆ¶æŸ±å­
    bars1 = plt.bar(x - width/2, df['æ”¶å…¥(ä¸‡å…ƒ)'], width, 
                    label='æ”¶å…¥', color='#4CAF50', alpha=0.8)
    bars2 = plt.bar(x + width/2, df['æˆæœ¬(ä¸‡å…ƒ)'], width,
                    label='æˆæœ¬', color='#FF9800', alpha=0.8)
    
    # æ·»åŠ æ•°å€¼æ ‡ç­¾
    for bar in bars1:
        height = bar.get_height()
        plt.text(bar.get_x() + bar.get_width()/2, height,
                f'{height}', ha='center', va='bottom', fontweight='bold')
    
    for bar in bars2:
        height = bar.get_height()
        plt.text(bar.get_x() + bar.get_width()/2, height,
                f'{height}', ha='center', va='bottom', fontweight='bold')
    
    # è®¾ç½®æ ‡é¢˜å’Œæ ‡ç­¾
    plt.title('å„éƒ¨é—¨æœˆåº¦æ”¶æ”¯å¯¹æ¯”', fontsize=16, fontweight='bold', pad=20)
    plt.xlabel('éƒ¨é—¨', fontsize=12)
    plt.ylabel('é‡‘é¢ï¼ˆä¸‡å…ƒï¼‰', fontsize=12)
    plt.xticks(x, df['éƒ¨é—¨'])
    plt.legend()
    
    # æ·»åŠ èƒŒæ™¯ç½‘æ ¼
    plt.grid(axis='y', linestyle='--', alpha=0.7)
    
    # è‡ªåŠ¨è°ƒæ•´å¸ƒå±€
    plt.tight_layout()
    
    # ä¿å­˜å›¾ç‰‡
    plt.savefig('éƒ¨é—¨ä¸šç»©å¯¹æ¯”.png', dpi=150, bbox_inches='tight')
    print("âœ… å·²ä¿å­˜: éƒ¨é—¨ä¸šç»©å¯¹æ¯”.png")
    
    plt.show()

# æµ‹è¯•ä¸€ä¸‹
# demo_bar_chart()
```

***

### ä¸‰ã€æŠ˜çº¿å›¾ï¼šåˆ©æ¶¦èµ°åŠ¿å…¨æŒæ¡

çœ‹è¶‹åŠ¿ã€çœ‹æ³¢åŠ¨ï¼Œæ—¶é—´åºåˆ—æ•°æ®çš„æœ€ä½³é€‰æ‹©ã€‚

```python
# ========== æ¡ˆä¾‹ï¼šæœ¬å¹´åº¦åˆ©æ¶¦èµ°åŠ¿ ==========
def demo_line_chart():
    """æŠ˜çº¿å›¾æ¼”ç¤º"""
    
    # ç”Ÿæˆæ¨¡æ‹Ÿæœˆåº¦æ•°æ®
    months = ['1æœˆ', '2æœˆ', '3æœˆ', '4æœˆ', '5æœˆ', '6æœˆ', 
              '7æœˆ', '8æœˆ', '9æœˆ', '10æœˆ', '11æœˆ', '12æœˆ']
    
    # æ¨¡æ‹Ÿåˆ©æ¶¦æ•°æ®ï¼ˆä¸‡å…ƒï¼‰
    profit = [120, 135, 158, 142, 165, 178, 
              195, 210, 188, 225, 240, 260]
    
    # åˆ›å»ºå›¾è¡¨
    plt.figure(figsize=(12, 6))
    
    # ç»˜åˆ¶æŠ˜çº¿
    plt.plot(months, profit, marker='o', linewidth=2.5, 
             markersize=8, color='#2196F3', markerfacecolor='#FF5722')
    
    # æ·»åŠ æ•°å€¼æ ‡ç­¾
    for i, v in enumerate(profit):
        plt.text(i, v + 5, f'{v}', ha='center', va='bottom', 
                fontweight='bold', fontsize=10)
    
    # æ·»åŠ è¶‹åŠ¿çº¿
    z = np.polyfit(range(len(profit)), profit, 1)
    p = np.poly1d(z)
    plt.plot(months, p(range(len(profit))), 
             linestyle='--', color='#9C27B0', alpha=0.6, label='è¶‹åŠ¿çº¿')
    
    # é«˜äº®æœ€å¤§å€¼å’Œæœ€å°å€¼
    max_idx = profit.index(max(profit))
    min_idx = profit.index(min(profit))
    
    plt.scatter([months[max_idx]], [profit[max_idx]], 
                color='red', s=150, marker='*', label='æœ€å¤§å€¼', zorder=5)
    plt.scatter([months[min_idx]], [profit[min_idx]], 
                color='green', s=150, marker='^', label='æœ€å°å€¼', zorder=5)
    
    # è®¾ç½®æ ‡é¢˜å’Œæ ‡ç­¾
    plt.title('2025å¹´åº¦æœˆåº¦åˆ©æ¶¦èµ°åŠ¿', fontsize=16, fontweight='bold', pad=20)
    plt.xlabel('æœˆä»½', fontsize=12)
    plt.ylabel('åˆ©æ¶¦ï¼ˆä¸‡å…ƒï¼‰', fontsize=12)
    plt.legend()
    
    # è®¾ç½®yè½´ä»0å¼€å§‹
    plt.ylim(bottom=0)
    
    # ç½‘æ ¼çº¿
    plt.grid(True, linestyle='--', alpha=0.6)
    
    # æ—‹è½¬xè½´æ ‡ç­¾é¿å…é‡å 
    plt.xticks(rotation=45)
    
    plt.tight_layout()
    plt.savefig('åˆ©æ¶¦èµ°åŠ¿.png', dpi=150, bbox_inches='tight')
    print("âœ… å·²ä¿å­˜: åˆ©æ¶¦èµ°åŠ¿.png")
    
    plt.show()

# æµ‹è¯•ä¸€ä¸‹
# demo_line_chart()
```

***

### å››ã€é¥¼å›¾ï¼šæˆæœ¬ç»“æ„ä¸€ç›®äº†ç„¶

å±•ç¤ºå æ¯”å…³ç³»ï¼Œâ€œé’±èŠ±åœ¨å“ªå„¿äº†â€æœ€æ¸…æ™°ã€‚

```python
# ========== æ¡ˆä¾‹ï¼šæˆæœ¬ç»“æ„åˆ†æ ==========
def demo_pie_chart():
    """é¥¼å›¾æ¼”ç¤º"""
    
    # æˆæœ¬æ•°æ®
    cost_items = ['åŸææ–™', 'äººå·¥å·¥èµ„', 'æˆ¿ç§Ÿæ°´ç”µ', 'è¥é”€æ¨å¹¿', 'å…¶ä»–']
    cost_values = [45, 25, 15, 10, 5]
    
    # åˆ›å»ºå›¾è¡¨
    plt.figure(figsize=(10, 8))
    
    # è‡ªå®šä¹‰é¢œè‰²
    colors = ['#FF6B6B', '#4ECDC4', '#45B7D1', '#FFA07A', '#98D8C8']
    
    # çªå‡ºæ˜¾ç¤ºæœ€å¤§çš„ä¸€å—
    explode = [0.1 if v == max(cost_values) else 0 for v in cost_values]
    
    # ç»˜åˆ¶é¥¼å›¾
    wedges, texts, autotexts = plt.pie(
        cost_values, labels=cost_items, colors=colors, 
        explode=explode, autopct='%1.1f%%', startangle=140,
        textprops={'fontsize': 11, 'fontweight': 'bold'},
        shadow=True
    )
    
    # ç¾åŒ–ç™¾åˆ†æ¯”æ–‡å­—
    for autotext in autotexts:
        autotext.set_color('white')
        autotext.set_fontsize(12)
    
    # æ ‡é¢˜
    plt.title('2025å¹´åº¦æˆæœ¬ç»“æ„åˆ†æ', 
              fontsize=16, fontweight='bold', pad=30)
    
    # æ·»åŠ å›¾ä¾‹
    plt.legend(title="æˆæœ¬é¡¹ç›®", loc='upper left', bbox_to_anchor=(1, 0.5))
    
    plt.axis('equal')  # ä¿è¯é¥¼å›¾æ˜¯åœ†å½¢
    
    plt.tight_layout()
    plt.savefig('æˆæœ¬ç»“æ„.png', dpi=150, bbox_inches='tight')
    print("âœ… å·²ä¿å­˜: æˆæœ¬ç»“æ„.png")
    
    plt.show()

# æµ‹è¯•ä¸€ä¸‹
# demo_pie_chart()
```

***

### äº”ã€è´¢åŠ¡æ•°æ®ç»¼åˆå¯è§†åŒ–

æ¥ä¸ªçœŸå®åœºæ™¯ï¼šåˆ†æå…¬å¸ä¸‰å¹´çš„è´¢åŠ¡æ•°æ®ã€‚

```python
# ========== ç»¼åˆæ¡ˆä¾‹ï¼šä¸‰å¹´è´¢åŠ¡å¯¹æ¯” ==========
def comprehensive_finance_report():
    """ç”Ÿæˆç»¼åˆè´¢åŠ¡æŠ¥å‘Š"""
    
    # åˆ›å»ºæ¨¡æ‹Ÿæ•°æ®
    years = ['2023å¹´', '2024å¹´', '2025å¹´']
    
    # å„å¹´åº¦æ•°æ®ï¼ˆå•ä½ï¼šä¸‡å…ƒï¼‰
    data = {
        'å¹´è¥æ”¶': [2800, 3200, 3650],
        'å‡€åˆ©æ¶¦': [320, 385, 450],
        'ç°é‡‘æµ': [450, 520, 580],
        'ç ”å‘æŠ•å…¥': [180, 240, 300]
    }
    
    # åˆ›å»ºä¸€ä¸ª2x2çš„å­å›¾å¸ƒå±€
    fig, axes = plt.subplots(2, 2, figsize=(15, 10))
    fig.suptitle('å…¬å¸ä¸‰å¹´è´¢åŠ¡æ•°æ®ç»¼åˆåˆ†ææŠ¥å‘Š', 
                 fontsize=20, fontweight='bold', y=0.98)
    
    # 1. è¥æ”¶æŸ±çŠ¶å›¾ï¼ˆå·¦ä¸Šï¼‰
    axes[0,0].bar(years, data['å¹´è¥æ”¶'], color=['#FF9999','#66B2FF','#99FF99'])
    axes[0,0].set_title('å¹´è¥æ”¶å¯¹æ¯”', fontweight='bold', fontsize=12)
    axes[0,0].set_ylabel('è¥æ”¶ï¼ˆä¸‡å…ƒï¼‰')
    for i, v in enumerate(data['å¹´è¥æ”¶']):
        axes[0,0].text(i, v + 50, f'{v}', ha='center', fontweight='bold')
    
    # 2. å‡€åˆ©æ¶¦æŠ˜çº¿å›¾ï¼ˆå³ä¸Šï¼‰
    axes[0,1].plot(years, data['å‡€åˆ©æ¶¦'], marker='o', linewidth=3, markersize=10, 
                   color='#FF5722')
    axes[0,1].set_title('å‡€åˆ©æ¶¦è¶‹åŠ¿', fontweight='bold', fontsize=12)
    axes[0,1].set_ylabel('å‡€åˆ©æ¶¦ï¼ˆä¸‡å…ƒï¼‰')
    axes[0,1].grid(True, linestyle='--', alpha=0.6)
    
    # 3. ç°é‡‘æµé¥¼å›¾ï¼ˆå·¦ä¸‹ï¼‰
    axes[1,0].pie(data['ç°é‡‘æµ'], labels=years, autopct='%1.1f%%', 
                  colors=['#FFD700','#C0C0C0','#CD7F32'], startangle=90)
    axes[1,0].set_title('ç°é‡‘æµåˆ†å¸ƒ', fontweight='bold', fontsize=12)
    
    # 4. ç ”å‘æŠ•å…¥å †å æŸ±çŠ¶å›¾ï¼ˆå³ä¸‹ï¼‰
    # åˆ›å»ºå †å æ•°æ®
    base = np.zeros(len(years))
    colors = ['#8BC34A', '#FFC107', '#9C27B0']
    labels = ['äººå·¥è´¹ç”¨', 'è®¾å¤‡é‡‡è´­', 'å…¶ä»–æŠ•å…¥']
    
    # æ¨¡æ‹Ÿæ•°æ®ç»“æ„
    rd_detail = {
        'äººå·¥è´¹ç”¨': [100, 130, 160],
        'è®¾å¤‡é‡‡è´­': [50, 70, 90],
        'å…¶ä»–æŠ•å…¥': [30, 40, 50]
    }
    
    bottom = np.zeros(len(years))
    for i, (label, values) in enumerate(rd_detail.items()):
        axes[1,1].bar(years, values, bottom=bottom, 
                      label=label, color=colors[i])
        bottom += values
    
    axes[1,1].set_title('ç ”å‘æŠ•å…¥æ˜ç»†', fontweight='bold', fontsize=12)
    axes[1,1].set_ylabel('æŠ•å…¥ï¼ˆä¸‡å…ƒï¼‰')
    axes[1,1].legend(loc='upper left', bbox_to_anchor=(1, 1))
    
    # è°ƒæ•´å¸ƒå±€
    plt.tight_layout(rect=[0, 0, 1, 0.96])
    
    # ä¿å­˜é«˜è´¨é‡å›¾ç‰‡
    plt.savefig('è´¢åŠ¡ç»¼åˆåˆ†ææŠ¥å‘Š.png', dpi=300, bbox_inches='tight')
    print("âœ… å·²ä¿å­˜: è´¢åŠ¡ç»¼åˆåˆ†ææŠ¥å‘Š.png (é«˜æ¸…ç‰ˆ)")
    
    plt.show()

# æµ‹è¯•ç»¼åˆæŠ¥å‘Š
# comprehensive_finance_report()
```

***

### å…­ã€å›¾è¡¨ç¾åŒ–è¿›é˜¶æŠ€å·§

#### 6.1 æ•´ä½“é£æ ¼å®šåˆ¶

```python
def style_demo():
    """å±•ç¤ºä¸åŒé£æ ¼"""
    
    # å‡†å¤‡æ•°æ®
    x = ['Q1', 'Q2', 'Q3', 'Q4']
    y = [85, 92, 78, 95]
    
    # å†…ç½®é£æ ¼
    styles = ['default', 'seaborn-v0_8', 'ggplot', 'bmh', 'dark_background']
    
    fig, axes = plt.subplots(2, 3, figsize=(15, 10))
    axes = axes.flatten()
    
    for i, style in enumerate(styles):
        if i >= len(axes):
            break
        
        plt.style.use(style)
        
        axes[i].plot(x, y, marker='o', linewidth=3)
        axes[i].set_title(f'style: {style}', fontweight='bold')
        axes[i].set_facecolor('#f0f0f0')
    
    # æ¢å¤é»˜è®¤é£æ ¼
    plt.style.use('default')
    
    plt.tight_layout()
    plt.show()

# style_demo()
```

***

#### 6.2 é…è‰²æ–¹æ¡ˆ

```python
def color_palette_demo():
    """å±•ç¤ºä¸“ä¸šé…è‰²"""
    
    # è´¢åŠ¡è“ä¸»é¢˜
    finance_blue = ['#1f77b4', '#aec7e8', '#006ba4', '#6897bb']
    
    # æš–è‰²ä¸»é¢˜
    warm_colors = ['#ff7f0e', '#ffbb78', '#ff5500', '#ffaa33']
    
    # ç°è‰²ç³»ï¼ˆé€‚åˆæ­£å¼æŠ¥å‘Šï¼‰
    gray_scale = ['#2f2f2f', '#7f7f7f', '#bcbd22', '#dbdb8d']
    
    # åˆ›å»ºç¤ºä¾‹
    data = [45, 35, 20]
    
    fig, axes = plt.subplots(1, 3, figsize=(15, 5))
    
    for ax, colors, title in zip(axes, [finance_blue, warm_colors, gray_scale], 
                                 ['è´¢åŠ¡è“', 'æš–è‰²ç³»', 'å•†åŠ¡ç°']):
        ax.pie(data, labels=['A', 'B', 'C'], autopct='%1.1f%%', colors=colors)
        ax.set_title(title)
    
    plt.show()

# color_palette_demo()
```

***

### ä¸ƒã€å®Œæ•´é¡¹ç›®ï¼šè´¢åŠ¡æ•°æ®å¯è§†åŒ–å·¥å…·

```python
# ========== è´¢åŠ¡æ•°æ®å¯è§†åŒ–å·¥å…· - å®Œæ•´ç‰ˆ ==========
import matplotlib.pyplot as plt
import pandas as pd
import numpy as np
from datetime import datetime

class FinanceVisualizer:
    """è´¢åŠ¡æ•°æ®å¯è§†åŒ–å·¥å…·"""
    
    def __init__(self):
        plt.rcParams['font.sans-serif'] = ['SimHei']
        plt.rcParams['axes.unicode_minus'] = False
        self.data = None
    
    def load_data(self, filepath):
        """åŠ è½½CSVæ•°æ®"""
        try:
            self.data = pd.read_csv(filepath)
            print(f"âœ… åŠ è½½æˆåŠŸ: {len(self.data)}è¡Œæ•°æ®")
            return True
        except Exception as e:
            print(f"âŒ åŠ è½½å¤±è´¥: {e}")
            return False
    
    def create_bar_chart(self, x_col, y_col, title="æŸ±çŠ¶å›¾"):
        """é€šç”¨æŸ±çŠ¶å›¾"""
        if self.data is None:
            print("âš ï¸ è¯·å…ˆåŠ è½½æ•°æ®")
            return
        
        plt.figure(figsize=(10, 6))
        
        # å¦‚æœæ˜¯å­—ç¬¦ä¸²ç±»åˆ«
        if self.data[x_col].dtype == 'object':
            plt.bar(self.data[x_col], self.data[y_col], 
                    color='#4CAF50', alpha=0.8)
        else:
            # å¦‚æœæ˜¯æ•°å€¼ï¼Œç”¨æ•£ç‚¹
            plt.scatter(self.data[x_col], self.data[y_col], 
                       s=100, color='#FF5722')
        
        plt.title(title, fontsize=14, fontweight='bold')
        plt.xlabel(x_col)
        plt.ylabel(y_col)
        plt.grid(axis='y', linestyle='--', alpha=0.7)
        plt.xticks(rotation=45)
        plt.tight_layout()
        
        filename = f"{title}_{datetime.now().strftime('%Y%m%d')}.png"
        plt.savefig(filename, dpi=150)
        print(f"âœ… å·²ä¿å­˜: {filename}")
        plt.show()
    
    def create_line_chart(self, x_col, y_cols, title="æŠ˜çº¿å›¾"):
        """å¤šç³»åˆ—æŠ˜çº¿å›¾"""
        if self.data is None:
            print("âš ï¸ è¯·å…ˆåŠ è½½æ•°æ®")
            return
        
        plt.figure(figsize=(12, 6))
        
        if isinstance(y_cols, str):
            y_cols = [y_cols]
        
        colors = plt.cm.tab10(np.linspace(0, 1, len(y_cols)))
        
        for i, y_col in enumerate(y_cols):
            plt.plot(self.data[x_col], self.data[y_col], 
                    marker='o', label=y_col, color=colors[i], linewidth=2)
        
        plt.title(title, fontsize=14, fontweight='bold')
        plt.xlabel(x_col)
        plt.ylabel('æ•°å€¼')
        plt.legend()
        plt.grid(True, linestyle='--', alpha=0.6)
        plt.xticks(rotation=45)
        plt.tight_layout()
        
        filename = f"{title}_{datetime.now().strftime('%Y%m%d')}.png"
        plt.savefig(filename, dpi=150)
        print(f"âœ… å·²ä¿å­˜: {filename}")
        plt.show()
    
    def create_pie_chart(self, labels_col, values_col, title="é¥¼å›¾"):
        """é¥¼å›¾"""
        if self.data is None:
            print("âš ï¸ è¯·å…ˆåŠ è½½æ•°æ®")
            return
        
        plt.figure(figsize=(10, 8))
        
        # æ£€æŸ¥æ•°æ®æ˜¯å¦æœ‰æ•ˆ
        if self.data[values_col].sum() <= 0:
            print("âš ï¸ æ•°æ®æ— æ•ˆï¼Œæ— æ³•ç»˜åˆ¶é¥¼å›¾")
            return
        
        colors = plt.cm.Set3(np.linspace(0, 1, len(self.data)))
        
        wedges, texts, autotexts = plt.pie(
            self.data[values_col], 
            labels=self.data[labels_col],
            autopct='%1.1f%%',
            colors=colors,
            startangle=140,
            textprops={'fontsize': 10}
        )
        
        for autotext in autotexts:
            autotext.set_color('white')
            autotext.set_fontweight('bold')
        
        plt.title(title, fontsize=14, fontweight='bold')
        plt.axis('equal')
        plt.tight_layout()
        
        filename = f"{title}_{datetime.now().strftime('%Y%m%d')}.png"
        plt.savefig(filename, dpi=150)
        print(f"âœ… å·²ä¿å­˜: {filename}")
        plt.show()
    
    def create_report(self, charts_config, title="æ•°æ®æŠ¥å‘Š"):
        """ç”Ÿæˆå¤šå›¾è¡¨æŠ¥å‘Š"""
        n = len(charts_config)
        cols = 2
        rows = (n + 1) // 2
        
        fig, axes = plt.subplots(rows, cols, figsize=(15, rows*5))
        
        if rows == 1:
            axes = axes.reshape(1, -1)
        
        axes = axes.flatten()
        
        for i, config in enumerate(charts_config):
            ax = axes[i]
            
            if config['type'] == 'bar':
                ax.bar(self.data[config['x']], self.data[config['y']], 
                       color=config.get('color', '#4CAF50'))
                ax.set_title(config.get('title', ''), fontweight='bold')
                ax.set_ylabel(config['y'])
                ax.grid(axis='y', linestyle='--', alpha=0.7)
            
            elif config['type'] == 'line':
                for y_col in config['y']:
                    ax.plot(self.data[config['x']], self.data[y_col], 
                           marker='o', label=y_col)
                ax.set_title(config.get('title', ''), fontweight='bold')
                ax.legend()
                ax.grid(True, linestyle='--', alpha=0.6)
            
            elif config['type'] == 'pie':
                ax.pie(self.data[config['y']], labels=self.data[config['x']],
                       autopct='%1.1f%%')
                ax.set_title(config.get('title', ''), fontweight='bold')
                ax.axis('equal')
            
            else:
                ax.text(0.5, 0.5, 'æœªçŸ¥å›¾è¡¨ç±»å‹', ha='center', va='center')
            
            ax.set_xlabel(config['x'])
        
        # éšè—å¤šä½™çš„å­å›¾
        for i in range(len(charts_config), len(axes)):
            axes[i].set_visible(False)
        
        fig.suptitle(title, fontsize=16, fontweight='bold', y=0.98)
        plt.tight_layout(rect=[0, 0, 1, 0.96])
        
        filename = f"{title}_{datetime.now().strftime('%Y%m%d')}.png"
        plt.savefig(filename, dpi=300)
        print(f"âœ… æŠ¥å‘Šå·²ä¿å­˜: {filename} (é«˜æ¸…)")
        plt.show()

def main():
    """ä¸»èœå•"""
    visualizer = FinanceVisualizer()
    
    while True:
        print("\n" + "=" * 50)
        print("è´¢åŠ¡æ•°æ®å¯è§†åŒ–å·¥å…·")
        print("=" * 50)
        print("1. åŠ è½½CSVæ•°æ®")
        print("2. åˆ›å»ºæŸ±çŠ¶å›¾")
        print("3. åˆ›å»ºæŠ˜çº¿å›¾")
        print("4. åˆ›å»ºé¥¼å›¾")
        print("5. ç”Ÿæˆç»¼åˆæŠ¥å‘Š")
        print("6. é€€å‡º")
        print("=" * 50)
        
        choice = input("è¯·é€‰æ‹©: ").strip()
        
        if choice == "1":
            filepath = input("CSVæ–‡ä»¶è·¯å¾„: ").strip()
            visualizer.load_data(filepath)
        
        elif choice == "2":
            if visualizer.data is not None:
                x = input("Xè½´åˆ—å: ").strip()
                y = input("Yè½´åˆ—å: ").strip()
                title = input("å›¾è¡¨æ ‡é¢˜: ").strip() or "æŸ±çŠ¶å›¾"
                visualizer.create_bar_chart(x, y, title)
            else:
                print("âš ï¸ è¯·å…ˆåŠ è½½æ•°æ®")
        
        elif choice == "3":
            if visualizer.data is not None:
                x = input("Xè½´åˆ—å: ").strip()
                y = input("Yè½´åˆ—åï¼ˆå¤šä¸ªç”¨é€—å·åˆ†éš”ï¼‰: ").strip().split(',')
                title = input("å›¾è¡¨æ ‡é¢˜: ").strip() or "æŠ˜çº¿å›¾"
                visualizer.create_line_chart(x, y, title)
            else:
                print("âš ï¸ è¯·å…ˆåŠ è½½æ•°æ®")
        
        elif choice == "4":
            if visualizer.data is not None:
                labels = input("æ ‡ç­¾åˆ—å: ").strip()
                values = input("æ•°å€¼åˆ—å: ").strip()
                title = input("å›¾è¡¨æ ‡é¢˜: ").strip() or "é¥¼å›¾"
                visualizer.create_pie_chart(labels, values, title)
            else:
                print("âš ï¸ è¯·å…ˆåŠ è½½æ•°æ®")
        
        elif choice == "5":
            if visualizer.data is not None:
                print("\nè¯·é…ç½®æŠ¥å‘Šï¼ˆè¾“å…¥å›¾è¡¨æ•°é‡ï¼‰:")
                n = int(input("å›¾è¡¨æ•°é‡: ").strip())
                
                configs = []
                for i in range(n):
                    print(f"\nå›¾è¡¨ {i+1} é…ç½®:")
                    t = input("  ç±»å‹(bar/line/pie): ").strip()
                    x = input("  Xè½´åˆ—å: ").strip()
                    y = input("  Yè½´åˆ—å: ").strip()
                    title = input("  å›¾è¡¨æ ‡é¢˜: ").strip()
                    
                    configs.append({
                        'type': t,
                        'x': x,
                        'y': y if t == 'pie' else [y],
                        'title': title
                    })
                
                title = input("æ€»æ ‡é¢˜: ").strip() or "æ•°æ®æŠ¥å‘Š"
                visualizer.create_report(configs, title)
            else:
                print("âš ï¸ è¯·å…ˆåŠ è½½æ•°æ®")
        
        elif choice == "6":
            print("ğŸ‘‹ å†è§ï¼")
            break
        
        else:
            print("è¯·è¾“å…¥1-6ï¼")

if __name__ == "__main__":
    main()
```

***

### å…«ã€çŸ¥è¯†ç‚¹åŠ æ²¹ç«™

#### 8.1 matplotlibæ ¸å¿ƒç»„ä»¶

```python
"""
Figure: æ•´ä¸ªç”»å¸ƒ
Axes: åæ ‡ç³»ï¼ˆå­å›¾ï¼‰
Axis: åæ ‡è½´
Artist: æ‰€æœ‰å¯è§å…ƒç´ ï¼ˆçº¿ã€æ–‡å­—ã€ç‚¹ï¼‰

å¸¸ç”¨è®¾ç½®ï¼š
plt.figure(figsize=(å®½, é«˜))     # åˆ›å»ºç”»å¸ƒ
plt.title()                      # æ ‡é¢˜
plt.xlabel() / plt.ylabel()      # åæ ‡è½´æ ‡ç­¾
plt.xticks() / plt.yticks()      # åˆ»åº¦æ ‡ç­¾
plt.legend()                     # å›¾ä¾‹
plt.grid()                       # ç½‘æ ¼çº¿
plt.savefig()                    # ä¿å­˜
plt.show()                       # æ˜¾ç¤º
"""
```

***

#### 8.2 é¢œè‰²ä»£ç å‚è€ƒ

| é¢œè‰²  | ä»£ç         | é€‚ç”¨åœºæ™¯  |
| --- | --------- | ----- |
| è´¢åŠ¡è“ | `#1f77b4` | ä¸»æ•°æ®   |
| è­¦å‘Šæ©™ | `#ff7f0e` | å¼‚å¸¸å€¼   |
| æˆåŠŸç»¿ | `#2ca02c` | å¢é•¿/æ­£å‘ |
| å±é™©çº¢ | `#d62728` | äºæŸ/è­¦å‘Š |
| ä¸­æ€§ç° | `#7f7f7f` | è¾…åŠ©çº¿   |

***

### ä¹ã€æ€»ç»“

- âœ… æŸ±çŠ¶å›¾ï¼ˆå¯¹æ¯”ä¸åŒç±»åˆ«ï¼‰
- âœ… æŠ˜çº¿å›¾ï¼ˆå±•ç¤ºæ—¶é—´è¶‹åŠ¿ï¼‰
- âœ… é¥¼å›¾ï¼ˆåˆ†æå æ¯”ç»“æ„ï¼‰
- âœ… å¤šå›¾è¡¨ç»„åˆæŠ¥å‘Š
- âœ… å›¾è¡¨ç¾åŒ–å’Œä¿å­˜

***

### ä¸‹ç¯‡é¢„å‘Š

ç¬¬19ç¯‡ã€Šé¢å‘å¯¹è±¡ç¼–ç¨‹ã€‹â€”â€”ç†è§£â€œç±»â€å’Œâ€œå¯¹è±¡â€ï¼Œä»£ç ä¹Ÿèƒ½åƒæ­ç§¯æœ¨ä¸€æ ·ç»„åˆï¼

***

> ğŸ¤– Powered by Kimi K2 Thinking ğŸ’» å†…å®¹ç»è‘µè‘µğŸŒ»å®¡æ ¸ä¸ä¿®æ”¹

***
