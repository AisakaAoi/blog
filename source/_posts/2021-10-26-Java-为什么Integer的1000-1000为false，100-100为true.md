---
title: Java-ä¸ºä»€ä¹ˆIntegerçš„1000==1000ä¸ºfalseï¼Œ100==100ä¸ºtrue
categories:
  - ğŸŒ™é€¢å‚æ‚è°ˆä¸æ¬è¿
  - â­ä¸€äº›æŠ€æœ¯
abbrlink: 9e3298ff
date: 2021-10-26 14:44:43
tags:
---

### é—®é¢˜å¼•å…¥

è¿™æ˜¯ä¸€ä¸ªå¾ˆç®€å•çš„é—®é¢˜ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªä¸ç®€å•çš„é—®é¢˜ï¼Œæ€»ä¹‹æŒºæœ‰è¶£çš„ï¼Œå¯ä»¥è®¨è®ºè®¨è®ºã€åŠ¨æ‰‹å®æ“ä¸€ä¸‹ã€‚

**ä¸ºä»€ä¹ˆIntegerçš„1000==1000ä¸ºfalseï¼Œ100==100ä¸ºtrueï¼Ÿ**å¦‚æœä½ è¿è¡Œäº†ä¸‹é¢çš„ä»£ç ï¼Œç¡®å®ä¼šå¾—åˆ°è¿™ä¸ªç»“æœã€‚

{% asset_img 1.webp %}

***

<!--more-->

### åŸºæœ¬çŸ¥è¯†

#### ==å’Œ.equals()

| == | .equals() |
| -- | --------- |
| æ¯”è¾ƒçš„æ˜¯åœ°å€ | æ¯”è¾ƒçš„æ˜¯å€¼ |

å³å¦‚æœä¸¤ä¸ªå¼•ç”¨æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡ï¼Œç”¨ == è¡¨ç¤ºå®ƒä»¬æ˜¯ç›¸ç­‰çš„ï¼›å¦‚æœä¸¤ä¸ªå¼•ç”¨æŒ‡å‘ä¸åŒçš„å¯¹è±¡ï¼Œç”¨ == è¡¨ç¤ºå®ƒä»¬æ˜¯ä¸ç›¸ç­‰çš„ï¼Œå³ä½¿å®ƒä»¬çš„å†…å®¹ç›¸åŒã€‚

#### Integerå’Œint

Javaæ˜¯é¢å‘å¯¹è±¡çš„ç¼–ç¨‹è¯­è¨€ï¼Œä¸€åˆ‡éƒ½æ˜¯å¯¹è±¡ï¼Œä½†æ˜¯ä¸ºäº†ç¼–ç¨‹çš„æ–¹ä¾¿è¿˜æ˜¯å¼•å…¥äº†åŸºæœ¬æ•°æ®ç±»å‹ï¼Œä¸ºäº†èƒ½å¤Ÿå°†è¿™äº›åŸºæœ¬æ•°æ®ç±»å‹å½“æˆå¯¹è±¡æ“ä½œï¼ŒJavaä¸ºæ¯ä¸€ä¸ªåŸºæœ¬æ•°æ®ç±»å‹éƒ½å¼•å…¥äº†å¯¹åº”çš„åŒ…è£…ç±»å‹ï¼ˆwrapper classï¼‰ï¼Œintçš„åŒ…è£…ç±»å°±æ˜¯Integerï¼Œä»Java 5å¼€å§‹å¼•å…¥äº†è‡ªåŠ¨è£…ç®±/æ‹†ç®±æœºåˆ¶ï¼Œä½¿å¾—äºŒè€…å¯ä»¥ç›¸äº’è½¬æ¢ã€‚

**åŒºåˆ«ï¼š**

- Integeræ˜¯intçš„åŒ…è£…ç±»ï¼Œintåˆ™æ˜¯javaçš„ä¸€ç§åŸºæœ¬æ•°æ®ç±»å‹
- Integerå˜é‡å¿…é¡»å®ä¾‹åŒ–åæ‰èƒ½ä½¿ç”¨ï¼Œè€Œintå˜é‡ä¸éœ€è¦
- Integerå®é™…æ˜¯å¯¹è±¡çš„å¼•ç”¨ï¼Œå½“newä¸€ä¸ªIntegeræ—¶ï¼Œå®é™…ä¸Šæ˜¯ç”Ÿæˆä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘æ­¤å¯¹è±¡ï¼›è€Œintåˆ™æ˜¯ç›´æ¥å­˜å‚¨æ•°æ®å€¼
- Integerçš„é»˜è®¤å€¼æ˜¯nullï¼Œintçš„é»˜è®¤å€¼æ˜¯0

***

### æºç æ¢æ

é‚£ä¹ˆç…§è¿™ä¹ˆç†è§£ï¼Œåº”è¯¥æ˜¯ä¸¤ä¸ªfalseã€‚ä½†æ·±å…¥æºç Integer.javaç¬¬769è¡Œ

``` java
/**
 * Cache to support the object identity semantics of autoboxing for values between
 * -128 and 127 (inclusive) as required by JLS.
 *
 * The cache is initialized on first usage.  The size of the cache
 * may be controlled by the {@code -XX:AutoBoxCacheMax=<size>} option.
 * During VM initialization, java.lang.Integer.IntegerCache.high property
 * may be set and saved in the private system properties in the
 * sun.misc.VM class.
 */

private static class IntegerCache {
    static final int low = -128;
    static final int high;
    static final Integer cache[];

    static {
        // high value may be configured by property
        int h = 127;
        String integerCacheHighPropValue =
            sun.misc.VM.getSavedProperty("java.lang.Integer.IntegerCache.high");
        if (integerCacheHighPropValue != null) {
            try {
                int i = parseInt(integerCacheHighPropValue);
                i = Math.max(i, 127);
                // Maximum array size is Integer.MAX_VALUE
                h = Math.min(i, Integer.MAX_VALUE - (-low) -1);
            } catch( NumberFormatException nfe) {
                // If the property cannot be parsed into an int, ignore it.
            }
        }
        high = h;

        cache = new Integer[(high - low) + 1];
        int j = low;
        for(int k = 0; k < cache.length; k++)
            cache[k] = new Integer(j++);

        // range [-128, 127] must be interned (JLS7 5.1.7)
        assert IntegerCache.high >= 127;
    }

    private IntegerCache() {}
}
```

è¿™ä¸ªå†…éƒ¨ç§æœ‰ç±»ç¼“å­˜äº†-128~127ä¹‹é—´çš„æ‰€æœ‰æ•´æ•°å¯¹è±¡ï¼Œæ‰€ä»¥å½“æˆ‘ä»¬ç±»ä¼¼äºå£°æ˜

``` java
Integer a = 100;
```

å®é™…ä¸Šå†…éƒ¨åšçš„æ˜¯

``` java
Integer a = Integer.valueof(100);
```

æ¥ç€å†å»çœ‹çœ‹valueofæ–¹æ³•

``` java
/**
 * Returns an {@code Integer} instance representing the specified
 * {@code int} value.  If a new {@code Integer} instance is not
 * required, this method should generally be used in preference to
 * the constructor {@link #Integer(int)}, as this method is likely
 * to yield significantly better space and time performance by
 * caching frequently requested values.
 *
 * This method will always cache values in the range -128 to 127,
 * inclusive, and may cache other values outside of this range.
 *
 * @param  i an {@code int} value.
 * @return an {@code Integer} instance representing {@code i}.
 * @since  1.5
 */
public static Integer valueOf(int i) {
    if (i >= IntegerCache.low && i <= IntegerCache.high)
        return IntegerCache.cache[i + (-IntegerCache.low)];
    return new Integer(i);
}
```

å¦‚æœå€¼çš„èŒƒå›´åœ¨-128~127ä¹‹é—´ï¼Œå®ƒå°±ä»é«˜é€Ÿç¼“å­˜ä¸­è¿”å›å®ä¾‹ï¼Œæ‰€ä»¥aã€bæŒ‡å‘çš„æ˜¯åŒä¸ªå¯¹è±¡ã€‚

``` java
Integer a = 100, b = 100;
```

ä½ å¯èƒ½ä¼šé—®ï¼Œä¸ºä»€ä¹ˆè¿™é‡Œéœ€è¦ç¼“å­˜ï¼Ÿ

åˆç†çš„ç†ç”±æ˜¯ï¼Œåœ¨æ­¤èŒƒå›´å†…çš„â€œå°â€æ•´æ•°ä½¿ç”¨ç‡æ¯”å¤§æ•´æ•°é«˜å¾ˆå¤šï¼Œé‡å¤åˆ›å»ºä¸é”€æ¯å¯¹è±¡æ˜¯æœ‰ä¸€å®šä»£ä»·çš„ï¼Œå› æ­¤ä½¿ç”¨ç›¸åŒçš„åº•å±‚å¯¹è±¡æ˜¯æœ‰ä»·å€¼çš„ï¼Œå¯ä»¥å‡å°‘æ½œåœ¨çš„å†…å­˜å ç”¨ä¸æŠ–åŠ¨ã€‚

***

### æ‹“å±•è§£æ

1. ç”±äºIntegerå˜é‡å®é™…ä¸Šæ˜¯å¯¹ä¸€ä¸ªIntegerå¯¹è±¡çš„å¼•ç”¨ï¼Œæ‰€ä»¥ä¸¤ä¸ªé€šè¿‡newç”Ÿæˆçš„Integerå˜é‡æ°¸è¿œæ˜¯ä¸ç›¸ç­‰çš„ï¼ˆå› ä¸ºnewç”Ÿæˆçš„æ˜¯ä¸¤ä¸ªå¯¹è±¡ï¼Œå…¶å†…å­˜åœ°å€ä¸åŒï¼‰ã€‚

    ``` java
    Integer i = new Integer(100);
    Integer j = new Integer(100);
    System.out.print(i == j); //false
    ```

2. Integerå˜é‡å’Œintå˜é‡æ¯”è¾ƒæ—¶ï¼Œåªè¦ä¸¤ä¸ªå˜é‡çš„å€¼æ˜¯å‘ç­‰çš„ï¼Œåˆ™ç»“æœä¸ºtrueï¼ˆå› ä¸ºåŒ…è£…ç±»Integerå’ŒåŸºæœ¬æ•°æ®ç±»å‹intæ¯”è¾ƒæ—¶ï¼Œjavaä¼šè‡ªåŠ¨æ‹†åŒ…è£…ä¸ºintï¼Œç„¶åè¿›è¡Œæ¯”è¾ƒï¼Œå®é™…ä¸Šå°±å˜ä¸ºä¸¤ä¸ªintå˜é‡çš„æ¯”è¾ƒï¼‰

    ``` java
    Integer i = new Integer(100);
    int j = 100ï¼›
    System.out.print(i == j); //true
    ```

3. énewç”Ÿæˆçš„Integerå˜é‡å’Œnew Integer()ç”Ÿæˆçš„å˜é‡æ¯”è¾ƒæ—¶ï¼Œç»“æœä¸ºfalseã€‚ï¼ˆå› ä¸ºénewç”Ÿæˆçš„Integerå˜é‡æŒ‡å‘çš„æ˜¯javaå¸¸é‡æ± ä¸­çš„å¯¹è±¡ï¼Œè€Œnew Integer()ç”Ÿæˆçš„å˜é‡æŒ‡å‘å †ä¸­æ–°å»ºçš„å¯¹è±¡ï¼Œä¸¤è€…åœ¨å†…å­˜ä¸­çš„åœ°å€ä¸åŒï¼‰

    ``` java
    Integer i = new Integer(100);
    Integer j = 100;
    System.out.print(i == j); //false
    ```

4. å¯¹äºä¸¤ä¸ªénewç”Ÿæˆçš„Integerå¯¹è±¡ï¼Œè¿›è¡Œæ¯”è¾ƒæ—¶ï¼Œå¦‚æœä¸¤ä¸ªå˜é‡çš„å€¼åœ¨åŒºé—´-128åˆ°127ä¹‹é—´ï¼Œåˆ™æ¯”è¾ƒç»“æœä¸ºtrueï¼Œå¦‚æœä¸¤ä¸ªå˜é‡çš„å€¼ä¸åœ¨æ­¤åŒºé—´ï¼Œåˆ™æ¯”è¾ƒç»“æœä¸ºfalse

    ``` java
    Integer i = 100;
    Integer j = 100;
    System.out.print(i == j); //true
    Integer i = 128;
    Integer j = 128;
    System.out.print(i == j); //false
    ```

#### ç†è§£è‡ªåŠ¨è£…ç®±ã€æ‹†ç®±

è‡ªåŠ¨è£…ç®±ä¸æ‹†ç®±å®é™…ä¸Šç®—æ˜¯ä¸€ç§â€œè¯­æ³•ç³–â€ã€‚æ‰€è°“è¯­æ³•ç³–ï¼Œå¯ç®€å•ç†è§£ä¸ºJavaå¹³å°ä¸ºæˆ‘ä»¬è‡ªåŠ¨è¿›è¡Œäº†ä¸€äº›è½¬æ¢ï¼Œä¿è¯ä¸åŒçš„å†™æ³•åœ¨è¿è¡Œæ—¶ç­‰ä»·ã€‚å› æ­¤å®ƒä»¬æ˜¯å‘ç”Ÿåœ¨ç¼–è¯‘é˜¶æ®µçš„ï¼Œä¹Ÿå°±æ˜¯è¯´ç”Ÿæˆçš„å­—èŠ‚ç æ˜¯ä¸€è‡´çš„ã€‚

å¯¹äºæ•´æ•°ï¼Œjavacæ›¿æˆ‘ä»¬è‡ªåŠ¨æŠŠè£…ç®±è½¬æ¢ä¸ºInteger.valueOf()ï¼ŒæŠŠæ‹†ç®±æ›¿æ¢ä¸ºInteger.intValue()ã€‚å¯ä»¥é€šè¿‡å°†ä»£ç ç¼–è¯‘åï¼Œå†åç¼–è¯‘åŠ ä»¥è¯å®ã€‚

åŸåˆ™ä¸Šï¼Œå»ºè®®é¿å…æ— æ„ä¸­çš„è£…ç®±ã€æ‹†ç®±è¡Œä¸ºï¼Œå°¤å…¶æ˜¯åœ¨æ€§èƒ½æ•æ„Ÿçš„åœºåˆï¼Œåˆ›å»º10ä¸‡ä¸ªJavaå¯¹è±¡å’Œ10ä¸‡ä¸ªæ•´æ•°çš„å¼€é”€å¯ä¸æ˜¯ä¸€ä¸ªæ•°é‡çº§çš„ã€‚å½“ç„¶è¯·æ³¨æ„ï¼Œåªæœ‰ç¡®å®šä½ ç°åœ¨æ‰€å¤„çš„åœºåˆæ˜¯æ€§èƒ½æ•æ„Ÿçš„ï¼Œæ‰éœ€è¦è€ƒè™‘ä¸Šè¿°é—®é¢˜ã€‚æ¯•ç«Ÿå¤§å¤šæ•°çš„ä»£ç è¿˜æ˜¯ä»¥å¼€å‘æ•ˆç‡ä¸ºä¼˜å…ˆçš„ã€‚

é¡ºå¸¦è¯´ä¸€ä¸‹ï¼Œåœ¨32ä½ç¯å¢ƒä¸‹ï¼ŒIntegerå¯¹è±¡å ç”¨å†…å­˜16å­—èŠ‚ï¼›åœ¨64ä½ç¯å¢ƒä¸‹åˆ™æ›´å¤§ã€‚

#### å€¼ç¼“å­˜

å°±åƒStringï¼ŒJavaä¹Ÿä¸ºIntegeræä¾›äº†å€¼ç¼“å­˜ã€‚

``` java
Integer i1 = 1;
Integer i2 = Integer.valueOf(2);
Integer i3 = new Integer(3);
```

ä¸Šè¿°ä»£ç ä¸­ç¬¬ä¸€è¡Œä¸ç¬¬äºŒè¡Œçš„å†™æ³•å–å€¼ä½¿ç”¨äº†å€¼ç¼“å­˜ï¼Œè€Œç¬¬ä¸‰è¡Œçš„å†™æ³•åˆ™æ²¡æœ‰åˆ©ç”¨å€¼ç¼“å­˜ã€‚ç»“åˆåˆšåˆšè®²åˆ°çš„è‡ªåŠ¨è£…ç®±ã€æ‹†ç®±çš„çŸ¥è¯†ï¼Œç¬¬ä¸€è¡Œä»£ç ç”¨åˆ°çš„è‡ªåŠ¨è£…ç®±ï¼Œç­‰ä»·äºè°ƒç”¨äº†Integer.valueOf()ã€‚

ä¸ä»…ä»…æ˜¯Integerï¼ŒJavaä¹Ÿä¸ºå…¶å®ƒåŒ…è£…ç±»æä¾›äº†å€¼ç¼“å­˜æœºåˆ¶ï¼ŒåŒ…æ‹¬Booleanã€Byteã€Shortå’ŒCharacterç­‰ã€‚ä½†ä¸Stringä¸åŒçš„æ˜¯ï¼Œé»˜è®¤éƒ½åªä¼šå°†ç»å¯¹å€¼è¾ƒå°çš„å€¼æ”¾å…¥ç¼“å­˜ã€‚ä»¥Integerä¸ºä¾‹ï¼Œé»˜è®¤æƒ…å†µä¸‹åªä¼šç¼“å­˜-128åˆ°127ä¹‹é—´çš„å€¼ã€‚å½“ç„¶å¦‚æœä½ æ„¿æ„ä¹Ÿå¯ä»¥é€šè¿‡ä»¥ä¸‹JVMå‚æ•°è¿›è¡Œè®¾ç½®ï¼š

-XX:AutoBoxCacheMax=N

#### åŸå§‹ç±»å‹æ“ä½œçº¿ç¨‹å®‰å…¨å—ï¼Ÿ

çº¿ç¨‹ä¸å®‰å…¨ï¼ï¼

åŸå§‹æ•°æ®ç±»å‹çš„å˜é‡ï¼Œéœ€è¦ä½¿ç”¨å¹¶å‘ç›¸å…³æ‰‹æ®µæ‰èƒ½ä¿è¯çº¿ç¨‹å®‰å…¨ã€‚ç‰¹åˆ«çš„æ˜¯ï¼Œéƒ¨åˆ†æ¯”è¾ƒå®½çš„æ•°æ®ç±»å‹ï¼Œæ¯”å¦‚longã€floatã€doubleï¼Œç”šè‡³ä¸èƒ½ä¿è¯æ›´æ–°æ“ä½œçš„åŸå­æ€§ï¼Œå¯èƒ½å‡ºç°ç¨‹åºè¯»å–åˆ°åªæ›´æ–°äº†ä¸€åŠæ•°æ®ä½çš„æ•°å€¼ï¼

å¦‚æœæœ‰çº¿ç¨‹å®‰å…¨çš„è®¡ç®—éœ€è¦ï¼Œå»ºè®®è€ƒè™‘ä½¿ç”¨ç±»ä¼¼AtomicIntegerã€AtomicLongè¿™æ ·çº¿ç¨‹å®‰å…¨çš„ç±»ã€‚
